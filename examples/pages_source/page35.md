---
title: canvas刮刮乐和画笔
date: 2016-11-04 16:17:30
comments: true
categories: HTML5
---

#canvas刮刮乐和画笔
<p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">　　这周有点迷茫，不知道干嘛了，一天天就过去了！我在博客右侧公告栏加了qq交流，各位有好的主题，或者有趣的技术，欢迎交流！今天突发奇想，就写了2个h5 canvas的demo玩玩！</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">　　舍不得买2块钱的刮刮乐，就只能写个类似的功能过过彩票瘾了！</span></p><div class="cnblogs_code"> <pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="lottery"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="width:300px;height:500px;margin:10px;background-color:lightskyblue;border-radius:5px;float:left;"</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:300px;height:100px;line-height:100px;text-align:center;font-size:33px;color:blueviolet;"</span><span style="color: #0000ff;">&gt;</span>NICK彩票<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="txt"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="width:300px;height:200px;font-size:40px;color:peachpuff;display:flex;justify-content:center;align-items:center;flex-direction:column;"</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>祝<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>君<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>中<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>奖<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="canvasArea"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="width:300px;height:200px;position:relative;"</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:300px;height:200px;position:absolute;top:0;left:0;z-index:1;text-align:center;line-height:200px;font-weight:bold;font-size:56px;color:indianred;"</span><span style="color: #0000ff;">&gt;</span>一等奖<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">canvas </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="canvas"</span><span style="color: #ff0000;"> width</span><span style="color: #0000ff;">="300px"</span><span style="color: #ff0000;"> height</span><span style="color: #0000ff;">="200px"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="position:absolute;top:0;left:0;z-index:2;"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">canvas</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span></pre> </div><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">这段html要注意的地方有2个：</span></p><ol> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">flex布局，将&lsquo;祝君中奖&rsquo;垂直居中，目前还有兼容问题，不过看我们大前端的发展趋势，应该很快就能搞定了；</span></li> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">canvas和&lsquo;一等奖&rsquo;div的z-index问题，将canvas的z-index设置较高，使其置于一等奖div上面。</span></li> </ol><div class="cnblogs_code"> <pre><span style="color: #0000ff;">var</span> canvas = document.getElementById("canvas"<span style="color: #000000;">); </span><span style="color: #0000ff;">var</span> context = canvas.getContext("2d");</pre> </div><div class="cnblogs_code"> <pre>        context.fillStyle='#A9AB9D'<span style="color: #000000;">;         context.fillRect(</span>10,10,280,180<span style="color: #000000;">);         context.fillStyle</span>='#000'<span style="color: #000000;">;         context.font</span>='50px Arial'<span style="color: #000000;">;         context.fillText(</span>'刮奖区',75,115);</pre> </div><ol> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">填充颜色；</span></li> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">绘制实心矩形；</span></li> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">设置字体颜色；</span></li> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">设置字体大小类型；</span></li> <li><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">绘制实心字体。</span></li> </ol><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">以上都是canvas基础api，看w3c就ok了。</span></p><div class="cnblogs_code"> <pre>        setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){             document.getElementById(</span>'txt').style.color = document.getElementById('txt').style.color=='peachpuff' ? 'yellow' : 'peachpuff'<span style="color: #000000;">;         },</span>500);</pre> </div><div class="cnblogs_code"> <pre>        <span style="color: #0000ff;">var</span> brush=<span style="color: #0000ff;">function</span>(){<span style="color: #008000;">//</span><span style="color: #008000;">刮奖</span>             context.clearRect(event.offsetX,event.offsetY,20,20<span style="color: #000000;">);         };</span></pre> </div><div class="cnblogs_code"> <pre>        canvas.onmousedown = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){             </span><span style="color: #008000;">//</span><span style="color: #008000;"> 鼠标按下时 - 绑定鼠标跟随事件</span>             bindHandler(canvas,'mousemove',brush,<span style="color: #0000ff;">false</span><span style="color: #000000;">);         }         canvas.onmouseup </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){             </span><span style="color: #008000;">//</span><span style="color: #008000;"> 停止刮奖功能 - 解绑鼠标跟随事件</span>             removeHandler(canvas,"mousemove",brush,<span style="color: #0000ff;">false</span><span style="color: #000000;">);         }</span></pre> </div><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">这里的事件绑定与解绑我上篇博文有封装，最后完整代码也有！</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">刮刮乐happy到底结束！最后附上完整代码，再看看效果吧！</span></p><div class="cnblogs_code"> <pre>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:300px;height:500px;margin:10px;border-radius:10px;overflow:hidden;float:right;"</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">canvas </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="canvas2"</span><span style="color: #ff0000;"> width</span><span style="color: #0000ff;">="300px"</span><span style="color: #ff0000;"> height</span><span style="color: #0000ff;">="500px"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="background-color:lightblue;"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">canvas</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span></pre> </div><div class="cnblogs_code"> <pre>        <span style="color: #0000ff;">var</span> canvas2 = document.getElementById("canvas2"<span style="color: #000000;">);         </span><span style="color: #0000ff;">var</span> context2 = canvas2.getContext("2d");</pre> </div><div class="cnblogs_code"> <pre>        <span style="color: #0000ff;">var</span> draw=<span style="color: #0000ff;">function</span><span style="color: #000000;">(){             context2.fillRect(event.offsetX,event.offsetY,</span>10,10<span style="color: #000000;">);         };</span></pre> </div><div class="cnblogs_code"> <pre>        context2.font='20px Arial'<span style="color: #000000;">;         context2.strokeText(</span>'NICK画笔',100,30);<span style="color: #008000;">//</span><span style="color: #008000;">写个头</span>         <span style="color: #008000;">//</span><span style="color: #008000;">1. 为canvas元素onmousedown和onmouseup事件</span>         canvas2.onmousedown = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){             </span><span style="color: #008000;">//</span><span style="color: #008000;"> 启用画笔功能 - 绑定鼠标跟随事件</span>             bindHandler(canvas2,'mousemove',draw,<span style="color: #0000ff;">false</span><span style="color: #000000;">);         }         canvas2.onmouseup </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){             </span><span style="color: #008000;">//</span><span style="color: #008000;"> 停止画笔功能 - 解绑鼠标跟随事件</span>             removeHandler(canvas2,"mousemove",draw,<span style="color: #0000ff;">false</span><span style="color: #000000;">);         }</span></pre> </div><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">画图工具的画笔功能到底结束！</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">附上完整代码：</span></p><div class="cnblogs_code" onclick="cnblogs_code_show('900b9f94-3fe0-4916-a8b5-cd220a54ab30')"><img id="code_img_closed_900b9f94-3fe0-4916-a8b5-cd220a54ab30" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img id="code_img_opened_900b9f94-3fe0-4916-a8b5-cd220a54ab30" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('900b9f94-3fe0-4916-a8b5-cd220a54ab30',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""> <div id="cnblogs_code_open_900b9f94-3fe0-4916-a8b5-cd220a54ab30" class="cnblogs_code_hide"> <pre><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>Canvas lottery brush nick<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">meta </span><span style="color: #ff0000;">charset</span><span style="color: #0000ff;">="utf-8"</span><span style="color: #0000ff;">/&gt;</span>  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:640px;margin:auto;"</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">刮刮乐</span><span style="color: #008000;">--&gt;</span>      <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="lottery"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="width:300px;height:500px;margin:10px;background-color:lightskyblue;border-radius:5px;float:left;"</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:300px;height:100px;line-height:100px;text-align:center;font-size:33px;color:blueviolet;"</span><span style="color: #0000ff;">&gt;</span>NICK彩票<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="txt"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="width:300px;height:200px;font-size:40px;color:peachpuff;display:flex;justify-content:center;align-items:center;flex-direction:column;"</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>祝<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>君<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>中<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>奖<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="canvasArea"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="width:300px;height:200px;position:relative;"</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:300px;height:200px;position:absolute;top:0;left:0;z-index:1;text-align:center;line-height:200px;font-weight:bold;font-size:56px;color:indianred;"</span><span style="color: #0000ff;">&gt;</span>一等奖<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>              <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">canvas </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="canvas"</span><span style="color: #ff0000;"> width</span><span style="color: #0000ff;">="300px"</span><span style="color: #ff0000;"> height</span><span style="color: #0000ff;">="200px"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="position:absolute;top:0;left:0;z-index:2;"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">canvas</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">画图工具画笔功能</span><span style="color: #008000;">--&gt;</span>      <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="width:300px;height:500px;margin:10px;border-radius:10px;overflow:hidden;float:right;"</span><span style="color: #0000ff;">&gt;</span>          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">canvas </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="canvas2"</span><span style="color: #ff0000;"> width</span><span style="color: #0000ff;">="300px"</span><span style="color: #ff0000;"> height</span><span style="color: #0000ff;">="500px"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="background-color:lightblue;"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">canvas</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">="text-align:center;"</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>刮刮乐：鼠标按住不放，拖动开始刮奖！<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>      <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>画笔：鼠标按住不放，拖动画画！<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>         <span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">插件方法封装区</span> <span style="background-color: #f5f5f5; color: #000000;">         ;(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){             </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 事件绑定</span> <span style="background-color: #f5f5f5; color: #000000;">            window.bindHandler </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">() {                 </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (window.addEventListener) {</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 标准浏览器</span>                     <span style="background-color: #f5f5f5; color: #0000ff;">return</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(elem, type, handler) {                         </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> elem:节点    type:事件类型   handler:事件处理函数</span>                         <span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 最后一个参数为true:在捕获阶段调用事件处理程序;为false:在冒泡阶段调用事件处理程序。注意：ie没有这个参数</span> <span style="background-color: #f5f5f5; color: #000000;">                        elem.addEventListener(type, handler, </span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">);                     }                 } </span><span style="background-color: #f5f5f5; color: #0000ff;">else</span> <span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (window.attachEvent) {</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> IE浏览器</span>                     <span style="background-color: #f5f5f5; color: #0000ff;">return</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(elem, type, handler) {                         elem.attachEvent(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">on</span><span style="background-color: #f5f5f5; color: #000000;">"</span> <span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> type, handler);                     }                 }             }());             </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 事件解除</span> <span style="background-color: #f5f5f5; color: #000000;">            window.removeHandler </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">() {                 </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (window.removeEventListener) {</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 标准浏览器</span>                     <span style="background-color: #f5f5f5; color: #0000ff;">return</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(elem, type, handler) {                         elem.removeEventListener(type, handler, </span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">);                     }                 } </span><span style="background-color: #f5f5f5; color: #0000ff;">else</span> <span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (window.detachEvent) {</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> IE浏览器</span>                     <span style="background-color: #f5f5f5; color: #0000ff;">return</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(elem, type, handler) {                         elem.detachEvent(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">on</span><span style="background-color: #f5f5f5; color: #000000;">"</span> <span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> type, handler);                     }                 }             }());         }());         </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">命名区</span>         <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> canvas </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">canvas</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);         </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> context </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> canvas.getContext(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">2d</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);         </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> canvas2 </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">canvas2</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);         </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> context2 </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> canvas2.getContext(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">2d</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);         </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> brush</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">刮奖</span> <span style="background-color: #f5f5f5; color: #000000;">            context.clearRect(event.offsetX,event.offsetY,</span><span style="background-color: #f5f5f5; color: #000000;">20</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">20</span><span style="background-color: #f5f5f5; color: #000000;">);         };         </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> draw</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">写字</span> <span style="background-color: #f5f5f5; color: #000000;">            context2.fillRect(event.offsetX,event.offsetY,</span><span style="background-color: #f5f5f5; color: #000000;">10</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">10</span><span style="background-color: #f5f5f5; color: #000000;">);         };         </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">功能实现区</span>         <span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">刮刮乐</span>         <span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 1. 绘制刮奖区域</span> <span style="background-color: #f5f5f5; color: #000000;">        context.fillStyle</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">#A9AB9D</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">;         context.fillRect(</span><span style="background-color: #f5f5f5; color: #000000;">10</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">10</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">280</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">180</span><span style="background-color: #f5f5f5; color: #000000;">);         context.fillStyle</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">#000</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">;         context.font</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">50px Arial</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">;         context.fillText(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">刮奖区</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">75</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">115</span><span style="background-color: #f5f5f5; color: #000000;">);         </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">字体变色</span> <span style="background-color: #f5f5f5; color: #000000;">        setInterval(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){             document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">txt</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">).style.color </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> document.getElementById(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">txt</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">).style.color</span><span style="background-color: #f5f5f5; color: #000000;">==</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">peachpuff</span><span style="background-color: #f5f5f5; color: #000000;">'</span> <span style="background-color: #f5f5f5; color: #000000;">?</span> <span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">yellow</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;"> : </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">peachpuff</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">;         },</span><span style="background-color: #f5f5f5; color: #000000;">500</span><span style="background-color: #f5f5f5; color: #000000;">);         </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">2. 为canvas元素onmousedown和onmouseup事件</span> <span style="background-color: #f5f5f5; color: #000000;">        canvas.onmousedown </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){             </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 鼠标按下时 - 绑定鼠标跟随事件</span> <span style="background-color: #f5f5f5; color: #000000;">            bindHandler(canvas,</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">mousemove</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,brush,</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">);         }         canvas.onmouseup </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){             </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 停止刮奖功能 - 解绑鼠标跟随事件</span> <span style="background-color: #f5f5f5; color: #000000;">            removeHandler(canvas,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">mousemove</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,brush,</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">);         }         </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">画笔</span> <span style="background-color: #f5f5f5; color: #000000;">        context2.font</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">20px Arial</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">;         context2.strokeText(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">NICK画笔</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">100</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">30</span><span style="background-color: #f5f5f5; color: #000000;">);</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">写个头</span>         <span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">1. 为canvas元素onmousedown和onmouseup事件</span> <span style="background-color: #f5f5f5; color: #000000;">        canvas2.onmousedown </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){             </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 启用画笔功能 - 绑定鼠标跟随事件</span> <span style="background-color: #f5f5f5; color: #000000;">            bindHandler(canvas2,</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">mousemove</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,draw,</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">);         }         canvas2.onmouseup </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){             </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;"> 停止画笔功能 - 解绑鼠标跟随事件</span> <span style="background-color: #f5f5f5; color: #000000;">            removeHandler(canvas2,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">mousemove</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,draw,</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">);         }     </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre> </div> <span class="cnblogs_code_collapse">View Code</span></div><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">　　代码写完了，我也想说点其他的：</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">　　上面js代码中，有不少注释，我将其分为几个区域：插件方法封装区、命名区、功能实现区、刮刮乐区以及画笔区等，我感觉这样写加上一些注释，能使代码能加简洁，便于以后的维护！当然这只是个人观点，欢迎各位点击我博客右边公告栏的qq交流交流！</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">最后附上：</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;">来看看效果，玩玩吧！</span></p><p><span style="font-family: 'comic sans ms', sans-serif; font-size: 16px;"></span></p><p>&nbsp;</p>1 nodeName=undefined nodeValue=undefined nodeType=undefined
