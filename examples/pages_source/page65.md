---
title: html5  Sortable.js 拖拽排序源码分析
date: 2016-11-04 16:17:37
comments: true
categories: HTML5
---

#html5  Sortable.js 拖拽排序源码分析
<p><span style="color: #333333;">最近公司项目经常用到一个拖拽&nbsp;Sortable.js插件，所以有空的时候看了&nbsp;Sortable.js 源码，总共1300多行这样，写的挺完美的。</span></p><p><span style="color: #333333;">官网http://rubaxa.github.io/Sortable/&nbsp;</span></p><p><span style="color: #333333;">技术交流qq群 302817612</span></p><p><span style="color: #333333;">拖拽的时候主要由这几个事件完成，&nbsp;</span></p><p><span style="color: #333333;">&nbsp;&nbsp;&nbsp; ondragstart 事件：当拖拽元素开始被拖拽的时候触发的事件，此事件作用在被拖曳元素上</span><br><span style="color: #333333;">&nbsp;&nbsp;&nbsp; ondragenter 事件：当拖曳元素进入目标元素的时候触发的事件，此事件作用在目标元素上</span><br><span style="color: #333333;">&nbsp;&nbsp;&nbsp; ondragover 事件：拖拽元素在目标元素上移动的时候触发的事件，此事件作用在目标元素上</span><br><span style="color: #333333;">&nbsp;&nbsp;&nbsp; ondrop 事件：被拖拽的元素在目标元素上同时鼠标放开触发的事件，此事件作用在目标元素上</span><br><span style="color: #333333;">&nbsp;&nbsp;&nbsp; ondragend 事件：当拖拽完成后触发的事件，此事件作用在被拖曳元素上</span></p><p><span style="color: #333333;">主要是拖拽的时候发生ondragstart事件和ondragover事件的时候节点交换位置，其实就是把他们的节点互相调换，当然这只是最简单的拖拽排序方式，里面用到了许多技术比用判断拖拽滚动条的时候是滚动拖拽元素上面的根节点的父节点滚动，还是滚动window上面的滚动条， 还有拖拽的时候利用getBoundingClientRect() 属性判断鼠标是在dom节点的左边，右边，上面，还是下面。还有利用回调和函数式编程声明函数，利用布尔值相加相减去，做0和1判断，利用了事件绑定来判定两个列表中的不同元素，这些都是很有趣的技术。</span></p><p><span style="color: #333333;">&nbsp;</span></p><p><span style="color: #333333;">注意：这个插件是用html5 拖拽的所以也不支持ie9 以下浏览器</span></p><p><span style="color: #333333;">接下来我们先看看简单的简单的dome，先加载他的拖拽js&nbsp;Sortable.js 插件，和app.css.&nbsp; 创建一个简单的拖拽很简单 只要传递一个dom节点进去就可以，第二个参数传一个空对象进去</span></p><p><span style="color: #333333;">当然app.css，加不加无所谓，如果不加的话要加一个样式就是</span></p><p><span style="color: #333333;">.sortable-ghost {</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;opacity: 0.4;</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;background-color: #F4E2C9;</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}</span></p><p><span style="color: #333333;">拖拽的时候有阴影效果更好看些</span></p><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt; <span style="color: #008080;"> 2</span> &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt; <span style="color: #008080;"> 3</span> &lt;head&gt; <span style="color: #008080;"> 4</span> &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt; <span style="color: #008080;"> 5</span> &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span> &lt;/head&gt; <span style="color: #008080;"> 7</span>     &lt;link href="app.css" rel="stylesheet" type="text/css"/&gt; <span style="color: #008080;"> 8</span>     &lt;script src="Sortable.js"&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>  &lt;body&gt; <span style="color: #008080;">10</span>              &lt;ul id="foo" class="block__list block__list_words"&gt; <span style="color: #008080;">11</span>                 &lt;li&gt;1&lt;/li&gt; <span style="color: #008080;">12</span>                 &lt;li&gt;2&lt;/li&gt; <span style="color: #008080;">13</span>                 &lt;li&gt;3&lt;/li&gt; <span style="color: #008080;">14</span>                 &lt;li&gt;4&lt;/li&gt; <span style="color: #008080;">15</span>                 &lt;li&gt;5&lt;/li&gt; <span style="color: #008080;">16</span>                 &lt;li&gt;6&lt;/li&gt; <span style="color: #008080;">17</span>                 &lt;li&gt;7&lt;/li&gt; <span style="color: #008080;">18</span>                 &lt;li&gt;8&lt;/li&gt; <span style="color: #008080;">19</span>             &lt;/ul&gt; <span style="color: #008080;">20</span>       <span style="color: #008080;">21</span>       &lt;script&gt; <span style="color: #008080;">22</span>                  Sortable.create(document.getElementById('foo'<span style="color: #000000;">), {}); </span><span style="color: #008080;">23</span>       &lt;/script&gt;   <span style="color: #008080;">24</span> &lt;/body&gt; <span style="color: #008080;">25</span> &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #333333;">该插件还提供了拖拽时候动画，让拖拽变得更炫，很简单加多一个参数就行animation: 150，拖拽时间内执行完动画的时间。里面是用css3动画的ie9以下浏览器 含ie9浏览器不支持</span></p><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt; <span style="color: #008080;"> 2</span> &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt; <span style="color: #008080;"> 3</span> &lt;head&gt; <span style="color: #008080;"> 4</span> &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt; <span style="color: #008080;"> 5</span> &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span> &lt;/head&gt; <span style="color: #008080;"> 7</span>     &lt;link href="app.css" rel="stylesheet" type="text/css"/&gt; <span style="color: #008080;"> 8</span>     &lt;script src="Sortable.js"&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>  &lt;body&gt; <span style="color: #008080;">10</span>              &lt;ul id="foo" class="block__list block__list_words"&gt; <span style="color: #008080;">11</span>                 &lt;li&gt;1&lt;/li&gt; <span style="color: #008080;">12</span>                 &lt;li&gt;2&lt;/li&gt; <span style="color: #008080;">13</span>                 &lt;li&gt;3&lt;/li&gt; <span style="color: #008080;">14</span>                 &lt;li&gt;4&lt;/li&gt; <span style="color: #008080;">15</span>                 &lt;li&gt;5&lt;/li&gt; <span style="color: #008080;">16</span>                 &lt;li&gt;6&lt;/li&gt; <span style="color: #008080;">17</span>                 &lt;li&gt;7&lt;/li&gt; <span style="color: #008080;">18</span>                 &lt;li&gt;8&lt;/li&gt; <span style="color: #008080;">19</span>             &lt;/ul&gt; <span style="color: #008080;">20</span>       <span style="color: #008080;">21</span>       &lt;script&gt; <span style="color: #008080;">22</span>                  Sortable.create(document.getElementById('foo'<span style="color: #000000;">),  </span><span style="color: #008080;">23</span> <span style="color: #000000;">                    { </span><span style="color: #008080;">24</span>                       animation: 150, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">25</span> <span style="color: #000000;">                     }); </span><span style="color: #008080;">26</span>       &lt;/script&gt;   <span style="color: #008080;">27</span> &lt;/body&gt; <span style="color: #008080;">28</span> &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #333333;">这个插件不仅仅提供拖拽功能，还提供了拖拽完之后排序，当然排序的思维很简单，判断鼠标按下去拖拽的那个节点和拖拽到目标节点的两个元素发生ondragover的时候判断他们的dom节点位置，并且互换dom位置就形成了排序。拖拽完成只有&nbsp;Sortable.js 插件还提供了几个事件接口，我们看看那dome，</span></p><p>&nbsp;</p><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt; <span style="color: #008080;"> 2</span> &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt; <span style="color: #008080;"> 3</span> &lt;head&gt; <span style="color: #008080;"> 4</span> &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt; <span style="color: #008080;"> 5</span> &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span> &lt;/head&gt; <span style="color: #008080;"> 7</span>      &lt;link href="app.css" rel="stylesheet" type="text/css"/&gt;  <span style="color: #008080;"> 8</span>     &lt;script src="Sortable.js"&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>   &lt;body&gt; <span style="color: #008080;">10</span>       &lt;ul id="foo" class="block__list block__list_words"&gt; <span style="color: #008080;">11</span>                 &lt;li&gt;1&lt;/li&gt; <span style="color: #008080;">12</span>                 &lt;li&gt;2&lt;/li&gt; <span style="color: #008080;">13</span>                 &lt;li&gt;3&lt;/li&gt; <span style="color: #008080;">14</span>                 &lt;li&gt;4&lt;/li&gt; <span style="color: #008080;">15</span>                 &lt;li&gt;5&lt;/li&gt; <span style="color: #008080;">16</span>                 &lt;li&gt;6&lt;/li&gt; <span style="color: #008080;">17</span>                 &lt;li&gt;7&lt;/li&gt; <span style="color: #008080;">18</span>                 &lt;li&gt;8&lt;/li&gt; <span style="color: #008080;">19</span>             &lt;/ul&gt; <span style="color: #008080;">20</span>        &lt;script&gt; <span style="color: #008080;">21</span>                  Sortable.create(document.getElementById('foo'<span style="color: #000000;">), { </span><span style="color: #008080;">22</span>                                 animation: 150, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">23</span>                                 onAdd: <span style="color: #0000ff;">function</span> (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">24</span>                                      console.log('onAdd.foo:'<span style="color: #000000;">, [evt.item, evt.from]);  </span><span style="color: #008080;">25</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">26</span>                                 onUpdate: <span style="color: #0000ff;">function</span> (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">27</span>                                     console.log('onUpdate.foo:'<span style="color: #000000;">, [evt.item, evt.from]);   </span><span style="color: #008080;">28</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">29</span>                                 onRemove: <span style="color: #0000ff;">function</span> (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">30</span>                                      console.log('onRemove.foo:'<span style="color: #000000;">, [evt.item, evt.from]);  </span><span style="color: #008080;">31</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">32</span>                                 onStart:<span style="color: #0000ff;">function</span>(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">33</span>                                      console.log('onStart.foo:'<span style="color: #000000;">, [evt.item, evt.from]); </span><span style="color: #008080;">34</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">35</span>                                 onSort:<span style="color: #0000ff;">function</span>(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">36</span>                                      console.log('onSort.foo:'<span style="color: #000000;">, [evt.item, evt.from]); </span><span style="color: #008080;">37</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">38</span>                                 onEnd: <span style="color: #0000ff;">function</span>(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">39</span>                                      console.log('onEnd.foo:'<span style="color: #000000;">, [evt.item, evt.from]);  </span><span style="color: #008080;">40</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">41</span> <span style="color: #000000;">                     }); </span><span style="color: #008080;">42</span>       &lt;/script&gt;   <span style="color: #008080;">43</span> &lt;/body&gt; <span style="color: #008080;">44</span> &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>我们看看上面的例子，首先看看当拖拽完成的时候他发生事件顺序</p><p><img src="data:image/png;base64,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" alt=""></p><pre><span style="color: #000000;"><span style="color: #333333;">onAdd onRemove 没有触发说明当列表中的拖拽数据有增加和减少的时候才会发生该事件， 当然如果有兴趣的朋友可以看看他生事件的顺序和条件。</span><br><span style="color: #333333;">还有传递一个evt参数，我们看看该参数有些什么东西。主要看_dispatchEvent 这个函数 改函数的功能是:创建一个事件，事件参数主要由name 提供，并且触发该事件，其实就是模拟事件并且触发该事件。</span><br><span style="color: #333333;">看看改函数的关键源码</span><br><span style="color: #333333;">var evt = document.createEvent('Event'),&nbsp;&nbsp; //创建一个事件</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;options = (sortable || rootEl[expando]).options,&nbsp;&nbsp; //获取options 参数</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//name.charAt(0) 获取name的第一个字符串</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//toUpperCase() 变成大写</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//name.substr(1) 提取从索引为1下标到字符串的结束位置的字符串</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//onName 将获得 on+首个字母大写+name从第一个下标获取到的字符串</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; onName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);</span><br><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.initEvent(name, true, true); //自定义一个事件</span><br><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.to = rootEl; //在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.from = fromEl || rootEl;&nbsp; //在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.item = targetEl || rootEl;&nbsp; //在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.clone = cloneEl;&nbsp;&nbsp; //在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span><br><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.oldIndex = startIndex; //开始拖拽节点</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;evt.newIndex = newIndex; //现在节点</span><br><span style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //触发该事件，并且是在rootEl 节点上面 。触发事件接口就这这里了。onAdd: onUpdate: onRemove:onStart:onSort:onEnd: </span><br><span style="color: #333333;">&nbsp;</span><br><br><br><br><br><span style="color: #333333;">接下来事件有了， 我们怎么做排序呢？其实很简单，只要我们做排序的列表中加一个drag-id就可以，然后在拖拽过程中有几个事件onAdd， onUpdate，onRemove，onStart，onSort，onEnd，</span><br><span style="color: #333333;"> 然后我们不需要关心这么多事件，我们也不需要关心中间拖拽发生了什么事情。然后我们关心的是当拖拽结束之后我们只要调用onEnd事件就可以了 然后改接口会提供 evt。 evt中可以有一个from就是拖列表的根节点<br>只要获取到改节点下面的字节的就可以获取到排序id。请看dome</span><br></span></pre><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC <span style="color: #800000;">"</span><span style="color: #800000;">-//W3C//DTD XHTML 1.0 Transitional//EN</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 2</span> &lt;html xmlns=<span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/1999/xhtml</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 3</span> &lt;head&gt; <span style="color: #008080;"> 4</span> &lt;meta http-equiv=<span style="color: #800000;">"</span><span style="color: #800000;">Content-Type</span><span style="color: #800000;">"</span> content=<span style="color: #800000;">"</span><span style="color: #800000;">text/html; charset=utf-8</span><span style="color: #800000;">"</span> /&gt; <span style="color: #008080;"> 5</span> &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span> &lt;/head&gt; <span style="color: #008080;"> 7</span>      &lt;link href=<span style="color: #800000;">"</span><span style="color: #800000;">app.css</span><span style="color: #800000;">"</span> rel=<span style="color: #800000;">"</span><span style="color: #800000;">stylesheet</span><span style="color: #800000;">"</span> type=<span style="color: #800000;">"</span><span style="color: #800000;">text/css</span><span style="color: #800000;">"</span>/&gt;  <span style="color: #008080;"> 8</span>     &lt;script src=<span style="color: #800000;">"</span><span style="color: #800000;">Sortable.js</span><span style="color: #800000;">"</span>&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>       <span style="color: #008080;">10</span>  &lt;body&gt; <span style="color: #008080;">11</span>       &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">foo</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_words</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">12</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">1</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">1</span>&lt;/li&gt; <span style="color: #008080;">13</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">2</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">2</span>&lt;/li&gt; <span style="color: #008080;">14</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">3</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">3</span>&lt;/li&gt; <span style="color: #008080;">15</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">4</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">4</span>&lt;/li&gt; <span style="color: #008080;">16</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">5</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">5</span>&lt;/li&gt; <span style="color: #008080;">17</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">6</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">6</span>&lt;/li&gt; <span style="color: #008080;">18</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">7</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">7</span>&lt;/li&gt; <span style="color: #008080;">19</span>                 &lt;li drag-id=<span style="color: #800000;">"</span><span style="color: #800000;">8</span><span style="color: #800000;">"</span>&gt;<span style="color: #800080;">8</span>&lt;/li&gt; <span style="color: #008080;">20</span>             &lt;/ul&gt; <span style="color: #008080;">21</span>        &lt;script&gt; <span style="color: #008080;">22</span>                  Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">foo</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">23</span>                                 animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">24</span>                                 onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">25</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">26</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">27</span>                                 onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">28</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">29</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">30</span>                                 onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">31</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">32</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">33</span>                                 onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">34</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">35</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">36</span>                                 onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">37</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">38</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">39</span>                                 onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">40</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">41</span>                                      <span style="color: #0000ff;">var</span> id_arr=<span style="color: #800000;">''</span> <span style="color: #008080;">42</span>                                      <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i=<span style="color: #800080;">0</span>, len=evt.<span style="color: #0000ff;">from</span>.children.length; i&lt;len; i++<span style="color: #000000;">){ </span><span style="color: #008080;">43</span>                                             id_arr+=<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span>+ evt.<span style="color: #0000ff;">from</span>.children[i].getAttribute(<span style="color: #800000;">'</span><span style="color: #800000;">drag-id</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">44</span> <span style="color: #000000;">                                         } </span><span style="color: #008080;">45</span>                                          id_arr=id_arr.substr(<span style="color: #800080;">1</span><span style="color: #000000;">); </span><span style="color: #008080;">46</span>                                          <span style="color: #008000;">//</span><span style="color: #008000;">然后请求后台ajax 这样就完成了拖拽排序</span> <span style="color: #008080;">47</span> <span style="color: #000000;">                                        console.log(id_arr); </span><span style="color: #008080;">48</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">49</span> <span style="color: #000000;">                     }); </span><span style="color: #008080;">50</span>       &lt;/script&gt;   <span style="color: #008080;">51</span> &lt;/body&gt; <span style="color: #008080;">52</span> &lt;/html&gt;</pre> </div><p>&nbsp;</p><p><span style="color: #333333;">该插件还提供了多列表拖拽。下面dome是&nbsp;&nbsp; 从a列表拖拽到b列表，b列表拖拽到a列表 两个俩表互相拖拽，然后主要参数是 group</span></p><p><span style="color: #333333;">如果group不是对象则变成对象，并且group对象的name就等于改group的值 并且添加多['pull', 'put'] 属性默认值是true</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp; 如果设置group{</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; pull:true,&nbsp; 则可以拖拽到其他列表 否则反之</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;put:true,&nbsp; 则可以从其他列表中放数据到改列表，false则反之</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; }</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pull: 'clone', 还有一个作用是克隆，就是当这个列表拖拽到其他列表的时候不会删除改列表的节点。</span></p><p><span style="color: #333333;">看看简单的列表互相拖拽dome&nbsp; 只要设置参数group:"words",&nbsp;&nbsp; group的name要相同才能互相拖拽</span> </p><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC <span style="color: #800000;">"</span><span style="color: #800000;">-//W3C//DTD XHTML 1.0 Transitional//EN</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 2</span> &lt;html xmlns=<span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/1999/xhtml</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 3</span> &lt;head&gt; <span style="color: #008080;"> 4</span> &lt;meta http-equiv=<span style="color: #800000;">"</span><span style="color: #800000;">Content-Type</span><span style="color: #800000;">"</span> content=<span style="color: #800000;">"</span><span style="color: #800000;">text/html; charset=utf-8</span><span style="color: #800000;">"</span> /&gt; <span style="color: #008080;"> 5</span> &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span> &lt;/head&gt; <span style="color: #008080;"> 7</span>     &lt;link href=<span style="color: #800000;">"</span><span style="color: #800000;">app.css</span><span style="color: #800000;">"</span> rel=<span style="color: #800000;">"</span><span style="color: #800000;">stylesheet</span><span style="color: #800000;">"</span> type=<span style="color: #800000;">"</span><span style="color: #800000;">text/css</span><span style="color: #800000;">"</span>/&gt; <span style="color: #008080;"> 8</span>     &lt;script src=<span style="color: #800000;">"</span><span style="color: #800000;">Sortable.js</span><span style="color: #800000;">"</span>&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>  &lt;body&gt; <span style="color: #008080;">10</span>   &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">container</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">height: 520px</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">11</span>         &lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">30</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer block</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">left: 14.5%; top: 0; width: 37%</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">12</span>             &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title</span><span style="color: #800000;">"</span>&gt;List A&lt;/div&gt; <span style="color: #008080;">13</span>             &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">foo</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_words</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">14</span>                 &lt;li&gt;бегемот&lt;/li&gt; <span style="color: #008080;">15</span>                 &lt;li&gt;корм&lt;/li&gt; <span style="color: #008080;">16</span>                 &lt;li&gt;антон&lt;/li&gt; <span style="color: #008080;">17</span>                 &lt;li&gt;сало&lt;/li&gt; <span style="color: #008080;">18</span>                 &lt;li&gt;железосталь&lt;/li&gt; <span style="color: #008080;">19</span>                 &lt;li&gt;валик&lt;/li&gt; <span style="color: #008080;">20</span>                 &lt;li&gt;кровать&lt;/li&gt; <span style="color: #008080;">21</span>                 &lt;li&gt;краб&lt;/li&gt; <span style="color: #008080;">22</span>             &lt;/ul&gt; <span style="color: #008080;">23</span>         &lt;/div&gt; <span style="color: #008080;">24</span>          <span style="color: #008080;">25</span>          <span style="color: #008080;">26</span>          <span style="color: #008080;">27</span>          <span style="color: #008080;">28</span>         &lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">18</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer block</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">left: 58%; top: 143px; width: 40%;</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">29</span>             &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title</span><span style="color: #800000;">"</span>&gt;List B&lt;/div&gt; <span style="color: #008080;">30</span>             &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">bar</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_tags</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">31</span>                 &lt;li&gt;казнить&lt;/li&gt; <span style="color: #008080;">32</span>                 &lt;li&gt;,&lt;/li&gt; <span style="color: #008080;">33</span>                 &lt;li&gt;нельзя&lt;/<span style="color: #000000;">li </span><span style="color: #008080;">34</span>                 &gt;&lt;li&gt;помиловать&lt;/li&gt; <span style="color: #008080;">35</span>             &lt;/ul&gt; <span style="color: #008080;">36</span>         &lt;/div&gt; <span style="color: #008080;">37</span>     &lt;/div&gt; <span style="color: #008080;">38</span>      <span style="color: #008080;">39</span>        &lt;script&gt; <span style="color: #008080;">40</span>        <span style="color: #008080;">41</span>                  Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">foo</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">42</span>                                group:<span style="color: #800000;">"</span><span style="color: #800000;">words</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #008080;">43</span>                                 animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">44</span>                                 onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">45</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">46</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">47</span>                                 onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">48</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">49</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">50</span>                                 onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">51</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">52</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">53</span>                                 onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">54</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">55</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">56</span>                                 onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">57</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">58</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">59</span>                                 onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">60</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">61</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">62</span> <span style="color: #000000;">                     }); </span><span style="color: #008080;">63</span>                       <span style="color: #008080;">64</span>                  <span style="color: #008080;">65</span>                    Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">bar</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">66</span>                                  group:<span style="color: #800000;">"</span><span style="color: #800000;">words</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #008080;">67</span>                                  animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">68</span>                                 onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">69</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">70</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">71</span>                                 onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">72</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">73</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">74</span>                                 onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">75</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">76</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">77</span>                                 onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">78</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">79</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">80</span>                                 onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">81</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">82</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">83</span>                                 onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">84</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">85</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">86</span> <span style="color: #000000;">                     });      </span><span style="color: #008080;">87</span>                       <span style="color: #008080;">88</span>       &lt;/script&gt;   <span style="color: #008080;">89</span> &lt;/body&gt; <span style="color: #008080;">90</span> &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><pre><span style="color: #333333;">当然也支持 只能从a列表拖拽到b列表 dome</span></pre><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC <span style="color: #800000;">"</span><span style="color: #800000;">-//W3C//DTD XHTML 1.0 Transitional//EN</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 2</span> &lt;html xmlns=<span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/1999/xhtml</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 3</span> &lt;head&gt; <span style="color: #008080;"> 4</span> &lt;meta http-equiv=<span style="color: #800000;">"</span><span style="color: #800000;">Content-Type</span><span style="color: #800000;">"</span> content=<span style="color: #800000;">"</span><span style="color: #800000;">text/html; charset=utf-8</span><span style="color: #800000;">"</span> /&gt; <span style="color: #008080;"> 5</span> &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span> &lt;/head&gt; <span style="color: #008080;"> 7</span>     &lt;link href=<span style="color: #800000;">"</span><span style="color: #800000;">app.css</span><span style="color: #800000;">"</span> rel=<span style="color: #800000;">"</span><span style="color: #800000;">stylesheet</span><span style="color: #800000;">"</span> type=<span style="color: #800000;">"</span><span style="color: #800000;">text/css</span><span style="color: #800000;">"</span>/&gt; <span style="color: #008080;"> 8</span>     &lt;script src=<span style="color: #800000;">"</span><span style="color: #800000;">Sortable.js</span><span style="color: #800000;">"</span>&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>  &lt;body&gt; <span style="color: #008080;">10</span>   &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">container</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">height: 520px</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">11</span>         &lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">30</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer block</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">left: 14.5%; top: 0; width: 37%</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">12</span>             &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title</span><span style="color: #800000;">"</span>&gt;List A&lt;/div&gt; <span style="color: #008080;">13</span>             &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">foo</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_words</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">14</span>                 &lt;li&gt;бегемот&lt;/li&gt; <span style="color: #008080;">15</span>                 &lt;li&gt;корм&lt;/li&gt; <span style="color: #008080;">16</span>                 &lt;li&gt;антон&lt;/li&gt; <span style="color: #008080;">17</span>                 &lt;li&gt;сало&lt;/li&gt; <span style="color: #008080;">18</span>                 &lt;li&gt;железосталь&lt;/li&gt; <span style="color: #008080;">19</span>                 &lt;li&gt;валик&lt;/li&gt; <span style="color: #008080;">20</span>                 &lt;li&gt;кровать&lt;/li&gt; <span style="color: #008080;">21</span>                 &lt;li&gt;краб&lt;/li&gt; <span style="color: #008080;">22</span>             &lt;/ul&gt; <span style="color: #008080;">23</span>         &lt;/div&gt; <span style="color: #008080;">24</span>          <span style="color: #008080;">25</span>          <span style="color: #008080;">26</span>          <span style="color: #008080;">27</span>          <span style="color: #008080;">28</span>         &lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">18</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer block</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">left: 58%; top: 143px; width: 40%;</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">29</span>             &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title</span><span style="color: #800000;">"</span>&gt;List B&lt;/div&gt; <span style="color: #008080;">30</span>             &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">bar</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_tags</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">31</span>                 &lt;li&gt;казнить&lt;/li&gt; <span style="color: #008080;">32</span>                 &lt;li&gt;,&lt;/li&gt; <span style="color: #008080;">33</span>                 &lt;li&gt;нельзя&lt;/<span style="color: #000000;">li </span><span style="color: #008080;">34</span>                 &gt;&lt;li&gt;помиловать&lt;/li&gt; <span style="color: #008080;">35</span>             &lt;/ul&gt; <span style="color: #008080;">36</span>         &lt;/div&gt; <span style="color: #008080;">37</span>     &lt;/div&gt; <span style="color: #008080;">38</span>      <span style="color: #008080;">39</span>        &lt;script&gt; <span style="color: #008080;">40</span>       <span style="color: #008080;">41</span>                  Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">foo</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">42</span> <span style="color: #000000;">                               group: { </span><span style="color: #008080;">43</span>                                        name:<span style="color: #800000;">"</span><span style="color: #800000;">words</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #008080;">44</span>                                        pull: <span style="color: #0000ff;">true</span><span style="color: #000000;">, </span><span style="color: #008080;">45</span>                                        put: <span style="color: #0000ff;">true</span>  <span style="color: #008080;">46</span> <span style="color: #000000;">                                   }, </span><span style="color: #008080;">47</span>                                 animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">48</span>                                 onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">49</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">50</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">51</span>                                 onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">52</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">53</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">54</span>                                 onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">55</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">56</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">57</span>                                 onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">58</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">59</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">60</span>                                 onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">61</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">62</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">63</span>                                 onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">64</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">65</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">66</span> <span style="color: #000000;">                     }); </span><span style="color: #008080;">67</span>                       <span style="color: #008080;">68</span>                  <span style="color: #008080;">69</span>                    Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">bar</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">70</span> <span style="color: #000000;">                                 group: { </span><span style="color: #008080;">71</span>                                        name:<span style="color: #800000;">"</span><span style="color: #800000;">words</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #008080;">72</span>                                        pull: <span style="color: #0000ff;">false</span><span style="color: #000000;">, </span><span style="color: #008080;">73</span>                                        put: <span style="color: #0000ff;">true</span>  <span style="color: #008080;">74</span> <span style="color: #000000;">                                   }, </span><span style="color: #008080;">75</span>                                 animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">76</span>                                 onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">77</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">78</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">79</span>                                 onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">80</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">81</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">82</span>                                 onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">83</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">84</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">85</span>                                 onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">86</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">87</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">88</span>                                 onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">89</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">90</span> <span style="color: #000000;">                                }, </span><span style="color: #008080;">91</span>                                 onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">92</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">93</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">94</span> <span style="color: #000000;">                     });      </span><span style="color: #008080;">95</span>                       <span style="color: #008080;">96</span>       &lt;/script&gt;   <span style="color: #008080;">97</span> &lt;/body&gt; <span style="color: #008080;">98</span> &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #333333;">当然也支持克隆 从a列表可克隆dom节点拖拽添加到b俩表 只要把参数 pull: 'clone', 这样就可以了 dome</span></p><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html PUBLIC <span style="color: #800000;">"</span><span style="color: #800000;">-//W3C//DTD XHTML 1.0 Transitional//EN</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 2</span>   &lt;html xmlns=<span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/1999/xhtml</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 3</span>   &lt;head&gt; <span style="color: #008080;"> 4</span>   &lt;meta http-equiv=<span style="color: #800000;">"</span><span style="color: #800000;">Content-Type</span><span style="color: #800000;">"</span> content=<span style="color: #800000;">"</span><span style="color: #800000;">text/html; charset=utf-8</span><span style="color: #800000;">"</span> /&gt; <span style="color: #008080;"> 5</span>   &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span>   &lt;/head&gt; <span style="color: #008080;"> 7</span>      &lt;link href=<span style="color: #800000;">"</span><span style="color: #800000;">app.css</span><span style="color: #800000;">"</span> rel=<span style="color: #800000;">"</span><span style="color: #800000;">stylesheet</span><span style="color: #800000;">"</span> type=<span style="color: #800000;">"</span><span style="color: #800000;">text/css</span><span style="color: #800000;">"</span>/&gt; <span style="color: #008080;"> 8</span>      &lt;script src=<span style="color: #800000;">"</span><span style="color: #800000;">Sortable.js</span><span style="color: #800000;">"</span>&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>   &lt;body&gt; <span style="color: #008080;">10</span>     &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">container</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">height: 520px</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">11</span>           &lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">30</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer block</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">left: 14.5%; top: 0; width: 37%</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">12</span>               &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title</span><span style="color: #800000;">"</span>&gt;List A&lt;/div&gt; <span style="color: #008080;">13</span>              &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">foo</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_words</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">14</span>                  &lt;li&gt;бегемот&lt;/li&gt; <span style="color: #008080;">15</span>                   &lt;li&gt;корм&lt;/li&gt; <span style="color: #008080;">16</span>                  &lt;li&gt;антон&lt;/li&gt;     <span style="color: #008080;">17</span>                     &lt;li&gt;сало&lt;/li&gt; <span style="color: #008080;">18</span>                  &lt;li&gt;железосталь&lt;/li&gt; <span style="color: #008080;">19</span>                  &lt;li&gt;валик&lt;/li&gt; <span style="color: #008080;">20</span>                 &lt;li&gt;кровать&lt;/li&gt; <span style="color: #008080;">21</span>                 &lt;li&gt;краб&lt;/li&gt; <span style="color: #008080;">22</span>              &lt;/ul&gt; <span style="color: #008080;">23</span>          &lt;/div&gt; <span style="color: #008080;">24</span>           <span style="color: #008080;">25</span>           <span style="color: #008080;">26</span>           <span style="color: #008080;">27</span>          &lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">18</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer block</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">left: 58%; top: 143px; width: 40%;</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">28</span>              &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title</span><span style="color: #800000;">"</span>&gt;List B&lt;/div&gt; <span style="color: #008080;">29</span>              &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">bar</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_tags</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">30</span>                  &lt;li&gt;казнить&lt;/li&gt; <span style="color: #008080;">31</span>                  &lt;li&gt;,&lt;/li&gt; <span style="color: #008080;">32</span>                  &lt;li&gt;нельзя&lt;/<span style="color: #000000;">li </span><span style="color: #008080;">33</span>                  &gt;&lt;li&gt;помиловать&lt;/li&gt; <span style="color: #008080;">34</span>              &lt;/ul&gt; <span style="color: #008080;">35</span>          &lt;/div&gt; <span style="color: #008080;">36</span>      &lt;/div&gt; <span style="color: #008080;">37</span>      <span style="color: #008080;">38</span>         &lt;script&gt; <span style="color: #008080;">39</span>          <span style="color: #008080;">40</span>                   Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">foo</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">41</span> <span style="color: #000000;">                                group: { </span><span style="color: #008080;">42</span>                                         name:<span style="color: #800000;">"</span><span style="color: #800000;">words</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #008080;">43</span>                                         pull: <span style="color: #800000;">'</span><span style="color: #800000;">clone</span><span style="color: #800000;">'</span><span style="color: #000000;">, </span><span style="color: #008080;">44</span>                                         put: <span style="color: #0000ff;">true</span>  <span style="color: #008080;">45</span> <span style="color: #000000;">                                    }, </span><span style="color: #008080;">46</span>                                  animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">47</span>                                  onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">48</span>                                       console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">49</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">50</span>                                 onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">51</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">52</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">53</span>                                  onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">54</span>                                       console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">55</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">56</span>                                  onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">57</span>                                       console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">58</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">59</span>                                  onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">60</span>                                       console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">61</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">62</span>                                  onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">63</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">64</span> <span style="color: #000000;">                                 } </span><span style="color: #008080;">65</span> <span style="color: #000000;">                      }); </span><span style="color: #008080;">66</span>                       <span style="color: #008080;">67</span>                   <span style="color: #008080;">68</span>                     Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">bar</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">69</span> <span style="color: #000000;">                                 group: { </span><span style="color: #008080;">70</span>                                         name:<span style="color: #800000;">"</span><span style="color: #800000;">words</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #008080;">71</span>                                        pull: <span style="color: #0000ff;">false</span><span style="color: #000000;">, </span><span style="color: #008080;">72</span>                                         put: <span style="color: #0000ff;">true</span>  <span style="color: #008080;">73</span> <span style="color: #000000;">                                    }, </span><span style="color: #008080;">74</span>                                  animation: <span style="color: #800080;">150</span>, <span style="color: #008000;">//</span><span style="color: #008000;">动画参数</span> <span style="color: #008080;">75</span>                                 onAdd: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽时候添加有新的节点的时候发生该事件</span> <span style="color: #008080;">76</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onAdd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">77</span> <span style="color: #000000;">                              }, </span><span style="color: #008080;">78</span>                                  onUpdate: function (evt){  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽更新节点位置发生该事件</span> <span style="color: #008080;">79</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onUpdate.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);   </span><span style="color: #008080;">80</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">81</span>                               onRemove: function (evt){   <span style="color: #008000;">//</span><span style="color: #008000;">删除拖拽节点的时候促发该事件</span> <span style="color: #008080;">82</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onRemove.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">83</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">84</span>                                  onStart:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽出发该函数</span> <span style="color: #008080;">85</span>                                     console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onStart.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">86</span> <span style="color: #000000;">                               }, </span><span style="color: #008080;">87</span>                                 onSort:function(evt){  <span style="color: #008000;">//</span><span style="color: #008000;">发生排序发生该事件</span> <span style="color: #008080;">88</span>                                      console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onSort.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]); </span><span style="color: #008080;">89</span> <span style="color: #000000;">                                 }, </span><span style="color: #008080;">90</span>                                 onEnd: function(evt){ <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完毕之后发生该事件</span> <span style="color: #008080;">91</span>                                       console.log(<span style="color: #800000;">'</span><span style="color: #800000;">onEnd.foo:</span><span style="color: #800000;">'</span>, [evt.item, evt.<span style="color: #0000ff;">from</span><span style="color: #000000;">]);  </span><span style="color: #008080;">92</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">93</span> <span style="color: #000000;">                     });                         </span><span style="color: #008080;">94</span>        &lt;/script&gt;   <span style="color: #008080;">95</span>  &lt;/body&gt; <span style="color: #008080;">96</span>  &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #333333;">&nbsp;该插件也支持删除拖拽列表的节点，主要是设置filter 参数，改参数可以设置成函数，但是设置成函数的时候不还要自己定义拖拽，显得有些麻烦，所以一般设置成class，或者是tag，设置成class和tag的时候就是做拖拽列表中含有calss，tag的节点可以点击的时候可以触发onFilter函数，触发会传递一个evt参数进来evt.item 就是class或者tag的dom节点，可以通过他们的血缘关系从而删除需要删除的节点。</span></p><div class="cnblogs_code"> <pre><span style="color: #008080;"> 1</span>  &lt;!DOCTYPE html PUBLIC <span style="color: #800000;">"</span><span style="color: #800000;">-//W3C//DTD XHTML 1.0 Transitional//EN</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 2</span>   &lt;html xmlns=<span style="color: #800000;">"</span><span style="color: #800000;">http://www.w3.org/1999/xhtml</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;"> 3</span>   &lt;head&gt; <span style="color: #008080;"> 4</span>   &lt;meta http-equiv=<span style="color: #800000;">"</span><span style="color: #800000;">Content-Type</span><span style="color: #800000;">"</span> content=<span style="color: #800000;">"</span><span style="color: #800000;">text/html; charset=utf-8</span><span style="color: #800000;">"</span> /&gt; <span style="color: #008080;"> 5</span>   &lt;title&gt;无标题文档&lt;/title&gt; <span style="color: #008080;"> 6</span>   &lt;/head&gt; <span style="color: #008080;"> 7</span>      &lt;link href=<span style="color: #800000;">"</span><span style="color: #800000;">st/app.css</span><span style="color: #800000;">"</span> rel=<span style="color: #800000;">"</span><span style="color: #800000;">stylesheet</span><span style="color: #800000;">"</span> type=<span style="color: #800000;">"</span><span style="color: #800000;">text/css</span><span style="color: #800000;">"</span>/&gt; <span style="color: #008080;"> 8</span>       &lt;script src=<span style="color: #800000;">"</span><span style="color: #800000;">Sortable3.js</span><span style="color: #800000;">"</span>&gt;&lt;/script&gt; <span style="color: #008080;"> 9</span>   &lt;body&gt; <span style="color: #008080;">10</span>   <span style="color: #008080;">11</span>  &lt;body&gt; <span style="color: #008080;">12</span>  &lt;!-- Editable list --&gt; <span style="color: #008080;">13</span>     &lt;a name=<span style="color: #800000;">"</span><span style="color: #800000;">e</span><span style="color: #800000;">"</span>&gt;&lt;/a&gt; <span style="color: #008080;">14</span>      &lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">container</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">margin-top: 100px</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">15</span>          &lt;div id=<span style="color: #800000;">"</span><span style="color: #800000;">filter</span><span style="color: #800000;">"</span> style=<span style="color: #800000;">"</span><span style="color: #800000;">margin-left: 30px</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">16</span>              &lt;div&gt;&lt;div data-force=<span style="color: #800000;">"</span><span style="color: #800000;">5</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">layer title title_xl</span><span style="color: #800000;">"</span>&gt;Editable list&lt;/div&gt;&lt;/div&gt; <span style="color: #008080;">17</span>   <span style="color: #008080;">18</span>              &lt;div style=<span style="color: #800000;">"</span><span style="color: #800000;">margin-top: -8px; margin-left: 10px</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">block__list block__list_words</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">19</span>                  &lt;ul id=<span style="color: #800000;">"</span><span style="color: #800000;">editable</span><span style="color: #800000;">"</span>&gt; <span style="color: #008080;">20</span>                      &lt;li&gt;Оля&lt;i <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">js-remove</span><span style="color: #800000;">"</span>&gt;✖&lt;/i&gt;&lt;/li&gt; <span style="color: #008080;">21</span>                      &lt;li&gt;Владимир&lt;i <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">js-remove</span><span style="color: #800000;">"</span>&gt;✖&lt;/i&gt;&lt;/li&gt; <span style="color: #008080;">22</span>                      &lt;li&gt;Алина&lt;i <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">js-remove</span><span style="color: #800000;">"</span>&gt;✖&lt;/i&gt;&lt;/li&gt; <span style="color: #008080;">23</span>                  &lt;/ul&gt; <span style="color: #008080;">24</span>   <span style="color: #008080;">25</span>            <span style="color: #008080;">26</span>             &lt;/div&gt; <span style="color: #008080;">27</span>          &lt;/div&gt; <span style="color: #008080;">28</span>      &lt;/div&gt; <span style="color: #008080;">29</span>  &lt;script&gt; <span style="color: #008080;">30</span>  <span style="color: #008000;">//</span><span style="color: #008000;"> Editable list</span> <span style="color: #008080;">31</span>      <span style="color: #0000ff;">var</span> editableList = Sortable.create(document.getElementById(<span style="color: #800000;">'</span><span style="color: #800000;">editable</span><span style="color: #800000;">'</span><span style="color: #000000;">), { </span><span style="color: #008080;">32</span>          animation: <span style="color: #800080;">150</span><span style="color: #000000;">, </span><span style="color: #008080;">33</span>          filter: <span style="color: #800000;">'</span><span style="color: #800000;">.js-remove</span><span style="color: #800000;">'</span><span style="color: #000000;">, </span><span style="color: #008080;">34</span> <span style="color: #000000;">         onFilter: function (evt) { </span><span style="color: #008080;">35</span> <span style="color: #000000;">             console.log(evt.item) </span><span style="color: #008080;">36</span> <span style="color: #000000;">             evt.item.parentNode.parentNode.removeChild(evt.item.parentNode); </span><span style="color: #008080;">37</span> <span style="color: #000000;">         } </span><span style="color: #008080;">38</span> <span style="color: #000000;">     }); </span><span style="color: #008080;">39</span>  <span style="color: #008080;">40</span>  &lt;/script&gt; <span style="color: #008080;">41</span>  &lt;/body&gt; <span style="color: #008080;">42</span>  &lt;/html&gt;</pre> </div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #333333;">Sortable.js 接口参数还有很多个，不 一 一 做dome了列出来给大家看看，其中比较常用的是上面所说的dome参数，还有handle这个参数也常用规定哪些calss，或者tag拖拽。</span></p><p>&nbsp;</p><p><span style="color: #333333;">其他参数接口设置： </span><br><span style="color: #333333;">&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;group: Math.random(),&nbsp; //产生一个随机数 //产生一个随机数 //改参数是对象有三个两个参数&nbsp;&nbsp;  pull: 拉, &nbsp;&nbsp; &nbsp;put:放&nbsp;&nbsp; 默认都是是true&nbsp;&nbsp; pull还有一个值是: 'clone',&nbsp;&nbsp; pull: 拉, &nbsp;&nbsp;  &nbsp;put:放 设置为false 就不能拖拽了， 如果 pull 这种为'clone'则可以重一个列表中拖拽到另一个列表并且克隆dom节点，  name：是两个或者多个列表拖拽之间的通信，如果name相同则他们可以互相拖拽</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;sort: true,&nbsp; // 类型：Boolean,分类&nbsp; false时候在自己的拖拽区域不能拖拽，但是可以拖拽到其他区域，true则可以做自己区域拖拽或者其他授权地方拖拽</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;disabled: false,&nbsp; //类型：Boolean 是否禁用拖拽 true 则不能拖拽 默认是true</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;store: null,&nbsp; // 用来html5 存储的 改返回 拖拽的节点的唯一id</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;handle: null, //handle 这个参数是设置该标签，或者该class可以拖拽&nbsp; 但是不要设置 id的节点和子节点相同的tag不然会有bug</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;scroll: true,&nbsp; //类型：Boolean，设置拖拽的时候滚动条是否智能滚动。默认为真，则智能滚动，false则不智能滚动</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;scrollSensitivity: 30,&nbsp; //滚动的灵敏度,其实是拖拽离滚动边界的距离触发事件的距离边界+-30px的地方触发拖拽滚动事件，</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;scrollSpeed: 10,&nbsp; //滚动速度</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;draggable: /[uo]l/i.test(el.nodeName) ? 'li' : '&gt;*',//draggable 判断拖拽节点的父层是否是ou ul</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;ghostClass: 'sortable-ghost',&nbsp; // 排序镜像class,就是当鼠标拉起拖拽节点的时候添加该class</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;chosenClass: 'sortable-chosen', // //为拖拽的节点添加一个class 开始拖拽鼠标按下去的时候 添加该class</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;ignore: 'a, img',&nbsp;&nbsp; //a 或者是img</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;filter: null,&nbsp; //改参数可以传递一个函数，或者字符串，字符串可以是class或者tag，然后用于触发oFilter函数，这样可以用来自定义事件等</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;animation: 0, //拖拽动画时间戳</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;setData: function (dataTransfer, dragEl) { //设置拖拽传递的参数</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dataTransfer.setData('Text', dragEl.textContent);</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;},</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dropBubble: false,&nbsp; // 发生 drop事件 拖拽的时候是否阻止事件冒泡 </span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dragoverBubble: false,&nbsp; //发生 dragover 事件 拖拽的时候是否阻止事件冒泡 </span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dataIdAttr: 'data-id', //拖拽元素的id 数组</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;delay: 0,&nbsp; //延迟拖拽时间, 其实就是鼠标按下去拖拽延迟</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;forceFallback: false,&nbsp; // 不详</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;fallbackClass: 'sortable-fallback',&nbsp;&nbsp; // 排序回退class</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;fallbackOnBody: false,// 是否把拖拽镜像节点ghostEl放到body上</span><br><span style="color: #333333;">&nbsp;&nbsp; &nbsp;&nbsp; <br></span></p><p><span style="color: #333333;">&nbsp;</span></p><p><span style="color: #333333;">下面是Sortable.js插件源码，本人花了一些时间做了注释，有兴趣的朋友可以研究下。如果您发现哪些地方有错误注释可以联系我的邮箱281113270@qq.com ； 技术交流qq群：&nbsp;302817612</span></p><div class="cnblogs_code"> <pre><span style="color: #008080;">   1</span> <span style="color: #008000;">/*</span><span style="color: #008000;">*! </span><span style="color: #008080;">   2</span> <span style="color: #008000;"> * Sortable </span><span style="color: #008080;">   3</span> <span style="color: #008000;"> * @author    RubaXa   &lt;trash@rubaxa.org&gt; </span><span style="color: #008080;">   4</span> <span style="color: #008000;"> * @license MIT </span><span style="color: #008080;">   5</span>  <span style="color: #008000;">*/</span> <span style="color: #008080;">   6</span>  <span style="color: #008080;">   7</span>  <span style="color: #008080;">   8</span> <span style="color: #000000;">(function (factory) { </span><span style="color: #008080;">   9</span>           <span style="color: #008080;">  10</span>     <span style="color: #800000;">"</span><span style="color: #800000;">use strict</span><span style="color: #800000;">"</span>;  <span style="color: #008000;">//</span><span style="color: #008000;">严格模式</span> <span style="color: #008080;">  11</span>  <span style="color: #008080;">  12</span>     <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> define === <span style="color: #800000;">"</span><span style="color: #800000;">function</span><span style="color: #800000;">"</span> &amp;&amp; define.amd) { <span style="color: #008000;">//</span><span style="color: #008000;">兼容 require.js 写法</span> <span style="color: #008080;">  13</span> <span style="color: #000000;">        define(factory); </span><span style="color: #008080;">  14</span> <span style="color: #000000;">    } </span><span style="color: #008080;">  15</span>     <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> module != <span style="color: #800000;">"</span><span style="color: #800000;">undefined</span><span style="color: #800000;">"</span> &amp;&amp; <span style="color: #0000ff;">typeof</span> module.exports != <span style="color: #800000;">"</span><span style="color: #800000;">undefined</span><span style="color: #800000;">"</span>) { <span style="color: #008000;">//</span><span style="color: #008000;">兼容node写法</span> <span style="color: #008080;">  16</span>         module.exports =<span style="color: #000000;"> factory(); </span><span style="color: #008080;">  17</span> <span style="color: #000000;">    } </span><span style="color: #008080;">  18</span>     <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> Package !== <span style="color: #800000;">"</span><span style="color: #800000;">undefined</span><span style="color: #800000;">"</span><span style="color: #000000;">) { </span><span style="color: #008080;">  19</span>         Sortable = factory();  <span style="color: #008000;">//</span><span style="color: #008000;"> export for Meteor.js 兼容 Meteor.js  写法</span> <span style="color: #008080;">  20</span> <span style="color: #000000;">    } </span><span style="color: #008080;">  21</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">  22</span>         <span style="color: #008000;">/*</span><span style="color: #008000;"> jshint sub:true </span><span style="color: #008000;">*/</span> <span style="color: #008080;">  23</span>         window[<span style="color: #800000;">"</span><span style="color: #800000;">Sortable</span><span style="color: #800000;">"</span>] = factory();  <span style="color: #008000;">//</span><span style="color: #008000;">把它挂载在window下</span> <span style="color: #008080;">  24</span>          <span style="color: #008080;">  25</span>           <span style="color: #008080;">  26</span> <span style="color: #000000;">    } </span><span style="color: #008080;">  27</span> <span style="color: #000000;">})(function () { </span><span style="color: #008080;">  28</span>     <span style="color: #800000;">"</span><span style="color: #800000;">use strict</span><span style="color: #800000;">"</span><span style="color: #000000;">; </span><span style="color: #008080;">  29</span>      <span style="color: #008080;">  30</span>     <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> window == <span style="color: #800000;">"</span><span style="color: #800000;">undefined</span><span style="color: #800000;">"</span> || <span style="color: #0000ff;">typeof</span> window.document == <span style="color: #800000;">"</span><span style="color: #800000;">undefined</span><span style="color: #800000;">"</span>) { <span style="color: #008000;">//</span><span style="color: #008000;">判断该js是否在window或者document 下运行</span> <span style="color: #008080;">  31</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> function () { </span><span style="color: #008080;">  32</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Error(<span style="color: #800000;">"</span><span style="color: #800000;">Sortable.js requires a window with a document</span><span style="color: #800000;">"</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">如果不是则抛出一个错误</span> <span style="color: #008080;">  33</span> <span style="color: #000000;">        }; </span><span style="color: #008080;">  34</span> <span style="color: #000000;">    } </span><span style="color: #008080;">  35</span> <span style="color: #0000ff;">var</span> i=<span style="color: #800080;">0</span><span style="color: #000000;">; </span><span style="color: #008080;">  36</span>     <span style="color: #0000ff;">var</span> dragEl,  <span style="color: #008000;">//</span><span style="color: #008000;">当前拖拽节点,开始拖拽节点，鼠标按下去的节点</span> <span style="color: #008080;">  37</span> <span style="color: #000000;">        parentEl, </span><span style="color: #008080;">  38</span>         ghostEl,  <span style="color: #008000;">//</span><span style="color: #008000;"> 拖拽镜像节点</span> <span style="color: #008080;">  39</span>         cloneEl,   <span style="color: #008000;">//</span><span style="color: #008000;">克隆节点</span> <span style="color: #008080;">  40</span>         rootEl,    <span style="color: #008000;">//</span><span style="color: #008000;">鼠标开始按下去拖拽的根节点</span> <span style="color: #008080;">  41</span>         nextEl,  <span style="color: #008000;">//</span><span style="color: #008000;">下一个节点</span> <span style="color: #008080;">  42</span>  <span style="color: #008080;">  43</span>         scrollEl,<span style="color: #008000;">//</span><span style="color: #008000;">滚动节点</span> <span style="color: #008080;">  44</span>         scrollParentEl, <span style="color: #008000;">//</span><span style="color: #008000;">滚动的父节点</span> <span style="color: #008080;">  45</span>  <span style="color: #008080;">  46</span>         lastEl,    <span style="color: #008000;">//</span><span style="color: #008000;">根节点中的最后一个自己点</span> <span style="color: #008080;">  47</span> <span style="color: #000000;">        lastCSS, </span><span style="color: #008080;">  48</span> <span style="color: #000000;">        lastParentCSS, </span><span style="color: #008080;">  49</span>  <span style="color: #008080;">  50</span>         oldIndex, <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽节点的索引 就是鼠标按下去拖拽节点的索引</span> <span style="color: #008080;">  51</span>         newIndex, <span style="color: #008000;">//</span><span style="color: #008000;">拖拽完之后现在节点</span> <span style="color: #008080;">  52</span>          <span style="color: #008080;">  53</span>  <span style="color: #008080;">  54</span> <span style="color: #000000;">        activeGroup, </span><span style="color: #008080;">  55</span>         autoScroll = {},  <span style="color: #008000;">//</span><span style="color: #008000;">滚动对象用于存鼠标的xy轴</span> <span style="color: #008080;">  56</span> <span style="color: #008000;">/*</span> <span style="color: #008080;">  57</span> <span style="color: #008000;">tapEvt 触摸对象包括x与y轴与拖拽当前节点 </span><span style="color: #008080;">  58</span> <span style="color: #008000;">tapEvt = { </span><span style="color: #008080;">  59</span> <span style="color: #008000;">                    target: dragEl, </span><span style="color: #008080;">  60</span> <span style="color: #008000;">                    clientX: touch.clientX, </span><span style="color: #008080;">  61</span> <span style="color: #008000;">                    clientY: touch.clientY </span><span style="color: #008080;">  62</span> <span style="color: #008000;">                }; </span><span style="color: #008080;">  63</span>                  <span style="color: #008000;">*/</span> <span style="color: #008080;">  64</span> <span style="color: #000000;">        tapEvt,  </span><span style="color: #008080;">  65</span> <span style="color: #000000;">        touchEvt, </span><span style="color: #008080;">  66</span>  <span style="color: #008080;">  67</span> <span style="color: #000000;">        moved, </span><span style="color: #008080;">  68</span>  <span style="color: #008080;">  69</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* @const </span><span style="color: #008000;">*/</span> <span style="color: #008080;">  70</span>         RSPACE = /\s+/g,  <span style="color: #008000;">//</span><span style="color: #008000;">全局匹配空格</span> <span style="color: #008080;">  71</span>  <span style="color: #008080;">  72</span>         expando = <span style="color: #800000;">'</span><span style="color: #800000;">Sortable</span><span style="color: #800000;">'</span> + (<span style="color: #0000ff;">new</span> Date).getTime(),  <span style="color: #008000;">//</span><span style="color: #008000;">字符串Sortable+时间戳</span> <span style="color: #008080;">  73</span>  <span style="color: #008080;">  74</span>         win = window,  <span style="color: #008000;">//</span><span style="color: #008000;">缩写win</span> <span style="color: #008080;">  75</span>         document =<span style="color: #000000;"> win.document, </span><span style="color: #008080;">  76</span>         parseInt =<span style="color: #000000;"> win.parseInt; </span><span style="color: #008080;">  77</span>       <span style="color: #008000;">//</span><span style="color: #008000;">draggable html5 拖拽属性 初始化的时候是true</span> <span style="color: #008080;">  78</span>   <span style="color: #008080;">  79</span>   <span style="color: #008080;">  80</span>     <span style="color: #0000ff;">var</span>     supportDraggable = !!(<span style="color: #800000;">'</span><span style="color: #800000;">draggable</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> document.createElement(<span style="color: #800000;">'</span><span style="color: #800000;">div</span><span style="color: #800000;">'</span><span style="color: #000000;">)), </span><span style="color: #008080;">  81</span>         <span style="color: #008000;">//</span><span style="color: #008000;">判断浏览器是否支持css3 这个属性pointer-events</span> <span style="color: #008080;">  82</span>         supportCssPointerEvents =<span style="color: #000000;"> (function (el) { </span><span style="color: #008080;">  83</span>             el = document.createElement(<span style="color: #800000;">'</span><span style="color: #800000;">x</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">  84</span>             el.style.cssText = <span style="color: #800000;">'</span><span style="color: #800000;">pointer-events:auto</span><span style="color: #800000;">'</span><span style="color: #000000;">; </span><span style="color: #008080;">  85</span>             <span style="color: #0000ff;">return</span> el.style.pointerEvents === <span style="color: #800000;">'</span><span style="color: #800000;">auto</span><span style="color: #800000;">'</span><span style="color: #000000;">; </span><span style="color: #008080;">  86</span> <span style="color: #000000;">        })(), </span><span style="color: #008080;">  87</span>  <span style="color: #008080;">  88</span>         _silent = <span style="color: #0000ff;">false</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">默认</span> <span style="color: #008080;">  89</span>  <span style="color: #008080;">  90</span>         abs =<span style="color: #000000;"> Math.abs, </span><span style="color: #008080;">  91</span>         slice =<span style="color: #000000;"> [].slice, </span><span style="color: #008080;">  92</span>  <span style="color: #008080;">  93</span>         touchDragOverListeners = [],  <span style="color: #008000;">//</span><span style="color: #008000;">新建一个数组 鼠标触摸拖拽数组 </span><span style="color: #008080;">  94</span>       <span style="color: #008000;">//</span><span style="color: #008000;">_autoScroll 相当于 被一个函数付值</span> <span style="color: #008080;">  95</span>        <span style="color: #008080;">  96</span> <span style="color: #008000;">/*</span><span style="color: #008000;">      _autoScroll = function(callback,ms){ </span><span style="color: #008080;">  97</span> <span style="color: #008000;">         var args, </span><span style="color: #008080;">  98</span> <span style="color: #008000;">              _this; </span><span style="color: #008080;">  99</span> <span style="color: #008000;">           if (args === void 0) { </span><span style="color: #008080;"> 100</span> <span style="color: #008000;">                args = arguments; </span><span style="color: #008080;"> 101</span> <span style="color: #008000;">                _this = this; </span><span style="color: #008080;"> 102</span>  <span style="color: #008080;"> 103</span> <span style="color: #008000;">                setTimeout(function () { </span><span style="color: #008080;"> 104</span> <span style="color: #008000;">                    if (args.length === 1) { </span><span style="color: #008080;"> 105</span> <span style="color: #008000;">                        callback.call(_this, args[0]); </span><span style="color: #008080;"> 106</span> <span style="color: #008000;">                    } else { </span><span style="color: #008080;"> 107</span> <span style="color: #008000;">                        callback.apply(_this, args); </span><span style="color: #008080;"> 108</span> <span style="color: #008000;">                    } </span><span style="color: #008080;"> 109</span>  <span style="color: #008080;"> 110</span> <span style="color: #008000;">                    args = void 0; </span><span style="color: #008080;"> 111</span> <span style="color: #008000;">                }, ms); </span><span style="color: #008080;"> 112</span> <span style="color: #008000;">            } </span><span style="color: #008080;"> 113</span> <span style="color: #008000;">         其实就是_autoScroll=function(参数){ </span><span style="color: #008080;"> 114</span> <span style="color: #008000;">               放到 _throttle 的回调函数中 function (/参数/)  </span><span style="color: #008080;"> 115</span> <span style="color: #008000;">             } </span><span style="color: #008080;"> 116</span> <span style="color: #008000;">         }</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 117</span>           <span style="color: #008080;"> 118</span>           <span style="color: #008080;"> 119</span>           <span style="color: #008080;"> 120</span>           <span style="color: #008080;"> 121</span>      <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 122</span> <span style="color: #008000;">     *函数名 ：_autoScroll </span><span style="color: #008080;"> 123</span> <span style="color: #008000;">     *函数功能描述 ： 拖拽智能滚动 </span><span style="color: #008080;"> 124</span> <span style="color: #008000;">     *函数参数 ：  </span><span style="color: #008080;"> 125</span> <span style="color: #008000;">                      evt： </span><span style="color: #008080;"> 126</span> <span style="color: #008000;">                             类型：boj, 事件对象 </span><span style="color: #008080;"> 127</span> <span style="color: #008000;">                             options：类型：obj， 参数类 </span><span style="color: #008080;"> 128</span> <span style="color: #008000;">                             rootEl：类型：obj dom节点，拖拽的目标节点      </span><span style="color: #008080;"> 129</span> <span style="color: #008000;">     *函数返回值 ： viod </span><span style="color: #008080;"> 130</span> <span style="color: #008000;">     *作者 ：  </span><span style="color: #008080;"> 131</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;"> 132</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;"> 133</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;"> 134</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;"> 135</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;"> 136</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;"> 137</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 138</span>         _autoScroll =<span style="color: #000000;"> _throttle( </span><span style="color: #008080;"> 139</span>          <span style="color: #008000;">//</span><span style="color: #008000;">回调函数</span> <span style="color: #008080;"> 140</span>         function (<span style="color: #008000;">/*</span><span style="color: #008000;">*Event</span><span style="color: #008000;">*/</span>evt, <span style="color: #008000;">/*</span><span style="color: #008000;">*Object</span><span style="color: #008000;">*/</span>options, <span style="color: #008000;">/*</span><span style="color: #008000;">*HTMLElement</span><span style="color: #008000;">*/</span><span style="color: #000000;">rootEl) { </span><span style="color: #008080;"> 141</span>             <span style="color: #008000;">//</span><span style="color: #008000;">每次拖拽只会调用一次该函数 </span><span style="color: #008080;"> 142</span>            <span style="color: #008080;"> 143</span>   <span style="color: #008080;"> 144</span>             <span style="color: #008000;">//</span><span style="color: #008000;">evt 是事件对象 event </span><span style="color: #008080;"> 145</span>              <span style="color: #008000;">//</span><span style="color: #008000;">options.scroll如果为真 并且rootEl 为真的时候 </span><span style="color: #008080;"> 146</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Bug: </span><span style="color: #008000; text-decoration: underline;">https://bugzilla.mozilla.org/show_bug.cgi?id=505521</span> <span style="color: #008080;"> 147</span>             <span style="color: #0000ff;">if</span> (rootEl &amp;&amp;<span style="color: #000000;"> options.scroll) { </span><span style="color: #008080;"> 148</span>                 <span style="color: #0000ff;">var</span><span style="color: #000000;"> el, </span><span style="color: #008080;"> 149</span> <span style="color: #000000;">                    rect, </span><span style="color: #008080;"> 150</span>                      sens = options.scrollSensitivity,  <span style="color: #008000;">//</span><span style="color: #008000;">滚动灵敏度 默认是30</span> <span style="color: #008080;"> 151</span>                      speed = options.scrollSpeed,   <span style="color: #008000;">//</span><span style="color: #008000;">滚动速度 默认是10</span> <span style="color: #008080;"> 152</span>                      x = evt.clientX,    <span style="color: #008000;">//</span><span style="color: #008000;">获取鼠标在可视窗口的x值</span> <span style="color: #008080;"> 153</span>                     y = evt.clientY,   <span style="color: #008000;">//</span><span style="color: #008000;">获取鼠标在可视窗口的y值</span> <span style="color: #008080;"> 154</span>                      <span style="color: #008080;"> 155</span>                      winWidth = window.innerWidth,    <span style="color: #008000;">//</span><span style="color: #008000;">获取可视窗口的高度和宽度 有兼容性问题 不包括滚动条</span> <span style="color: #008080;"> 156</span>                     winHeight =<span style="color: #000000;"> window.innerHeight, </span><span style="color: #008080;"> 157</span>                      <span style="color: #008080;"> 158</span> <span style="color: #000000;">                     vx, </span><span style="color: #008080;"> 159</span> <span style="color: #000000;">                    vy </span><span style="color: #008080;"> 160</span> <span style="color: #000000;">                ; </span><span style="color: #008080;"> 161</span>  <span style="color: #008080;"> 162</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Delect scrollEl 观察滚动节点  如果滚动的父节点scrollParentEl不等于当前的根节点的时候则 可以滚动</span> <span style="color: #008080;"> 163</span>                 <span style="color: #0000ff;">if</span> (scrollParentEl !==<span style="color: #000000;"> rootEl) { </span><span style="color: #008080;"> 164</span>                     scrollEl = options.scroll;  <span style="color: #008000;">//</span><span style="color: #008000;">true  布尔值</span> <span style="color: #008080;"> 165</span>                     scrollParentEl = rootEl;  <span style="color: #008000;">//</span><span style="color: #008000;">鼠标开始按下的根节点</span> <span style="color: #008080;"> 166</span>  <span style="color: #008080;"> 167</span>                     <span style="color: #0000ff;">if</span> (scrollEl === <span style="color: #0000ff;">true</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 168</span>                         scrollEl =<span style="color: #000000;"> rootEl; </span><span style="color: #008080;"> 169</span>                          <span style="color: #0000ff;">do</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 170</span>                             <span style="color: #008000;">//</span><span style="color: #008000;">判断父节点，哪个父节点出现滚动条，如果有滚动条则设置改拖拽的节点滚动条父节点</span> <span style="color: #008080;"> 171</span>                             <span style="color: #0000ff;">if</span> ((scrollEl.offsetWidth &lt; scrollEl.scrollWidth) || <span style="color: #008080;"> 172</span>                                 (scrollEl.offsetHeight &lt;<span style="color: #000000;"> scrollEl.scrollHeight) </span><span style="color: #008080;"> 173</span> <span style="color: #000000;">                            ) { </span><span style="color: #008080;"> 174</span>                                 <span style="color: #0000ff;">break</span><span style="color: #000000;">; </span><span style="color: #008080;"> 175</span> <span style="color: #000000;">                            } </span><span style="color: #008080;"> 176</span>                             <span style="color: #008000;">/*</span><span style="color: #008000;"> jshint boss:true </span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 177</span>                         } <span style="color: #0000ff;">while</span> (scrollEl =<span style="color: #000000;"> scrollEl.parentNode); </span><span style="color: #008080;"> 178</span> <span style="color: #000000;">                    } </span><span style="color: #008080;"> 179</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 180</span>         <span style="color: #008080;"> 181</span>  <span style="color: #008080;"> 182</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (scrollEl) { </span><span style="color: #008080;"> 183</span>                     el =<span style="color: #000000;"> scrollEl; </span><span style="color: #008080;"> 184</span>                     rect =<span style="color: #000000;"> scrollEl.getBoundingClientRect(); </span><span style="color: #008080;"> 185</span>                     <span style="color: #008000;">/*</span>  <span style="color: #008080;"> 186</span> <span style="color: #008000;">                    var box=document.getElementById('box');         // 获取元素 </span><span style="color: #008080;"> 187</span> <span style="color: #008000;">                     alert(box.getBoundingClientRect().top);         // 元素上边距离页面上边的距离 </span><span style="color: #008080;"> 188</span> <span style="color: #008000;">                     alert(box.getBoundingClientRect().right);       // 元素右边距离页面左边的距离 </span><span style="color: #008080;"> 189</span> <span style="color: #008000;">                     alert(box.getBoundingClientRect().bottom);      // 元素下边距离页面上边的距离 </span><span style="color: #008080;"> 190</span> <span style="color: #008000;">                     alert(box.getBoundingClientRect().left);        // 元素左边距离页面左边的距离 </span><span style="color: #008080;"> 191</span> <span style="color: #008000;">                     y：y = evt.clientY,   //获取鼠标在可视窗口的y值 </span><span style="color: #008080;"> 192</span> <span style="color: #008000;">                     sens：    sens = options.scrollSensitivity,  //滚动灵敏度 默认是30 </span><span style="color: #008080;"> 193</span>                       <span style="color: #008080;"> 194</span>                      <span style="color: #008000;">*/</span> <span style="color: #008080;"> 195</span>                   <span style="color: #008080;"> 196</span>                      <span style="color: #008000;">//</span><span style="color: #008000;">vx 与 vy 只是个布尔值判断 然后就得出一个值</span> <span style="color: #008080;"> 197</span>                       <span style="color: #008000;">/*</span> <span style="color: #008080;"> 198</span> <span style="color: #008000;">                        true-true=0 </span><span style="color: #008080;"> 199</span> <span style="color: #008000;">                        true-false=1 </span><span style="color: #008080;"> 200</span> <span style="color: #008000;">                        false-false=0 </span><span style="color: #008080;"> 201</span> <span style="color: #008000;">                        false-true=-1 </span><span style="color: #008080;"> 202</span>                     <span style="color: #008000;">*/</span> <span style="color: #008080;"> 203</span>                      vx = (abs(rect.right - x) &lt;= sens) - (abs(rect.left - x) &lt;=<span style="color: #000000;"> sens); </span><span style="color: #008080;"> 204</span>                     vy = (abs(rect.bottom - y) &lt;= sens) - (abs(rect.top - y) &lt;= sens);  <span style="color: #008000;">//</span><span style="color: #008000;">这样判断并不是很好因为只会在边界判断事件发生，如果一开始拖拽快速超过了设置的+-sens值滚动事件将没有发生。个人感觉改成一下判断会比较好。</span> <span style="color: #008080;"> 205</span>                     <span style="color: #008000;">/*</span> <span style="color: #008080;"> 206</span> <span style="color: #008000;">                    if(rect.top+sens-y&gt;=0){ </span><span style="color: #008080;"> 207</span> <span style="color: #008000;">                          vy=-1; </span><span style="color: #008080;"> 208</span> <span style="color: #008000;">                        } else if(rect.bottom+sens-y&lt;=0){ </span><span style="color: #008080;"> 209</span> <span style="color: #008000;">                          vy=1; </span><span style="color: #008080;"> 210</span> <span style="color: #008000;">                        }else{ </span><span style="color: #008080;"> 211</span> <span style="color: #008000;">                            vy=0; </span><span style="color: #008080;"> 212</span> <span style="color: #008000;">                            } </span><span style="color: #008080;"> 213</span>                     <span style="color: #008000;">*/</span> <span style="color: #008080;"> 214</span> <span style="color: #000000;">                 } </span><span style="color: #008080;"> 215</span>  <span style="color: #008080;"> 216</span>              <span style="color: #008080;"> 217</span>                 <span style="color: #0000ff;">if</span> (!(vx || vy)) {  <span style="color: #008000;">//</span><span style="color: #008000;">当他等于0的时候 拖拽滚动的是window</span> <span style="color: #008080;"> 218</span>                      <span style="color: #008080;"> 219</span>                     vx = (winWidth - x &lt;= sens) - (x &lt;=<span style="color: #000000;"> sens); </span><span style="color: #008080;"> 220</span>                     vy = (winHeight - y &lt;= sens) - (y &lt;=<span style="color: #000000;"> sens); </span><span style="color: #008080;"> 221</span>  <span style="color: #008080;"> 222</span>                     <span style="color: #008000;">/*</span><span style="color: #008000;"> jshint expr:true </span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 223</span>                     (vx || vy) &amp;&amp; (el =<span style="color: #000000;"> win); </span><span style="color: #008080;"> 224</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 225</span>  <span style="color: #008080;"> 226</span>  <span style="color: #008080;"> 227</span>                 <span style="color: #0000ff;">if</span> (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !==<span style="color: #000000;"> el) { </span><span style="color: #008080;"> 228</span>                     autoScroll.el =<span style="color: #000000;"> el; </span><span style="color: #008080;"> 229</span>                     autoScroll.vx =<span style="color: #000000;"> vx; </span><span style="color: #008080;"> 230</span>                     autoScroll.vy =<span style="color: #000000;"> vy; </span><span style="color: #008080;"> 231</span>                <span style="color: #008000;">//</span><span style="color: #008000;">speed=10 滚动速度</span> <span style="color: #008080;"> 232</span> <span style="color: #000000;">                    clearInterval(autoScroll.pid); </span><span style="color: #008080;"> 233</span>                 <span style="color: #008080;"> 234</span>                     <span style="color: #0000ff;">if</span><span style="color: #000000;"> (el) { </span><span style="color: #008080;"> 235</span>                         autoScroll.pid =<span style="color: #000000;"> setInterval(function () { </span><span style="color: #008080;"> 236</span>                             <span style="color: #0000ff;">if</span> (el ===<span style="color: #000000;"> win) { </span><span style="color: #008080;"> 237</span>                               win.scrollTo(win.pageXOffset + vx * speed, win.pageYOffset + vy *<span style="color: #000000;"> speed); </span><span style="color: #008080;"> 238</span>                             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 239</span>                                 vy &amp;&amp; (el.scrollTop += vy * speed);  <span style="color: #008000;">//</span><span style="color: #008000;">设置元素滚动条的位置,每次滚动1*speed如果是0 则不会滚动</span> <span style="color: #008080;"> 240</span>                                 vx &amp;&amp; (el.scrollLeft += vx * speed);<span style="color: #008000;">//</span><span style="color: #008000;">设置元素滚动条的位置</span> <span style="color: #008080;"> 241</span> <span style="color: #000000;">                            } </span><span style="color: #008080;"> 242</span> <span style="color: #000000;">                        },  </span><span style="color: #008080;"> 243</span>                          <span style="color: #800080;">24</span><span style="color: #000000;">); </span><span style="color: #008080;"> 244</span> <span style="color: #000000;">                    } </span><span style="color: #008080;"> 245</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 246</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 247</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">时间 毫秒</span> <span style="color: #008080;"> 248</span>         }, <span style="color: #800080;">30</span><span style="color: #000000;">), </span><span style="color: #008080;"> 249</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 250</span> <span style="color: #008000;">     *函数名 ：_prepareGroup </span><span style="color: #008080;"> 251</span> <span style="color: #008000;">     *函数功能描述 ：  //options.group 属性变成对象 。如果group不是对象则变成对象，并且group对象的name就等于改group的值 并且添加多['pull', 'put'] 属性默认值是true </span><span style="color: #008080;"> 252</span> <span style="color: #008000;">     如果设置group{ </span><span style="color: #008080;"> 253</span> <span style="color: #008000;">            pull:true,  则可以拖拽到其他列表 否则反之 </span><span style="color: #008080;"> 254</span> <span style="color: #008000;">            put:true,  则可以从其他列表中放数据到改列表，false则反之 </span><span style="color: #008080;"> 255</span> <span style="color: #008000;">         } </span><span style="color: #008080;"> 256</span> <span style="color: #008000;">           pull: 'clone', 还有一个作用是克隆，就是当这个列表拖拽到其他列表的时候不会删除改列表的节点。 </span><span style="color: #008080;"> 257</span> <span style="color: #008000;">     *函数参数 ：  </span><span style="color: #008080;"> 258</span> <span style="color: #008000;">                      options： </span><span style="color: #008080;"> 259</span> <span style="color: #008000;">                             类型：boj, options 拖拽参数 </span><span style="color: #008080;"> 260</span>                               <span style="color: #008080;"> 261</span> <span style="color: #008000;">     *函数返回值 ： viod </span><span style="color: #008080;"> 262</span> <span style="color: #008000;">     *作者 ：  </span><span style="color: #008080;"> 263</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;"> 264</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;"> 265</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;"> 266</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;"> 267</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;"> 268</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;"> 269</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 270</span>  <span style="color: #008080;"> 271</span>  <span style="color: #008080;"> 272</span>  <span style="color: #008080;"> 273</span>         _prepareGroup =<span style="color: #000000;"> function (options) { </span><span style="color: #008080;"> 274</span>              <span style="color: #008080;"> 275</span>             <span style="color: #0000ff;">var</span> group = options.group;   <span style="color: #008000;">//</span><span style="color: #008000;">把options.group 付值给group </span><span style="color: #008080;"> 276</span>       <span style="color: #008000;">//</span><span style="color: #008000;"> 先判断他group 是否是对象，如果不是则变成对象，name是他的属性</span> <span style="color: #008080;"> 277</span>             <span style="color: #0000ff;">if</span> (!group || <span style="color: #0000ff;">typeof</span> group != <span style="color: #800000;">'</span><span style="color: #800000;">object</span><span style="color: #800000;">'</span>) {  <span style="color: #008000;">//</span><span style="color: #008000;">如果当前options.group; 不存在或者不是obj则把他变成一个对象</span> <span style="color: #008080;"> 278</span>                 group = options.group =<span style="color: #000000;"> {name: group}; </span><span style="color: #008080;"> 279</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 280</span>      <span style="color: #008000;">//</span><span style="color: #008000;">判断有没有设置 'pull', 'put' 如果没有 则添加 'pull', 'put' 属性并且设置为真</span> <span style="color: #008080;"> 281</span>             [<span style="color: #800000;">'</span><span style="color: #800000;">pull</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">put</span><span style="color: #800000;">'</span><span style="color: #000000;">].forEach(function (key) { </span><span style="color: #008080;"> 282</span>                 <span style="color: #0000ff;">if</span> (!(key <span style="color: #0000ff;">in</span> group)) { <span style="color: #008000;">// </span><span style="color: #008080;"> 283</span>                     group[key] = <span style="color: #0000ff;">true</span>;  <span style="color: #008000;">//</span><span style="color: #008000;">将为group对象添加两个属性'pull', 'put' 并且为true</span> <span style="color: #008080;"> 284</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 285</span> <span style="color: #000000;">            }); </span><span style="color: #008080;"> 286</span>             <span style="color: #008000;">//</span><span style="color: #008000;">options.group  变成对象之后join方法将匹配不到任何东西 </span><span style="color: #008080;"> 287</span>             <span style="color: #008000;">//</span><span style="color: #008000;">如果他直接是数组的话这里就是把数组的值拆分成字符串连接起来 </span><span style="color: #008080;"> 288</span>        <span style="color: #008000;">//</span><span style="color: #008000;">options.group 属性变成对象 。</span> <span style="color: #008080;"> 289</span>             options.groups = <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + group.name + (group.put.join ? <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + group.put.join(<span style="color: #800000;">'</span> <span style="color: #800000;">'</span>) : <span style="color: #800000;">''</span>) + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span><span style="color: #000000;">; </span><span style="color: #008080;"> 290</span> <span style="color: #000000;">        } </span><span style="color: #008080;"> 291</span> <span style="color: #000000;">    ; </span><span style="color: #008080;"> 292</span>  <span style="color: #008080;"> 293</span>  <span style="color: #008080;"> 294</span>  <span style="color: #008080;"> 295</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;"> 296</span> <span style="color: #008000;">     * @class  Sortable </span><span style="color: #008080;"> 297</span> <span style="color: #008000;">     * @param  {HTMLElement}  el </span><span style="color: #008080;"> 298</span> <span style="color: #008000;">     * @param  {Object}       [options] </span><span style="color: #008080;"> 299</span>      <span style="color: #008000;">*/</span> <span style="color: #008080;"> 300</span>      <span style="color: #008000;">//</span><span style="color: #008000;">el  html dom节点 </span><span style="color: #008080;"> 301</span>      <span style="color: #008000;">//</span><span style="color: #008000;">param obj 数据对象</span> <span style="color: #008080;"> 302</span>   <span style="color: #008080;"> 303</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 304</span> <span style="color: #008000;">         *函数名 ：Sortable </span><span style="color: #008080;"> 305</span> <span style="color: #008000;">         *函数功能描述 ： 主类，里面包含很多方法 </span><span style="color: #008080;"> 306</span> <span style="color: #008000;">         *函数参数 ： dom节点rootEl  </span><span style="color: #008080;"> 307</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;"> 308</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 309</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 310</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 311</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 312</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 313</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 314</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 315</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span>  <span style="color: #008080;"> 316</span> <span style="color: #000000;">     function Sortable(el, options) { </span><span style="color: #008080;"> 317</span>     <span style="color: #008000;">//</span><span style="color: #008000;">判断 param 如果不是HTMLDOM 则抛出错误</span> <span style="color: #008080;"> 318</span>         <span style="color: #0000ff;">if</span> (!(el &amp;&amp; el.nodeType &amp;&amp; el.nodeType === <span style="color: #800080;">1</span><span style="color: #000000;">)) { </span><span style="color: #008080;"> 319</span>             <span style="color: #0000ff;">throw</span> <span style="color: #800000;">'</span><span style="color: #800000;">Sortable: `el` must be HTMLElement, and not </span><span style="color: #800000;">'</span> +<span style="color: #000000;"> {}.toString.call(el); </span><span style="color: #008080;"> 320</span> <span style="color: #000000;">        } </span><span style="color: #008080;"> 321</span>       <span style="color: #008000;">//</span><span style="color: #008000;">把dom节点存到this中  好操作  就是id 父层节点</span> <span style="color: #008080;"> 322</span>         <span style="color: #0000ff;">this</span>.el = el; <span style="color: #008000;">//</span><span style="color: #008000;"> root element</span> <span style="color: #008080;"> 323</span>         <span style="color: #0000ff;">this</span>.options = options = _extend({}, options);    <span style="color: #008000;">//</span><span style="color: #008000;">把options初始化的数据存到this中  好操作 </span><span style="color: #008080;"> 324</span>  <span style="color: #008080;"> 325</span>  <span style="color: #008080;"> 326</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Export instance </span><span style="color: #008080;"> 327</span>         <span style="color: #008000;">//</span><span style="color: #008000;">把 Sortable 类放在HTMLDOM节点的expando属性中</span> <span style="color: #008080;"> 328</span>         el[expando] = <span style="color: #0000ff;">this</span><span style="color: #000000;">; </span><span style="color: #008080;"> 329</span>  <span style="color: #008080;"> 330</span>  <span style="color: #008080;"> 331</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Default options </span><span style="color: #008080;"> 332</span>         <span style="color: #008000;">//</span><span style="color: #008000;">初始化  defaults 数据</span> <span style="color: #008080;"> 333</span>         <span style="color: #0000ff;">var</span> defaults =<span style="color: #000000;"> { </span><span style="color: #008080;"> 334</span>             group: Math.random(),  <span style="color: #008000;">//</span><span style="color: #008000;">产生一个随机数 </span><span style="color: #008000;">//</span><span style="color: #008000;">产生一个随机数 </span><span style="color: #008000;">//</span><span style="color: #008000;">改参数是对象有三个两个参数   pull: 拉,     put:放   默认都是是true   pull还有一个值是: 'clone',   pull: 拉,     put:放 设置为false 就不能拖拽了， 如果 pull 这种为'clone'则可以重一个列表中拖拽到另一个列表并且克隆dom节点， name：是两个或者多个列表拖拽之间的通信，如果name相同则他们可以互相拖拽</span> <span style="color: #008080;"> 335</span>              <span style="color: #008080;"> 336</span>             sort: <span style="color: #0000ff;">true</span>,  <span style="color: #008000;">//</span><span style="color: #008000;"> 类型：Boolean,分类  false时候在自己的拖拽区域不能拖拽，但是可以拖拽到其他区域，true则可以做自己区域拖拽或者其他授权地方拖拽</span> <span style="color: #008080;"> 337</span>             disabled: <span style="color: #0000ff;">false</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">类型：Boolean 是否禁用拖拽 true 则不能拖拽 默认是true</span> <span style="color: #008080;"> 338</span>             store: <span style="color: #0000ff;">null</span>,  <span style="color: #008000;">//</span><span style="color: #008000;"> 用来html5 存储的 改返回 拖拽的节点的唯一id</span> <span style="color: #008080;"> 339</span>             handle: <span style="color: #0000ff;">null</span>, <span style="color: #008000;">//</span><span style="color: #008000;">handle 这个参数是设置该标签，或者该class可以拖拽  但是不要设置 id的节点和子节点相同的tag不然会有bug</span> <span style="color: #008080;"> 340</span>             scroll: <span style="color: #0000ff;">true</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">类型：Boolean，设置拖拽的时候滚动条是否智能滚动。默认为真，则智能滚动，false则不智能滚动</span> <span style="color: #008080;"> 341</span>             scrollSensitivity: <span style="color: #800080;">30</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">滚动的灵敏度,其实是拖拽离滚动边界的距离触发事件的距离边界+-30px的地方触发拖拽滚动事件，</span> <span style="color: #008080;"> 342</span>             scrollSpeed: <span style="color: #800080;">10</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">滚动速度</span> <span style="color: #008080;"> 343</span>             draggable: /[uo]l/i.test(el.nodeName) ? <span style="color: #800000;">'</span><span style="color: #800000;">li</span><span style="color: #800000;">'</span> : <span style="color: #800000;">'</span><span style="color: #800000;">&gt;*</span><span style="color: #800000;">'</span>,<span style="color: #008000;">//</span><span style="color: #008000;">draggable 判断拖拽节点的父层是否是ou ul</span> <span style="color: #008080;"> 344</span>             ghostClass: <span style="color: #800000;">'</span><span style="color: #800000;">sortable-ghost</span><span style="color: #800000;">'</span>,  <span style="color: #008000;">//</span><span style="color: #008000;"> 排序镜像class,就是当鼠标拉起拖拽节点的时候添加该class</span> <span style="color: #008080;"> 345</span>             chosenClass: <span style="color: #800000;">'</span><span style="color: #800000;">sortable-chosen</span><span style="color: #800000;">'</span>, <span style="color: #008000;">//</span> <span style="color: #008000;">//</span><span style="color: #008000;">为拖拽的节点添加一个class 开始拖拽鼠标按下去的时候 添加该class</span> <span style="color: #008080;"> 346</span>             ignore: <span style="color: #800000;">'</span><span style="color: #800000;">a, img</span><span style="color: #800000;">'</span>,   <span style="color: #008000;">//</span><span style="color: #008000;">a 或者是img</span> <span style="color: #008080;"> 347</span>             filter: <span style="color: #0000ff;">null</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">改参数可以传递一个函数，或者字符串，字符串可以是class或者tag，然后用于触发oFilter函数，这样可以用来自定义事件等</span> <span style="color: #008080;"> 348</span>             animation: <span style="color: #800080;">0</span>, <span style="color: #008000;">//</span><span style="color: #008000;">拖拽动画时间戳</span> <span style="color: #008080;"> 349</span>             setData: function (dataTransfer, dragEl) { <span style="color: #008000;">//</span><span style="color: #008000;">设置拖拽传递的参数</span> <span style="color: #008080;"> 350</span>                 dataTransfer.setData(<span style="color: #800000;">'</span><span style="color: #800000;">Text</span><span style="color: #800000;">'</span><span style="color: #000000;">, dragEl.textContent); </span><span style="color: #008080;"> 351</span> <span style="color: #000000;">            }, </span><span style="color: #008080;"> 352</span>             dropBubble: <span style="color: #0000ff;">false</span>,  <span style="color: #008000;">//</span><span style="color: #008000;"> 发生 drop事件 拖拽的时候是否阻止事件冒泡 </span> <span style="color: #008080;"> 353</span>             dragoverBubble: <span style="color: #0000ff;">false</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">发生 dragover 事件 拖拽的时候是否阻止事件冒泡 </span> <span style="color: #008080;"> 354</span>             dataIdAttr: <span style="color: #800000;">'</span><span style="color: #800000;">data-id</span><span style="color: #800000;">'</span>, <span style="color: #008000;">//</span><span style="color: #008000;">拖拽元素的id 数组</span> <span style="color: #008080;"> 355</span>             delay: <span style="color: #800080;">0</span>,  <span style="color: #008000;">//</span><span style="color: #008000;">延迟拖拽时间, 其实就是鼠标按下去拖拽延迟</span> <span style="color: #008080;"> 356</span>             forceFallback: <span style="color: #0000ff;">false</span>,  <span style="color: #008000;">//</span><span style="color: #008000;"> 不详</span> <span style="color: #008080;"> 357</span>             fallbackClass: <span style="color: #800000;">'</span><span style="color: #800000;">sortable-fallback</span><span style="color: #800000;">'</span>,   <span style="color: #008000;">//</span><span style="color: #008000;"> 排序回退class</span> <span style="color: #008080;"> 358</span>             fallbackOnBody: <span style="color: #0000ff;">false</span>,<span style="color: #008000;">//</span><span style="color: #008000;"> 是否把拖拽镜像节点ghostEl放到body上</span> <span style="color: #008080;"> 359</span> <span style="color: #000000;">        }; </span><span style="color: #008080;"> 360</span>  <span style="color: #008080;"> 361</span>  <span style="color: #008080;"> 362</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Set default options </span><span style="color: #008080;"> 363</span>         <span style="color: #008000;">//</span><span style="color: #008000;">当options类中的数据没有defaults类中的数据的时候 就把defaults类中的数据赋值给options类</span> <span style="color: #008080;"> 364</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> defaults) { </span><span style="color: #008080;"> 365</span>             !(name <span style="color: #0000ff;">in</span> options) &amp;&amp; (options[name] =<span style="color: #000000;"> defaults[name]); </span><span style="color: #008080;"> 366</span> <span style="color: #000000;">        } </span><span style="color: #008080;"> 367</span>        <span style="color: #008000;">//</span><span style="color: #008000;">把group: 变成一个对象，本来是一个属性的</span> <span style="color: #008080;"> 368</span> <span style="color: #000000;">        _prepareGroup(options); </span><span style="color: #008080;"> 369</span>           <span style="color: #008080;"> 370</span>          <span style="color: #008080;"> 371</span>  <span style="color: #008080;"> 372</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Bind all private methods</span> <span style="color: #008080;"> 373</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> fn <span style="color: #0000ff;">in</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 374</span>             <span style="color: #0000ff;">if</span> (fn.charAt(<span style="color: #800080;">0</span>) === <span style="color: #800000;">'</span><span style="color: #800000;">_</span><span style="color: #800000;">'</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 375</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">如果这个 Sortable 类下的函数 开始字符串还有_下划线的就把他的this指向Sortable类</span> <span style="color: #008080;"> 376</span>                 <span style="color: #0000ff;">this</span>[fn] = <span style="color: #0000ff;">this</span>[fn].bind(<span style="color: #0000ff;">this</span><span style="color: #000000;">); </span><span style="color: #008080;"> 377</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 378</span> <span style="color: #000000;">        } </span><span style="color: #008080;"> 379</span>  <span style="color: #008080;"> 380</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Setup drag mode </span><span style="color: #008080;"> 381</span>         <span style="color: #008000;">//</span><span style="color: #008000;">forceFallback 如果是false 那么给supportDraggable 函数他，然后判断浏览器是否支持draggable 拖拽如果支持是true 否则是false</span> <span style="color: #008080;"> 382</span>         <span style="color: #0000ff;">this</span>.nativeDraggable = options.forceFallback ? <span style="color: #0000ff;">false</span><span style="color: #000000;"> : supportDraggable; </span><span style="color: #008080;"> 383</span>    <span style="color: #008080;"> 384</span>        <span style="color: #008080;"> 385</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Bind events </span><span style="color: #008080;"> 386</span>         <span style="color: #008000;">//</span><span style="color: #008000;">添加事件  </span><span style="color: #008000;">//</span><span style="color: #008000;"> 入口从这里开始</span> <span style="color: #008080;"> 387</span>           <span style="color: #008080;"> 388</span>         _on(el, <span style="color: #800000;">'</span><span style="color: #800000;">mousedown</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onTapStart); </span><span style="color: #008080;"> 389</span>         _on(el, <span style="color: #800000;">'</span><span style="color: #800000;">touchstart</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onTapStart); </span><span style="color: #008080;"> 390</span>       <span style="color: #008080;"> 391</span>       <span style="color: #008080;"> 392</span>        <span style="color: #008000;">//</span><span style="color: #008000;">html5     dragover 添加拖拽事件</span> <span style="color: #008080;"> 393</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span><span style="color: #000000;">.nativeDraggable) { </span><span style="color: #008080;"> 394</span>             <span style="color: #008000;">//</span><span style="color: #008000;">传递整个类进去</span> <span style="color: #008080;"> 395</span>             _on(el, <span style="color: #800000;">'</span><span style="color: #800000;">dragover</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">然后会执行这个函数handleEvent</span> <span style="color: #008080;"> 396</span>             _on(el, <span style="color: #800000;">'</span><span style="color: #800000;">dragenter</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>); <span style="color: #008000;">//</span><span style="color: #008000;">然后会执行这个函数handleEvent</span> <span style="color: #008080;"> 397</span> <span style="color: #000000;">        } </span><span style="color: #008080;"> 398</span>        <span style="color: #008080;"> 399</span>       <span style="color: #008000;">//</span><span style="color: #008000;">touchDragOverListeners 添加一个false 数据到数组里。</span> <span style="color: #008080;"> 400</span>         touchDragOverListeners.push(<span style="color: #0000ff;">this</span><span style="color: #000000;">._onDragOver); </span><span style="color: #008080;"> 401</span>  <span style="color: #008080;"> 402</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Restore sorting </span><span style="color: #008080;"> 403</span>         <span style="color: #008000;">//</span><span style="color: #008000;">sort 排序函数 </span><span style="color: #008080;"> 404</span>         <span style="color: #008000;">//</span><span style="color: #008000;">store 是null 未找到get函数不知道怎么回事  可能它是属于store.js的api</span> <span style="color: #008080;"> 405</span>         options.store &amp;&amp; <span style="color: #0000ff;">this</span>.sort(options.store.<span style="color: #0000ff;">get</span>(<span style="color: #0000ff;">this</span><span style="color: #000000;">)); </span><span style="color: #008080;"> 406</span> <span style="color: #000000;">    } </span><span style="color: #008080;"> 407</span> <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 408</span> <span style="color: #008000;">         *函数名 ：Sortable.prototype  </span><span style="color: #008080;"> 409</span> <span style="color: #008000;">         *函数功能描述 ： 主类，的原型 </span><span style="color: #008080;"> 410</span> <span style="color: #008000;">         *函数参数 ：   </span><span style="color: #008080;"> 411</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;"> 412</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 413</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 414</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 415</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 416</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 417</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 418</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 419</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span>  <span style="color: #008080;"> 420</span>  <span style="color: #008080;"> 421</span>     Sortable.prototype = <span style="color: #008000;">/*</span><span style="color: #008000;">* @lends Sortable.prototype </span><span style="color: #008000;">*/</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 422</span>         constructor: Sortable,  <span style="color: #008000;">//</span><span style="color: #008000;">防止继承混乱，构造方法指向他的构造函数</span> <span style="color: #008080;"> 423</span> <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 424</span> <span style="color: #008000;">         *函数名 ：_onTapStart </span><span style="color: #008080;"> 425</span> <span style="color: #008000;">         *函数功能描述 ： 鼠标按下去函数,oldIndex统计目标节点与同级同胞的上节点总和 </span><span style="color: #008080;"> 426</span> <span style="color: #008000;">         *函数参数 ：   viod </span><span style="color: #008080;"> 427</span> <span style="color: #008000;">         *函数返回值 ： 无 </span><span style="color: #008080;"> 428</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 429</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 430</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 431</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 432</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 433</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 434</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 435</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span>  <span style="color: #008080;"> 436</span>  <span style="color: #008080;"> 437</span>         _onTapStart: function (<span style="color: #008000;">/*</span><span style="color: #008000;">* Event|TouchEvent </span><span style="color: #008000;">*/</span><span style="color: #000000;">evt) { </span><span style="color: #008080;"> 438</span>               <span style="color: #008080;"> 439</span>             <span style="color: #0000ff;">var</span> _this = <span style="color: #0000ff;">this</span><span style="color: #000000;">, </span><span style="color: #008080;"> 440</span>                 el = <span style="color: #0000ff;">this</span>.el,   <span style="color: #008000;">//</span><span style="color: #008000;">id dom节点</span> <span style="color: #008080;"> 441</span>                 options = <span style="color: #0000ff;">this</span>.options,   <span style="color: #008000;">//</span><span style="color: #008000;">参数类</span> <span style="color: #008080;"> 442</span>                 type = evt.type,   <span style="color: #008000;">//</span><span style="color: #008000;">事件类型</span> <span style="color: #008080;"> 443</span>                 touch = evt.touches &amp;&amp; evt.touches[<span style="color: #800080;">0</span>],  <span style="color: #008000;">//</span><span style="color: #008000;">触摸屏事件</span> <span style="color: #008080;"> 444</span>                 target = (touch || evt).target,   <span style="color: #008000;">//</span><span style="color: #008000;">目标节点</span> <span style="color: #008080;"> 445</span>                 originalTarget =<span style="color: #000000;"> target,    </span><span style="color: #008080;"> 446</span>                 filter = options.filter;    <span style="color: #008000;">//</span><span style="color: #008000;">  null </span><span style="color: #008080;"> 447</span>  <span style="color: #008080;"> 448</span>             <span style="color: #008000;">//</span><span style="color: #008000;">如果是鼠标按下去事件，但是如果不是左键按下去的话，或者disabled 为假的时候 结束该程序 disabled 为fasle</span> <span style="color: #008080;"> 449</span>             <span style="color: #0000ff;">if</span> (type === <span style="color: #800000;">'</span><span style="color: #800000;">mousedown</span><span style="color: #800000;">'</span> &amp;&amp; evt.button !== <span style="color: #800080;">0</span> ||<span style="color: #000000;"> options.disabled) { </span><span style="color: #008080;"> 450</span>                 <span style="color: #0000ff;">return</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> only left button or enabled</span> <span style="color: #008080;"> 451</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 452</span>       <span style="color: #008000;">//</span><span style="color: #008000;">draggable=/[uo]l/i.test(el.nodeName) ? 'li' : '&gt;*', </span><span style="color: #008080;"> 453</span>      <span style="color: #008000;">//</span><span style="color: #008000;"> target=el </span><span style="color: #008080;"> 454</span>     <span style="color: #008000;">//</span><span style="color: #008000;">     target = _closest(target, options.draggable, el);   </span><span style="color: #008000;">//</span><span style="color: #008000;">true </span><span style="color: #008080;"> 455</span>           <span style="color: #008000;">//</span>   <span style="color: #008080;"> 456</span>             <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">target) { </span><span style="color: #008080;"> 457</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;">; </span><span style="color: #008080;"> 458</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 459</span>  <span style="color: #008080;"> 460</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> get the index of the dragged element within its parent </span><span style="color: #008080;"> 461</span>             <span style="color: #008000;">//</span><span style="color: #008000;">获取索引</span> <span style="color: #008080;"> 462</span>             oldIndex =<span style="color: #000000;"> _index(target, options.draggable); </span><span style="color: #008080;"> 463</span>           <span style="color: #008080;"> 464</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Check filter+ </span><span style="color: #008080;"> 465</span>             <span style="color: #008000;">//</span><span style="color: #008000;">filter 如果是函数 但是默认值filter  </span> <span style="color: #008080;"> 466</span>             <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> filter === <span style="color: #800000;">'</span><span style="color: #800000;">function</span><span style="color: #800000;">'</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 467</span>                 <span style="color: #0000ff;">if</span> (filter.call(<span style="color: #0000ff;">this</span>, evt, target, <span style="color: #0000ff;">this</span>)) { <span style="color: #008000;">//</span><span style="color: #008000;">并且有返回值是true 的话 </span><span style="color: #008080;"> 468</span>           <span style="color: #008080;"> 469</span>                       <span style="color: #008000;">//</span><span style="color: #008000;">触发该函数</span> <span style="color: #008080;"> 470</span>                     _dispatchEvent(_this, originalTarget, <span style="color: #800000;">'</span><span style="color: #800000;">filter</span><span style="color: #800000;">'</span>, target, el, oldIndex); <span style="color: #008000;">//</span><span style="color: #008000;">则触发oFilter事件</span> <span style="color: #008080;"> 471</span>                     evt.preventDefault(); <span style="color: #008000;">//</span><span style="color: #008000;">停止默认事件</span> <span style="color: #008080;"> 472</span>                     <span style="color: #0000ff;">return</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> cancel dnd</span> <span style="color: #008080;"> 473</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 474</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 475</span>             <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;"> (filter) { </span><span style="color: #008080;"> 476</span>                 <span style="color: #808080;">///</span><span style="color: #008000;">/ JavaScript数组some()方法测试数组中的某个元素是否通过由提供的功能来实现测试 ,只要有一个真则返回真</span> <span style="color: #008080;"> 477</span>                 <span style="color: #008000;">/*</span> <span style="color: #008080;"> 478</span> <span style="color: #008000;">                     例子 </span><span style="color: #008080;"> 479</span> <span style="color: #008000;"> if (!Array.prototype.some) </span><span style="color: #008080;"> 480</span> <span style="color: #008000;">{ </span><span style="color: #008080;"> 481</span> <span style="color: #008000;"> Array.prototype.some = function(fun ) </span><span style="color: #008080;"> 482</span> <span style="color: #008000;"> { </span><span style="color: #008080;"> 483</span> <span style="color: #008000;">  var len = this.length; </span><span style="color: #008080;"> 484</span> <span style="color: #008000;">  if (typeof fun != "function") </span><span style="color: #008080;"> 485</span> <span style="color: #008000;">   throw new TypeError(); </span><span style="color: #008080;"> 486</span>   <span style="color: #008080;"> 487</span> <span style="color: #008000;">  var thisp = arguments[1]; </span><span style="color: #008080;"> 488</span> <span style="color: #008000;">  for (var i = 0; i &lt; len; i++) </span><span style="color: #008080;"> 489</span> <span style="color: #008000;">  { </span><span style="color: #008080;"> 490</span> <span style="color: #008000;">   if (i in this &amp;&amp; </span><span style="color: #008080;"> 491</span> <span style="color: #008000;">     fun.call(thisp, this[i], i, this)) </span><span style="color: #008080;"> 492</span> <span style="color: #008000;">    return true; </span><span style="color: #008080;"> 493</span> <span style="color: #008000;">  } </span><span style="color: #008080;"> 494</span>   <span style="color: #008080;"> 495</span> <span style="color: #008000;">  return false; </span><span style="color: #008080;"> 496</span> <span style="color: #008000;"> }; </span><span style="color: #008080;"> 497</span> <span style="color: #008000;">} </span><span style="color: #008080;"> 498</span>   <span style="color: #008080;"> 499</span> <span style="color: #008000;">function isBigEnough(element, index, array) { </span><span style="color: #008080;"> 500</span> <span style="color: #008000;"> return (element &gt;= 10); </span><span style="color: #008080;"> 501</span> <span style="color: #008000;">} </span><span style="color: #008080;"> 502</span>   <span style="color: #008080;"> 503</span> <span style="color: #008000;">var retval = [2, 5, 8, 1, 4].some(isBigEnough); </span><span style="color: #008080;"> 504</span> <span style="color: #008000;">document.write("Returned value is : " + retval ); </span><span style="color: #008080;"> 505</span>   <span style="color: #008080;"> 506</span> <span style="color: #008000;">var retval = [12, 5, 8, 1, 4].some(isBigEnough); </span><span style="color: #008080;"> 507</span> <span style="color: #008000;">document.write("&lt;br /&gt;Returned value is : " + retval ); </span><span style="color: #008080;"> 508</span>                       <span style="color: #008080;"> 509</span>                 <span style="color: #008000;">*/</span> <span style="color: #008080;"> 510</span>              <span style="color: #008080;"> 511</span>                 filter = filter.split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span>).some(function (criteria) { <span style="color: #008000;">//</span><span style="color: #008000;">如果filter是字符串，则会用split 拆分成数组并且遍历他只有一个class 对的上则_closest 匹配tag和class  如果设置的filter中有calss 和拖拽元素上面的clss相同，或者tag相同，则会触发oFilter函数             </span> <span style="color: #008080;"> 512</span>                     criteria = _closest(originalTarget, criteria.trim(), el);<span style="color: #008000;">//</span><span style="color: #008000;">_closest</span> <span style="color: #008080;"> 513</span>  <span style="color: #008080;"> 514</span>                     <span style="color: #0000ff;">if</span><span style="color: #000000;"> (criteria) { </span><span style="color: #008080;"> 515</span>                         _dispatchEvent(_this, criteria, <span style="color: #800000;">'</span><span style="color: #800000;">filter</span><span style="color: #800000;">'</span>, target, el, oldIndex);  <span style="color: #008000;">//</span><span style="color: #008000;">调用自定义事件</span> <span style="color: #008080;"> 516</span>                         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">; </span><span style="color: #008080;"> 517</span> <span style="color: #000000;">                    } </span><span style="color: #008080;"> 518</span> <span style="color: #000000;">                }); </span><span style="color: #008080;"> 519</span>  <span style="color: #008080;"> 520</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (filter) { </span><span style="color: #008080;"> 521</span> <span style="color: #000000;">                    evt.preventDefault(); </span><span style="color: #008080;"> 522</span>                     <span style="color: #0000ff;">return</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> cancel dnd</span> <span style="color: #008080;"> 523</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 524</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 525</span>  <span style="color: #008080;"> 526</span>         <span style="color: #008000;">//</span><span style="color: #008000;">handle 存在 </span><span style="color: #008080;"> 527</span>         <span style="color: #008000;">//</span><span style="color: #008000;">originalTarget  </span><span style="color: #008080;"> 528</span>         <span style="color: #008000;">//</span><span style="color: #008000;">handle 这个参数是设置该标签，或者该class可以拖拽  但是不要设置 id的节点和子节点相同的tag不然会有bug</span> <span style="color: #008080;"> 529</span>          <span style="color: #008080;"> 530</span>             <span style="color: #0000ff;">if</span> (options.handle &amp;&amp; !<span style="color: #000000;">_closest(originalTarget, options.handle, el)) { </span><span style="color: #008080;"> 531</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;">; </span><span style="color: #008080;"> 532</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 533</span>  <span style="color: #008080;"> 534</span>  <span style="color: #008080;"> 535</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Prepare `dragstart` </span><span style="color: #008080;"> 536</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> 到这里</span> <span style="color: #008080;"> 537</span>             <span style="color: #0000ff;">this</span><span style="color: #000000;">._prepareDragStart(evt, touch, target); </span><span style="color: #008080;"> 538</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 539</span>  <span style="color: #008080;"> 540</span>  <span style="color: #008080;"> 541</span>  <span style="color: #008080;"> 542</span>   <span style="color: #008080;"> 543</span> <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 544</span> <span style="color: #008000;">         *函数名 ：_onTapStart </span><span style="color: #008080;"> 545</span> <span style="color: #008000;">         *函数功能描述 ： 开始准备拖 </span><span style="color: #008080;"> 546</span> <span style="color: #008000;">         *函数参数 ：   evt： </span><span style="color: #008080;"> 547</span> <span style="color: #008000;">                                       类型:obj,事件对象 </span><span style="color: #008080;"> 548</span> <span style="color: #008000;">                                touch： </span><span style="color: #008080;"> 549</span> <span style="color: #008000;">                                          类型:obj,触摸事件对象，判断是否是触摸事件还是鼠标事件 </span><span style="color: #008080;"> 550</span> <span style="color: #008000;">                                target： 类型:dom-obj,目标节点 </span><span style="color: #008080;"> 551</span> <span style="color: #008000;">         *函数返回值 ： 无 </span><span style="color: #008080;"> 552</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 553</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 554</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 555</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 556</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 557</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 558</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 559</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span>  <span style="color: #008080;"> 560</span>         _prepareDragStart: function (<span style="color: #008000;">/*</span><span style="color: #008000;">* Event </span><span style="color: #008000;">*/</span>evt, <span style="color: #008000;">/*</span><span style="color: #008000;">* Touch </span><span style="color: #008000;">*/</span>touch, <span style="color: #008000;">/*</span><span style="color: #008000;">* HTMLElement </span><span style="color: #008000;">*/</span><span style="color: #000000;">target) { </span><span style="color: #008080;"> 561</span>             <span style="color: #008000;">//</span><span style="color: #008000;">evt pc 的事件对象 </span><span style="color: #008080;"> 562</span>             <span style="color: #008000;">//</span><span style="color: #008000;">touch 移动的的事件对象 </span><span style="color: #008080;"> 563</span>             <span style="color: #008000;">//</span><span style="color: #008000;">target 目标节点</span> <span style="color: #008080;"> 564</span>             <span style="color: #0000ff;">var</span> _this = <span style="color: #0000ff;">this</span><span style="color: #000000;">, </span><span style="color: #008080;"> 565</span>                 el = _this.el,  <span style="color: #008000;">//</span><span style="color: #008000;">id节点，就是父层节点</span> <span style="color: #008080;"> 566</span>                 options = _this.options, <span style="color: #008000;">//</span><span style="color: #008000;">参数类</span> <span style="color: #008080;"> 567</span>                 ownerDocument = el.ownerDocument,  <span style="color: #008000;">//</span><span style="color: #008000;">整个文档</span> <span style="color: #008080;"> 568</span>                 dragStartFn;    <span style="color: #008000;">//</span><span style="color: #008000;">声明开始拖拽函数 </span><span style="color: #008080;"> 569</span>             <span style="color: #008000;">//</span><span style="color: #008000;">target 目标节点存在    dragEl 当前拖拽的节点 并且目标节点的父节点是id的节点的时候</span> <span style="color: #008080;"> 570</span>             <span style="color: #0000ff;">if</span> (target &amp;&amp; !dragEl &amp;&amp; (target.parentNode ===<span style="color: #000000;"> el)) { </span><span style="color: #008080;"> 571</span>                 tapEvt = evt;   <span style="color: #008000;">//</span><span style="color: #008000;">事件对象</span> <span style="color: #008080;"> 572</span>                  rootEl = el;   <span style="color: #008000;">//</span><span style="color: #008000;">拖拽的根节点 就是传进来的id那个节点</span> <span style="color: #008080;"> 573</span>                   <span style="color: #008080;"> 574</span>                 dragEl = target;  <span style="color: #008000;">//</span><span style="color: #008000;">目标节点 当前的拖拽节点 鼠标按下去拖拽的节点</span> <span style="color: #008080;"> 575</span>                 parentEl = dragEl.parentNode;  <span style="color: #008000;">//</span><span style="color: #008000;">目标节点 当前的拖拽节点 的父节点 就是 dragEl.parentNode ==rootEl</span> <span style="color: #008080;"> 576</span>                 nextEl = dragEl.nextSibling;  <span style="color: #008000;">//</span><span style="color: #008000;">目标节点  的下一个节点</span> <span style="color: #008080;"> 577</span>                 activeGroup = options.group;    <span style="color: #008000;">//</span><span style="color: #008000;">Object {name: "words", pull: true, put: true} </span><span style="color: #008080;"> 578</span>           <span style="color: #008080;"> 579</span>               <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽函数</span> <span style="color: #008080;"> 580</span>                  dragStartFn =<span style="color: #000000;"> function () { </span><span style="color: #008080;"> 581</span>                      <span style="color: #008000;">//</span><span style="color: #008000;"> Delayed drag has been triggered  延迟拖动已被触发 </span><span style="color: #008080;"> 582</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> we can re-enable the events: touchmove/mousemove  我们可以重新启用touchmove / MouseMove事件： </span><span style="color: #008080;"> 583</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">解绑事件，关闭_dragStartTimer 定时器 取消dragStartFn 函数执行</span> <span style="color: #008080;"> 584</span> <span style="color: #000000;">                    _this._disableDelayedDrag(); </span><span style="color: #008080;"> 585</span>  <span style="color: #008080;"> 586</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> Make the element draggable  使元件拖动 </span><span style="color: #008080;"> 587</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">把当前的拖拽节点的draggable 属性设置为真，让他支持html5拖拽事件</span> <span style="color: #008080;"> 588</span>                     dragEl.draggable = <span style="color: #0000ff;">true</span><span style="color: #000000;">; </span><span style="color: #008080;"> 589</span>  <span style="color: #008080;"> 590</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> Chosen item  dragEl  目标节点  类 _this.options.chosenClass='sortable-chosen' </span><span style="color: #008080;"> 591</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">为拖拽的节点添加一个class</span> <span style="color: #008080;"> 592</span>                     _toggleClass(dragEl, _this.options.chosenClass, <span style="color: #0000ff;">true</span><span style="color: #000000;">); </span><span style="color: #008080;"> 593</span>  <span style="color: #008080;"> 594</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> Bind the events: dragstart/dragend 绑定事件拖曳开始dragend</span> <span style="color: #008080;"> 595</span> <span style="color: #000000;">                    _this._triggerDragStart(touch); </span><span style="color: #008080;"> 596</span> <span style="color: #000000;">                }; </span><span style="color: #008080;"> 597</span>  <span style="color: #008080;"> 598</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Disable "draggable"    ignore="a, img"</span> <span style="color: #008080;"> 599</span>                 options.ignore.split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">).forEach(function (criteria) { </span><span style="color: #008080;"> 600</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> criteria 遍历数组的当前target </span><span style="color: #008080;"> 601</span>              <span style="color: #008080;"> 602</span>                   <span style="color: #008000;">//</span><span style="color: #008000;">criteria.trim() 去除空格</span> <span style="color: #008080;"> 603</span>                  <span style="color: #008000;">/*</span> <span style="color: #008080;"> 604</span> <span style="color: #008000;">                 el.draggable //html5拖拽属性 </span><span style="color: #008080;"> 605</span> <span style="color: #008000;">                   function _disableDraggable(el) { </span><span style="color: #008080;"> 606</span> <span style="color: #008000;">                           el.draggable = false; </span><span style="color: #008080;"> 607</span> <span style="color: #008000;">                  }  </span><span style="color: #008080;"> 608</span>                   <span style="color: #008080;"> 609</span>                  <span style="color: #008000;">*/</span> <span style="color: #008080;"> 610</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> 该函数功能是把当前拖拽对象的a和img节点的html5 拖拽属性改为false</span> <span style="color: #008080;"> 611</span> <span style="color: #000000;">                    _find(dragEl, criteria.trim(), _disableDraggable); </span><span style="color: #008080;"> 612</span> <span style="color: #000000;">                }); </span><span style="color: #008080;"> 613</span>              <span style="color: #008080;"> 614</span>                 _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">mouseup</span><span style="color: #800000;">'</span>, _this._onDrop);  <span style="color: #008000;">//</span><span style="color: #008000;">在ownerDocument 文档上面当发生鼠标抬起的时候，添加_onDrop函数</span> <span style="color: #008080;"> 615</span>                 _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchend</span><span style="color: #800000;">'</span>, _this._onDrop);<span style="color: #008000;">//</span><span style="color: #008000;">在ownerDocument 文档上面当发生触摸抬起的时候，添加_onDrop函数</span> <span style="color: #008080;"> 616</span>                 _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchcancel</span><span style="color: #800000;">'</span>, _this._onDrop);<span style="color: #008000;">//</span><span style="color: #008000;">在ownerDocument 文档上面当发生触摸划过抬起的时候，解绑_onDrop函数 </span><span style="color: #008080;"> 617</span>         <span style="color: #008000;">//</span><span style="color: #008000;">delay 初始值为0</span> <span style="color: #008080;"> 618</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (options.delay) { </span><span style="color: #008080;"> 619</span>                     <span style="color: #008000;">/*</span> <span style="color: #008080;"> 620</span> <span style="color: #008000;">                            这里里面的程序块添加了事件只有调用_disableDelayedDrag，添加了一个定时器执行一次dragStartFn函数，这个函数又马上解绑_disableDelayedDrag事件，关闭定时器，整个思路是只让程序发生一次，并且马上解绑事件,销毁该事件。这样思维有些特别 </span><span style="color: #008080;"> 621</span>                     <span style="color: #008000;">*/</span> <span style="color: #008080;"> 622</span>                      <span style="color: #008080;"> 623</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> If the user moves the pointer or let go the click or touch  如果用户移动指针或单击&ldquo;单击&rdquo;或&ldquo;触摸&rdquo; </span><span style="color: #008080;"> 624</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> before the delay has been reached:  </span><span style="color: #008000;">//</span><span style="color: #008000;">之前的延迟已达到 </span><span style="color: #008080;"> 625</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> disable the delayed drag  </span><span style="color: #008000;">//</span><span style="color: #008000;">禁用延迟拖动</span> <span style="color: #008080;"> 626</span>                     _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">mouseup</span><span style="color: #800000;">'</span>, _this._disableDelayedDrag);  <span style="color: #008000;">//</span><span style="color: #008000;">当鼠标抬起的时候在文档上添加_disableDelayedDrag事件</span> <span style="color: #008080;"> 627</span>                     _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchend</span><span style="color: #800000;">'</span>, _this._disableDelayedDrag); <span style="color: #008000;">//</span><span style="color: #008000;">触摸抬起的时候在文档上添加_disableDelayedDrag事件</span> <span style="color: #008080;"> 628</span>                     _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchcancel</span><span style="color: #800000;">'</span>, _this._disableDelayedDrag); <span style="color: #008000;">//</span><span style="color: #008000;">触摸划过抬起的时候在文档上添加_disableDelayedDrag事件</span> <span style="color: #008080;"> 629</span>                     _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">mousemove</span><span style="color: #800000;">'</span>, _this._disableDelayedDrag); <span style="color: #008000;">//</span><span style="color: #008000;">当鼠标移动mousemove的时候在文档上添加_disableDelayedDrag事件</span> <span style="color: #008080;"> 630</span>                     _on(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchmove</span><span style="color: #800000;">'</span>, _this._disableDelayedDrag); <span style="color: #008000;">//</span><span style="color: #008000;">触摸移动的时候在文档上添加_disableDelayedDrag事件</span> <span style="color: #008080;"> 631</span>  <span style="color: #008080;"> 632</span>                     _this._dragStartTimer = setTimeout(dragStartFn, options.delay); <span style="color: #008000;">//</span><span style="color: #008000;">执行dragStartFn函数</span> <span style="color: #008080;"> 633</span>                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 634</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽</span> <span style="color: #008080;"> 635</span> <span style="color: #000000;">                    dragStartFn(); </span><span style="color: #008080;"> 636</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 637</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 638</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 639</span>         <span style="color: #008080;"> 640</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 641</span> <span style="color: #008000;">         *函数名 ：_disableDelayedDrag </span><span style="color: #008080;"> 642</span> <span style="color: #008000;">         *函数功能描述 ：   禁用延迟拖拽 当拖拽延时的时候，把所有事件解绑，并且关闭定时器。 </span><span style="color: #008080;"> 643</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;"> 644</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;"> 645</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;"> 646</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 647</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 648</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 649</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 650</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 651</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 652</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 653</span> <span style="color: #000000;">        _disableDelayedDrag: function () { </span><span style="color: #008080;"> 654</span>             <span style="color: #0000ff;">var</span> ownerDocument = <span style="color: #0000ff;">this</span><span style="color: #000000;">.el.ownerDocument; </span><span style="color: #008080;"> 655</span>  <span style="color: #008080;"> 656</span>             clearTimeout(<span style="color: #0000ff;">this</span>._dragStartTimer);  <span style="color: #008000;">//</span><span style="color: #008000;">关闭定时器</span> <span style="color: #008080;"> 657</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">mouseup</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._disableDelayedDrag);<span style="color: #008000;">//</span><span style="color: #008000;">当鼠标抬起的时候在文档上解绑_disableDelayedDrag事件</span> <span style="color: #008080;"> 658</span>              <span style="color: #008080;"> 659</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchend</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._disableDelayedDrag);<span style="color: #008000;">//</span><span style="color: #008000;">触摸抬起的时候在文档上解绑_disableDelayedDrag事件</span> <span style="color: #008080;"> 660</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchcancel</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._disableDelayedDrag);<span style="color: #008000;">//</span><span style="color: #008000;">当触摸划过抬起的时候在文档上解绑_disableDelayedDrag事件</span> <span style="color: #008080;"> 661</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">mousemove</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._disableDelayedDrag);<span style="color: #008000;">//</span><span style="color: #008000;">当鼠移动起的时候在文档上解绑_disableDelayedDrag事件</span> <span style="color: #008080;"> 662</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchmove</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._disableDelayedDrag);<span style="color: #008000;">//</span><span style="color: #008000;">触摸的时候在文档上解绑_disableDelayedDrag事件</span> <span style="color: #008080;"> 663</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 664</span>    <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 665</span> <span style="color: #008000;">         *函数名 ：_triggerDragStart </span><span style="color: #008080;"> 666</span> <span style="color: #008000;">         *函数功能描述 ： 为拖拽前做好准本，包括判断是否是触摸设备，或者pc，或者没有dragend </span><span style="color: #008080;"> 667</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;"> 668</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;"> 669</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 670</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 671</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 672</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 673</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 674</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 675</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 676</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 677</span>         _triggerDragStart: function (<span style="color: #008000;">/*</span><span style="color: #008000;">* Touch </span><span style="color: #008000;">*/</span><span style="color: #000000;">touch) { </span><span style="color: #008080;"> 678</span>       <span style="color: #008080;"> 679</span>          <span style="color: #008000;">//</span><span style="color: #008000;">按下去的值</span> <span style="color: #008080;"> 680</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (touch) { </span><span style="color: #008080;"> 681</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Touch device support 触摸设备支持</span> <span style="color: #008080;"> 682</span>                 tapEvt =<span style="color: #000000;"> { </span><span style="color: #008080;"> 683</span> <span style="color: #000000;">                    target: dragEl, </span><span style="color: #008080;"> 684</span> <span style="color: #000000;">                    clientX: touch.clientX, </span><span style="color: #008080;"> 685</span> <span style="color: #000000;">                    clientY: touch.clientY </span><span style="color: #008080;"> 686</span> <span style="color: #000000;">                }; </span><span style="color: #008080;"> 687</span>  <span style="color: #008080;"> 688</span>                 <span style="color: #0000ff;">this</span>._onDragStart(tapEvt, <span style="color: #800000;">'</span><span style="color: #800000;">touch</span><span style="color: #800000;">'</span>); <span style="color: #008000;">//</span><span style="color: #008000;">触摸设备</span> <span style="color: #008080;"> 689</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 690</span>             <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (!<span style="color: #0000ff;">this</span><span style="color: #000000;">.nativeDraggable) { </span><span style="color: #008080;"> 691</span>                  <span style="color: #008080;"> 692</span>                 <span style="color: #0000ff;">this</span>._onDragStart(tapEvt, <span style="color: #0000ff;">true</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">pc设备</span> <span style="color: #008080;"> 693</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 694</span>             <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 695</span>                  <span style="color: #008000;">//</span><span style="color: #008000;">如果当前的html还没有设置拖拽属性则先设置拖拽属性</span> <span style="color: #008080;"> 696</span>                 _on(dragEl, <span style="color: #800000;">'</span><span style="color: #800000;">dragend</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">);   </span><span style="color: #008080;"> 697</span>                 _on(rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">dragstart</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onDragStart); </span><span style="color: #008080;"> 698</span>                  <span style="color: #008080;"> 699</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 700</span>  <span style="color: #008080;"> 701</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 702</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (document.selection) {                     </span><span style="color: #008080;"> 703</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> Timeout neccessary for IE9                    </span> <span style="color: #008080;"> 704</span> <span style="color: #000000;">                    setTimeout(function () { </span><span style="color: #008080;"> 705</span>                         document.selection.empty(); <span style="color: #008000;">//</span><span style="color: #008000;">取消选中</span> <span style="color: #008080;"> 706</span> <span style="color: #000000;">                    });                     </span><span style="color: #008080;"> 707</span>                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 708</span>                     window.getSelection().removeAllRanges();<span style="color: #008000;">//</span><span style="color: #008000;">取消选中</span> <span style="color: #008080;"> 709</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 710</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (err) { </span><span style="color: #008080;"> 711</span>                  <span style="color: #008080;"> 712</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 713</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 714</span>  <span style="color: #008080;"> 715</span>  <span style="color: #008080;"> 716</span>  <span style="color: #008080;"> 717</span> <span style="color: #000000;">        _dragStarted: function () { </span><span style="color: #008080;"> 718</span>             <span style="color: #0000ff;">if</span> (rootEl &amp;&amp; dragEl) {  <span style="color: #008000;">//</span><span style="color: #008000;">如果鼠标按下去的拖拽节点存在和拖拽的根节点存在 </span><span style="color: #008080;"> 719</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Apply effect </span><span style="color: #008080;"> 720</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">为拖拽节点添加一个class名字是'sortable-ghost'</span> <span style="color: #008080;"> 721</span>                 _toggleClass(dragEl, <span style="color: #0000ff;">this</span>.options.ghostClass, <span style="color: #0000ff;">true</span><span style="color: #000000;">); </span><span style="color: #008080;"> 722</span>                <span style="color: #008000;">//</span><span style="color: #008000;">Sortable类赋值给Sortable.active 属性</span> <span style="color: #008080;"> 723</span>                 Sortable.active = <span style="color: #0000ff;">this</span><span style="color: #000000;">; </span><span style="color: #008080;"> 724</span>  <span style="color: #008080;"> 725</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Drag start event </span><span style="color: #008080;"> 726</span>               <span style="color: #008080;"> 727</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽 并且会相应onStart 接口函数</span> <span style="color: #008080;"> 728</span>                 _dispatchEvent(<span style="color: #0000ff;">this</span>, rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">start</span><span style="color: #800000;">'</span><span style="color: #000000;">, dragEl, rootEl, oldIndex); </span><span style="color: #008080;"> 729</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 730</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 731</span>  <span style="color: #008080;"> 732</span> <span style="color: #000000;">        _emulateDragOver: function () { </span><span style="color: #008080;"> 733</span>          <span style="color: #008080;"> 734</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (touchEvt) { </span><span style="color: #008080;"> 735</span>                 <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span>._lastX === touchEvt.clientX &amp;&amp; <span style="color: #0000ff;">this</span>._lastY ===<span style="color: #000000;"> touchEvt.clientY) { </span><span style="color: #008080;"> 736</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">; </span><span style="color: #008080;"> 737</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 738</span>  <span style="color: #008080;"> 739</span>                 <span style="color: #0000ff;">this</span>._lastX =<span style="color: #000000;"> touchEvt.clientX; </span><span style="color: #008080;"> 740</span>                 <span style="color: #0000ff;">this</span>._lastY =<span style="color: #000000;"> touchEvt.clientY; </span><span style="color: #008080;"> 741</span>  <span style="color: #008080;"> 742</span>                 <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">supportCssPointerEvents) { </span><span style="color: #008080;"> 743</span>                     _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">display</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;"> 744</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 745</span>  <span style="color: #008080;"> 746</span>                 <span style="color: #0000ff;">var</span> target =<span style="color: #000000;"> document.elementFromPoint(touchEvt.clientX, touchEvt.clientY), </span><span style="color: #008080;"> 747</span>                     parent =<span style="color: #000000;"> target, </span><span style="color: #008080;"> 748</span>                     groupName = <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + <span style="color: #0000ff;">this</span>.options.group.name + <span style="color: #800000;">''</span><span style="color: #000000;">, </span><span style="color: #008080;"> 749</span>                     i =<span style="color: #000000;"> touchDragOverListeners.length; </span><span style="color: #008080;"> 750</span>  <span style="color: #008080;"> 751</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (parent) { </span><span style="color: #008080;"> 752</span>                     <span style="color: #0000ff;">do</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 753</span>                         <span style="color: #0000ff;">if</span> (parent[expando] &amp;&amp; parent[expando].options.groups.indexOf(groupName) &gt; -<span style="color: #800080;">1</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 754</span>                             <span style="color: #0000ff;">while</span> (i--<span style="color: #000000;">) { </span><span style="color: #008080;"> 755</span> <span style="color: #000000;">                                touchDragOverListeners[i]({ </span><span style="color: #008080;"> 756</span> <span style="color: #000000;">                                    clientX: touchEvt.clientX, </span><span style="color: #008080;"> 757</span> <span style="color: #000000;">                                    clientY: touchEvt.clientY, </span><span style="color: #008080;"> 758</span> <span style="color: #000000;">                                    target: target, </span><span style="color: #008080;"> 759</span> <span style="color: #000000;">                                     rootEl: parent </span><span style="color: #008080;"> 760</span> <span style="color: #000000;">                                }); </span><span style="color: #008080;"> 761</span> <span style="color: #000000;">                            } </span><span style="color: #008080;"> 762</span>  <span style="color: #008080;"> 763</span>                             <span style="color: #0000ff;">break</span><span style="color: #000000;">; </span><span style="color: #008080;"> 764</span> <span style="color: #000000;">                        } </span><span style="color: #008080;"> 765</span>  <span style="color: #008080;"> 766</span>                         target = parent; <span style="color: #008000;">//</span><span style="color: #008000;"> store last element</span> <span style="color: #008080;"> 767</span> <span style="color: #000000;">                    } </span><span style="color: #008080;"> 768</span>                     <span style="color: #008000;">/*</span><span style="color: #008000;"> jshint boss:true </span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 769</span>                     <span style="color: #0000ff;">while</span> (parent =<span style="color: #000000;"> parent.parentNode); </span><span style="color: #008080;"> 770</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 771</span>  <span style="color: #008080;"> 772</span>                 <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">supportCssPointerEvents) { </span><span style="color: #008080;"> 773</span>                     _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">display</span><span style="color: #800000;">'</span>, <span style="color: #800000;">''</span><span style="color: #000000;">); </span><span style="color: #008080;"> 774</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 775</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 776</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 777</span>  <span style="color: #008080;"> 778</span> <span style="color: #008000;">/*</span> <span style="color: #008080;"> 779</span> <span style="color: #008000;">tapEvt = { </span><span style="color: #008080;"> 780</span> <span style="color: #008000;">                    target: dragEl, </span><span style="color: #008080;"> 781</span> <span style="color: #008000;">                    clientX: touch.clientX, </span><span style="color: #008080;"> 782</span> <span style="color: #008000;">                    clientY: touch.clientY </span><span style="color: #008080;"> 783</span> <span style="color: #008000;">                }; </span><span style="color: #008080;"> 784</span> <span style="color: #008000;">*/</span> <span style="color: #008080;"> 785</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 786</span> <span style="color: #008000;">         *函数名 ：_onTouchMove </span><span style="color: #008080;"> 787</span> <span style="color: #008000;">         *函数功能描述 ：  触摸移动拖拽动画事件ghostEl，把拖拽移动的xy值给ghostEl节点 </span><span style="color: #008080;"> 788</span> <span style="color: #008000;">         *函数参数 ： viod </span><span style="color: #008080;"> 789</span> <span style="color: #008000;">         *函数返回值 ： 无 </span><span style="color: #008080;"> 790</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 791</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 792</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 793</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 794</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 795</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 796</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 797</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 798</span>         _onTouchMove: function (<span style="color: #008000;">/*</span><span style="color: #008000;">*TouchEvent</span><span style="color: #008000;">*/</span><span style="color: #000000;">evt) { </span><span style="color: #008080;"> 799</span>             <span style="color: #008000;">//</span><span style="color: #008000;">evt 事件对象</span> <span style="color: #008080;"> 800</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (tapEvt) { </span><span style="color: #008080;"> 801</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> only set the status to dragging, when we are actually dragging</span> <span style="color: #008080;"> 802</span>                 <span style="color: #0000ff;">if</span> (!Sortable.active) {  <span style="color: #008000;">//</span><span style="color: #008000;">Sortable.active 不存在则执行_dragStarted函数  设置拖拽动态</span> <span style="color: #008080;"> 803</span>                     <span style="color: #0000ff;">this</span><span style="color: #000000;">._dragStarted(); </span><span style="color: #008080;"> 804</span> <span style="color: #000000;">                } </span><span style="color: #008080;"> 805</span>  <span style="color: #008080;"> 806</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> as well as creating the ghost element on the document body </span><span style="color: #008080;"> 807</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> 创建一个ghostEl dom节点，并且是克隆拖拽节点的rootEl下面就是id那个dom节点，添加在，并且设置了一些属性，高,宽，top，left，透明度，鼠标样式，</span> <span style="color: #008080;"> 808</span>                 <span style="color: #0000ff;">this</span><span style="color: #000000;">._appendGhost(); </span><span style="color: #008080;"> 809</span>              <span style="color: #008080;"> 810</span>                 <span style="color: #0000ff;">var</span> touch = evt.touches ? evt.touches[<span style="color: #800080;">0</span>] : evt, <span style="color: #008000;">//</span><span style="color: #008000;">判断是否是触摸事件还是pc鼠标事件</span> <span style="color: #008080;"> 811</span>                     dx = touch.clientX - tapEvt.clientX, <span style="color: #008000;">//</span><span style="color: #008000;">鼠标移动的x位置减去鼠标按下去的位置。</span> <span style="color: #008080;"> 812</span>                     dy = touch.clientY - tapEvt.clientY,<span style="color: #008000;">//</span><span style="color: #008000;">鼠标移动的y位置减去鼠标按下去的位置。 </span><span style="color: #008080;"> 813</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">3d 特效 x是左右，y是上下，z是放大缩小  设置3d效果</span> <span style="color: #008080;"> 814</span>                     translate3d = evt.touches ? <span style="color: #800000;">'</span><span style="color: #800000;">translate3d(</span><span style="color: #800000;">'</span> + dx + <span style="color: #800000;">'</span><span style="color: #800000;">px,</span><span style="color: #800000;">'</span> + dy + <span style="color: #800000;">'</span><span style="color: #800000;">px,0)</span><span style="color: #800000;">'</span> : <span style="color: #800000;">'</span><span style="color: #800000;">translate(</span><span style="color: #800000;">'</span> + dx + <span style="color: #800000;">'</span><span style="color: #800000;">px,</span><span style="color: #800000;">'</span> + dy + <span style="color: #800000;">'</span><span style="color: #800000;">px)</span><span style="color: #800000;">'</span><span style="color: #000000;">; </span><span style="color: #008080;"> 815</span>  <span style="color: #008080;"> 816</span>                 moved = <span style="color: #0000ff;">true</span><span style="color: #000000;">; </span><span style="color: #008080;"> 817</span>                 touchEvt = touch;  <span style="color: #008000;">//</span><span style="color: #008000;">事件对象</span> <span style="color: #008080;"> 818</span>   <span style="color: #008080;"> 819</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">webkitTransform</span><span style="color: #800000;">'</span>, translate3d);  <span style="color: #008000;">//</span><span style="color: #008000;">设置3d效果</span> <span style="color: #008080;"> 820</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">mozTransform</span><span style="color: #800000;">'</span>, translate3d);    <span style="color: #008000;">//</span><span style="color: #008000;">设置3d效果</span> <span style="color: #008080;"> 821</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">msTransform</span><span style="color: #800000;">'</span>, translate3d) ;  <span style="color: #008000;">//</span><span style="color: #008000;">设置3d效果</span> <span style="color: #008080;"> 822</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">transform</span><span style="color: #800000;">'</span>, translate3d);   <span style="color: #008000;">//</span><span style="color: #008000;">设置3d效果</span> <span style="color: #008080;"> 823</span>   <span style="color: #008080;"> 824</span>           <span style="color: #008080;"> 825</span>                 evt.preventDefault(); <span style="color: #008000;">//</span><span style="color: #008000;"> 阻止默认事件</span> <span style="color: #008080;"> 826</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 827</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 828</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 829</span> <span style="color: #008000;">         *函数名 ：_appendGhost </span><span style="color: #008080;"> 830</span> <span style="color: #008000;">         *函数功能描述 ：  创建一个ghostEl dom节点，并且是克隆拖拽节点的rootEl下面就是id那个dom节点，添加在，并且设置了一些属性，高,宽，top，left，透明度，鼠标样式， </span><span style="color: #008080;"> 831</span> <span style="color: #008000;">         *函数参数 ：  viod </span><span style="color: #008080;"> 832</span> <span style="color: #008000;">         *函数返回值 ： 无 </span><span style="color: #008080;"> 833</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 834</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 835</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 836</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 837</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 838</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 839</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 840</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 841</span> <span style="color: #000000;">        _appendGhost: function () { </span><span style="color: #008080;"> 842</span>       <span style="color: #008080;"> 843</span>             <span style="color: #0000ff;">if</span> (!ghostEl) {  <span style="color: #008000;">//</span><span style="color: #008000;"> 如果ghostEl 是空的，或者是假，或者是undefined，或者是0，则执行下面程序</span> <span style="color: #008080;"> 844</span>             <span style="color: #008000;">/*</span><span style="color: #008000;">getBoundingClientRect() </span><span style="color: #008080;"> 845</span> <span style="color: #008000;">               其实跟 o_dom.getBoundingClientRect().left=    o_dom.offsetLeft; 他们值相等 </span><span style="color: #008080;"> 846</span> <span style="color: #008000;">           这个方法返回一个矩形对象，包含四个属性：left、top、right和bottom。分别表示元素各边与页面上边和左边的距离。 </span><span style="color: #008080;"> 847</span>             <span style="color: #008000;">*/</span> <span style="color: #008080;"> 848</span>                 <span style="color: #0000ff;">var</span> rect =<span style="color: #000000;"> dragEl.getBoundingClientRect(),   </span><span style="color: #008080;"> 849</span>                      css = _css(dragEl),   <span style="color: #008000;">//</span><span style="color: #008000;">返回当前obj 所有的style的属性</span> <span style="color: #008080;"> 850</span>                     options = <span style="color: #0000ff;">this</span>.options,  <span style="color: #008000;">//</span><span style="color: #008000;">this.options 参数</span> <span style="color: #008080;"> 851</span>                     ghostRect; <span style="color: #008000;">//</span><span style="color: #008000;">一个空变量</span> <span style="color: #008080;"> 852</span>  <span style="color: #008080;"> 853</span>                 ghostEl = dragEl.cloneNode(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;">克隆dragEl 当前拖拽的节点 </span><span style="color: #008080;"> 854</span>               <span style="color: #008000;">//</span><span style="color: #008000;">options.ghostClass='sortable-ghost'</span> <span style="color: #008080;"> 855</span>                 _toggleClass(ghostEl, options.ghostClass, <span style="color: #0000ff;">false</span><span style="color: #000000;">); </span><span style="color: #008080;"> 856</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">fallbackClass= 'sortable-fallback</span> <span style="color: #008080;"> 857</span>                  _toggleClass(ghostEl, options.fallbackClass, <span style="color: #0000ff;">true</span><span style="color: #000000;">); </span><span style="color: #008080;"> 858</span>           <span style="color: #008080;"> 859</span>                <span style="color: #008000;">//</span><span style="color: #008000;">给新创建的节点的left和top和该节点的left和top值相等，所以要减去marginTop，marginLeft</span> <span style="color: #008080;"> 860</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">top</span><span style="color: #800000;">'</span>, rect.top - parseInt(css.marginTop, <span style="color: #800080;">10</span><span style="color: #000000;">)); </span><span style="color: #008080;"> 861</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">left</span><span style="color: #800000;">'</span>, rect.left - parseInt(css.marginLeft, <span style="color: #800080;">10</span><span style="color: #000000;">)); </span><span style="color: #008080;"> 862</span>               <span style="color: #008080;"> 863</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">width</span><span style="color: #800000;">'</span>, rect.width);   <span style="color: #008000;">//</span><span style="color: #008000;">宽和高和拖拽节点相同</span> <span style="color: #008080;"> 864</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">height</span><span style="color: #800000;">'</span><span style="color: #000000;">, rect.height); </span><span style="color: #008080;"> 865</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">opacity</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">0.8</span><span style="color: #800000;">'</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">透明度为0.8</span> <span style="color: #008080;"> 866</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">position</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">fixed</span><span style="color: #800000;">'</span>);  <span style="color: #008000;">//</span><span style="color: #008000;"> 固定定位</span> <span style="color: #008080;"> 867</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">zIndex</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">100000</span><span style="color: #800000;">'</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">层为100000</span> <span style="color: #008080;"> 868</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">pointerEvents</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span>);   <span style="color: #008000;">//</span><span style="color: #008000;">pointer-events:none顾名思意，就是鼠标事件拜拜的意思。元素应用了该CSS属性，链接啊，点击啊什么的都变成了&ldquo;浮云牌酱油&rdquo;。 </span><span style="color: #008080;"> 869</span>               <span style="color: #008000;">//</span><span style="color: #008000;">把ghostEl 添加到拖拽的根节点那 </span> <span style="color: #008080;"> 870</span>                 options.fallbackOnBody &amp;&amp; document.body.appendChild(ghostEl) ||<span style="color: #000000;"> rootEl.appendChild(ghostEl); </span><span style="color: #008080;"> 871</span>   <span style="color: #008080;"> 872</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Fixing dimensions.  固定尺寸 但是我觉这样写多此一举，因为上面已经设置高宽了，然后再乘以2，再减去一般结果还是一样的</span> <span style="color: #008080;"> 873</span>                 ghostRect =<span style="color: #000000;"> ghostEl.getBoundingClientRect(); </span><span style="color: #008080;"> 874</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">width</span><span style="color: #800000;">'</span>, rect.width * <span style="color: #800080;">2</span> -<span style="color: #000000;"> ghostRect.width); </span><span style="color: #008080;"> 875</span>                 _css(ghostEl, <span style="color: #800000;">'</span><span style="color: #800000;">height</span><span style="color: #800000;">'</span>, rect.height * <span style="color: #800080;">2</span> -<span style="color: #000000;"> ghostRect.height); </span><span style="color: #008080;"> 876</span>                   <span style="color: #008080;"> 877</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 878</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 879</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 880</span> <span style="color: #008000;">         *函数名 ：_onDragStart </span><span style="color: #008080;"> 881</span> <span style="color: #008000;">         *函数功能描述 ：  拖拽开始 为document添加触摸事件与鼠标事件  </span><span style="color: #008080;"> 882</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;"> 883</span> <span style="color: #008000;">                           evt： </span><span style="color: #008080;"> 884</span> <span style="color: #008000;">                                 类型:obj, 事件对象 </span><span style="color: #008080;"> 885</span> <span style="color: #008000;">                          useFallback:类型：string，    Boolean 值      </span><span style="color: #008080;"> 886</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;"> 887</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;"> 888</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 889</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 890</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 891</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 892</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 893</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 894</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 895</span>  <span style="color: #008080;"> 896</span>         _onDragStart: function (<span style="color: #008000;">/*</span><span style="color: #008000;">*Event</span><span style="color: #008000;">*/</span>evt, <span style="color: #008000;">/*</span><span style="color: #008000;">*boolean</span><span style="color: #008000;">*/</span><span style="color: #000000;">useFallback) { </span><span style="color: #008080;"> 897</span>              <span style="color: #008000;">//</span><span style="color: #008000;">html5拖拽属性。dataTransfer对象有两个主要的方法：getData()方法和setData()方法。</span> <span style="color: #008080;"> 898</span>             <span style="color: #0000ff;">var</span> dataTransfer =<span style="color: #000000;"> evt.dataTransfer, </span><span style="color: #008080;"> 899</span>                 options = <span style="color: #0000ff;">this</span><span style="color: #000000;">.options; </span><span style="color: #008080;"> 900</span>            <span style="color: #008080;"> 901</span>           <span style="color: #008000;">//</span><span style="color: #008000;">解绑文档上面的一些事件</span> <span style="color: #008080;"> 902</span>             <span style="color: #0000ff;">this</span><span style="color: #000000;">._offUpEvents(); </span><span style="color: #008080;"> 903</span>           <span style="color: #008000;">//</span><span style="color: #008000;">Object {name: "words", pull: true, put: true}         </span><span style="color: #008080;"> 904</span>           <span style="color: #008000;">//</span><span style="color: #008000;">activeGroup={name: "words", pull: true, put: true}     </span> <span style="color: #008080;"> 905</span>              <span style="color: #0000ff;">if</span> (activeGroup.pull == <span style="color: #800000;">'</span><span style="color: #800000;">clone</span><span style="color: #800000;">'</span>) { <span style="color: #008000;">//</span><span style="color: #008000;">如果 参数是clone 则可以克隆节点而不是拖拽节点过去</span> <span style="color: #008080;"> 906</span>                 cloneEl = dragEl.cloneNode(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;">cloneNode(false) 克隆复制节点，参数如果是false则不复制里面的html，true则会复制整个dom包括里面的html </span><span style="color: #008080;"> 907</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">设置cloneEl 节点隐藏</span> <span style="color: #008080;"> 908</span>                 _css(cloneEl, <span style="color: #800000;">'</span><span style="color: #800000;">display</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;"> 909</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">插入加点，在当前拖拽的dom节点前面插入一个节点</span> <span style="color: #008080;"> 910</span> <span style="color: #000000;">                rootEl.insertBefore(cloneEl, dragEl); </span><span style="color: #008080;"> 911</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 912</span>  <span style="color: #008080;"> 913</span>             <span style="color: #0000ff;">if</span> (useFallback) { <span style="color: #008000;">//</span><span style="color: #008000;">如果是触摸则添加触摸事件</span> <span style="color: #008080;"> 914</span>                        <span style="color: #008080;"> 915</span>                         <span style="color: #0000ff;">if</span> (useFallback === <span style="color: #800000;">'</span><span style="color: #800000;">touch</span><span style="color: #800000;">'</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 916</span>                             <span style="color: #008000;">//</span><span style="color: #008000;"> Bind touch events </span><span style="color: #008080;"> 917</span>                             <span style="color: #008000;">//</span><span style="color: #008000;">添加触摸移动事件</span> <span style="color: #008080;"> 918</span>                             _on(document, <span style="color: #800000;">'</span><span style="color: #800000;">touchmove</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onTouchMove); </span><span style="color: #008080;"> 919</span>                             <span style="color: #008000;">//</span><span style="color: #008000;">添加触摸抬起事件</span> <span style="color: #008080;"> 920</span>                             _on(document, <span style="color: #800000;">'</span><span style="color: #800000;">touchend</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onDrop); </span><span style="color: #008080;"> 921</span>                             <span style="color: #008000;">//</span><span style="color: #008000;">添加触摸划过结束事件</span> <span style="color: #008080;"> 922</span>                             _on(document, <span style="color: #800000;">'</span><span style="color: #800000;">touchcancel</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onDrop); </span><span style="color: #008080;"> 923</span>                         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 924</span>                             <span style="color: #008000;">//</span><span style="color: #008000;"> Old brwoser </span><span style="color: #008080;"> 925</span>                             <span style="color: #008000;">//</span><span style="color: #008000;">pc 添加鼠标移动事件</span> <span style="color: #008080;"> 926</span>                             _on(document, <span style="color: #800000;">'</span><span style="color: #800000;">mousemove</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onTouchMove); </span><span style="color: #008080;"> 927</span>                                 <span style="color: #008000;">//</span><span style="color: #008000;">pc 添加鼠标抬起事件</span> <span style="color: #008080;"> 928</span>                             _on(document, <span style="color: #800000;">'</span><span style="color: #800000;">mouseup</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">._onDrop); </span><span style="color: #008080;"> 929</span> <span style="color: #000000;">                        } </span><span style="color: #008080;"> 930</span>          <span style="color: #008080;"> 931</span>                         <span style="color: #0000ff;">this</span>._loopId = setInterval(<span style="color: #0000ff;">this</span>._emulateDragOver, <span style="color: #800080;">50</span><span style="color: #000000;">); </span><span style="color: #008080;"> 932</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 933</span>             <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;"> 934</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">html5拖拽属性。dataTransfer对象有两个主要的方法：getData()方法和setData()方法。</span> <span style="color: #008080;"> 935</span>                         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (dataTransfer) { </span><span style="color: #008080;"> 936</span>                             dataTransfer.effectAllowed = <span style="color: #800000;">'</span><span style="color: #800000;">move</span><span style="color: #800000;">'</span>;<span style="color: #008000;">//</span><span style="color: #008000;">move ：只允许值为&rdquo;move&rdquo;的dropEffect。</span> <span style="color: #008080;"> 937</span>                             <span style="color: #008000;">/*</span> <span style="color: #008080;"> 938</span> <span style="color: #008000;">                                setData: function (dataTransfer, dragEl) { dataTransfer.setData('Text', dragEl.textContent);} </span><span style="color: #008080;"> 939</span> <span style="color: #008000;">                                设置拖拽时候拖拽信息 </span><span style="color: #008080;"> 940</span>                             <span style="color: #008000;">*/</span> <span style="color: #008080;"> 941</span>                              options.setData &amp;&amp; options.setData.call(<span style="color: #0000ff;">this</span><span style="color: #000000;">, dataTransfer, dragEl); </span><span style="color: #008080;"> 942</span> <span style="color: #000000;">                        } </span><span style="color: #008080;"> 943</span>          <span style="color: #008080;"> 944</span>                         _on(document, <span style="color: #800000;">'</span><span style="color: #800000;">drop</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">添加拖拽结束事件</span> <span style="color: #008080;"> 945</span>                       <span style="color: #008080;"> 946</span>                         setTimeout(<span style="color: #0000ff;">this</span>._dragStarted, <span style="color: #800080;">0</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">pc拖拽事件</span> <span style="color: #008080;"> 947</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 948</span> <span style="color: #000000;">        }, </span><span style="color: #008080;"> 949</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;"> 950</span> <span style="color: #008000;">         *函数名 ：_onDragOver </span><span style="color: #008080;"> 951</span> <span style="color: #008000;">         *函数功能描述 ：  拖拽元素进进入拖拽区域， 判断拖拽节点与拖拽碰撞的节点，交换他们的dom节点位置，并执行动画。  </span><span style="color: #008080;"> 952</span> <span style="color: #008000;">         *函数参数 ：evt </span><span style="color: #008080;"> 953</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;"> 954</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;"> 955</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;"> 956</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;"> 957</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;"> 958</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;"> 959</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;"> 960</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;"> 961</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;"> 962</span>         _onDragOver: function (<span style="color: #008000;">/*</span><span style="color: #008000;">*Event</span><span style="color: #008000;">*/</span><span style="color: #000000;">evt) { </span><span style="color: #008080;"> 963</span>              <span style="color: #008080;"> 964</span>             <span style="color: #0000ff;">var</span> el = <span style="color: #0000ff;">this</span><span style="color: #000000;">.el, </span><span style="color: #008080;"> 965</span> <span style="color: #000000;">                target, </span><span style="color: #008080;"> 966</span> <span style="color: #000000;">                dragRect, </span><span style="color: #008080;"> 967</span> <span style="color: #000000;">                revert, </span><span style="color: #008080;"> 968</span>                 options = <span style="color: #0000ff;">this</span><span style="color: #000000;">.options, </span><span style="color: #008080;"> 969</span>                 group =<span style="color: #000000;"> options.group, </span><span style="color: #008080;"> 970</span>                 groupPut =<span style="color: #000000;"> group.put, </span><span style="color: #008080;"> 971</span>                 isOwner = (activeGroup ===<span style="color: #000000;"> group), </span><span style="color: #008080;"> 972</span>                 canSort =<span style="color: #000000;"> options.sort; </span><span style="color: #008080;"> 973</span>              <span style="color: #0000ff;">if</span> (evt.preventDefault !== <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span><span style="color: #000000;">) { </span><span style="color: #008080;"> 974</span>                 evt.preventDefault();  <span style="color: #008000;">//</span><span style="color: #008000;">阻止默认事件</span> <span style="color: #008080;"> 975</span>                 !options.dragoverBubble &amp;&amp; evt.stopPropagation();<span style="color: #008000;">//</span><span style="color: #008000;">终止事件在传播过程的捕获、目标处理或起泡阶段进一步传播</span> <span style="color: #008080;"> 976</span> <span style="color: #000000;">            } </span><span style="color: #008080;"> 977</span>  <span style="color: #008080;"> 978</span>             moved = <span style="color: #0000ff;">true</span><span style="color: #000000;">; </span><span style="color: #008080;"> 979</span>             <span style="color: #008000;">//</span><span style="color: #008000;">activeGroup={name: "words", pull: true, put: true} </span><span style="color: #008080;"> 980</span>       <span style="color: #008080;"> 981</span>               <span style="color: #008080;"> 982</span>           <span style="color: #008000;">//</span><span style="color: #008000;">activeGroup=true </span><span style="color: #008080;"> 983</span>           <span style="color: #008000;">//</span><span style="color: #008000;">options.disabled=false </span><span style="color: #008080;"> 984</span>           <span style="color: #008000;">//</span><span style="color: #008000;">isOwner=true  因为isOwner=true 则执行canSort || (revert = !rootEl.contains(dragEl)) </span><span style="color: #008080;"> 985</span>           <span style="color: #008000;">//</span><span style="color: #008000;">如果父节点包含子节点则返回true ，contains,所以当canSort 是假时候(revert = !rootEl.contains(dragEl)  </span><span style="color: #008080;"> 986</span>           <span style="color: #008000;">//</span><span style="color: #008000;">revert = !rootEl.contains(dragEl)     取反赋值 </span><span style="color: #008080;"> 987</span>           <span style="color: #008000;">//</span><span style="color: #008000;">这里的if需要一个假才能拖拽 </span><span style="color: #008080;"> 988</span>           <span style="color: #008000;">//</span><span style="color: #008000;">(activeGroup.name === group.name) ==true; </span><span style="color: #008080;"> 989</span>           <span style="color: #008000;">//</span><span style="color: #008000;">(evt.rootEl === void 0 || evt.rootEl === this.el) ==true </span><span style="color: #008080;"> 990</span>           <span style="color: #008000;">//</span><span style="color: #008000;">所以 该功能是 给设置sort参数提供的</span> <span style="color: #008080;"> 991</span>          <span style="color: #0000ff;">if</span><span style="color: #000000;"> ( </span><span style="color: #008080;"> 992</span>                             activeGroup &amp;&amp;  <span style="color: #008080;"> 993</span>                             !options.disabled &amp;&amp; <span style="color: #008080;"> 994</span> <span style="color: #000000;">                            ( </span><span style="color: #008080;"> 995</span>                                  isOwner? canSort || (revert = !rootEl.contains(dragEl)) <span style="color: #008000;">//</span><span style="color: #008000;"> Reverting item into the original list</span> <span style="color: #008080;"> 996</span>                                 : activeGroup.pull &amp;&amp; groupPut &amp;&amp;<span style="color: #000000;"> ( </span><span style="color: #008080;"> 997</span>                                                                                                 (activeGroup.name === group.name) || <span style="color: #008000;">//</span><span style="color: #008000;"> by Name</span> <span style="color: #008080;"> 998</span>                                                                                                  (groupPut.indexOf &amp;&amp; ~groupPut.indexOf(activeGroup.name)) <span style="color: #008000;">//</span><span style="color: #008000;"> by Array</span> <span style="color: #008080;"> 999</span> <span style="color: #000000;">                                                                                             ) </span><span style="color: #008080;">1000</span>                           ) &amp;&amp; <span style="color: #008080;">1001</span>                             (evt.rootEl === <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span> || evt.rootEl === <span style="color: #0000ff;">this</span>.el) <span style="color: #008000;">//</span><span style="color: #008000;"> touch fallback</span> <span style="color: #008080;">1002</span> <span style="color: #000000;">              )  </span><span style="color: #008080;">1003</span> <span style="color: #000000;">                { </span><span style="color: #008080;">1004</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Smart auto-scrolling 智能滚动</span> <span style="color: #008080;">1005</span>                  _autoScroll(evt, options, <span style="color: #0000ff;">this</span><span style="color: #000000;">.el); </span><span style="color: #008080;">1006</span>  <span style="color: #008080;">1007</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (_silent) {  </span><span style="color: #008080;">1008</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">; </span><span style="color: #008080;">1009</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1010</span>           <span style="color: #008080;">1011</span>                 target = _closest(evt.target, options.draggable, el); <span style="color: #008000;">//</span><span style="color: #008000;">调整拖拽目标节点</span> <span style="color: #008080;">1012</span>                         <span style="color: #008080;">1013</span>                  <span style="color: #008080;">1014</span>                 dragRect = dragEl.getBoundingClientRect();  <span style="color: #008000;">//</span><span style="color: #008000;">获取dom节点的一个获取left，right ，top，bottmo，值</span> <span style="color: #008080;">1015</span>                  <span style="color: #008080;">1016</span>               <span style="color: #008080;">1017</span>               <span style="color: #008080;">1018</span>                 <span style="color: #0000ff;">if</span> (revert) {  <span style="color: #008000;">//</span><span style="color: #008000;">revert undefined</span> <span style="color: #008080;">1019</span>                     _cloneHide(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;">设置克隆的节点隐藏还是显示</span> <span style="color: #008080;">1020</span>  <span style="color: #008080;">1021</span>                     <span style="color: #0000ff;">if</span> (cloneEl || nextEl) { <span style="color: #008000;">//</span><span style="color: #008000;">如果克隆节点存在或者下一个节点存在</span> <span style="color: #008080;">1022</span>                          <span style="color: #008080;">1023</span>                         rootEl.insertBefore(dragEl, cloneEl || nextEl);<span style="color: #008000;">//</span><span style="color: #008000;">就把dragEl添加到克隆节点存在或者下一个节点的上面</span> <span style="color: #008080;">1024</span>                          <span style="color: #008080;">1025</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1026</span>                     <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (!canSort) {  <span style="color: #008000;">//</span><span style="color: #008000;">canSort 默认是true ，是设置是否 判断是否在自己区域拖拽</span> <span style="color: #008080;">1027</span>                         rootEl.appendChild(dragEl); <span style="color: #008000;">//</span><span style="color: #008000;">canSort 是假添加到根节点</span> <span style="color: #008080;">1028</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1029</span>                      <span style="color: #0000ff;">return</span><span style="color: #000000;">; </span><span style="color: #008080;">1030</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1031</span>  <span style="color: #008080;">1032</span>              <span style="color: #008000;">//</span><span style="color: #008000;">el.children.length 如果拖拽根节点没有子节点的时候该为true </span><span style="color: #008080;">1033</span>              <span style="color: #008000;">//</span><span style="color: #008000;">el.children[0] === ghostEl如果根节点的字节点等于镜像节点的时候为真 </span><span style="color: #008080;">1034</span>              <span style="color: #008000;">//</span><span style="color: #008000;">el === evt.target 根节点等于目标节点的时候</span> <span style="color: #008080;">1035</span>                 <span style="color: #0000ff;">if</span> ((el.children.length === <span style="color: #800080;">0</span>) || (el.children[<span style="color: #800080;">0</span>] === ghostEl) || <span style="color: #008080;">1036</span>                     (el === evt.target) &amp;&amp; (target =<span style="color: #000000;"> _ghostIsLast(el, evt)) </span><span style="color: #008080;">1037</span> <span style="color: #000000;">                ) { </span><span style="color: #008080;">1038</span>  <span style="color: #008080;">1039</span>                         <span style="color: #0000ff;">if</span> (target) { <span style="color: #008000;">//</span><span style="color: #008000;"> 如果_ghostIsLast 返回最后一个节点</span> <span style="color: #008080;">1040</span>                                         <span style="color: #0000ff;">if</span> (target.animated) {  <span style="color: #008000;">//</span><span style="color: #008000;">判断 target.animated 动画是否在执行，如果在执行那么就不执行下面函数</span> <span style="color: #008080;">1041</span>                                             <span style="color: #0000ff;">return</span><span style="color: #000000;">; </span><span style="color: #008080;">1042</span> <span style="color: #000000;">                                        } </span><span style="color: #008080;">1043</span>                  <span style="color: #008080;">1044</span>                                         targetRect =<span style="color: #000000;"> target.getBoundingClientRect(); </span><span style="color: #008080;">1045</span> <span style="color: #000000;">                        } </span><span style="color: #008080;">1046</span>                           <span style="color: #008000;">//</span><span style="color: #008000;">隐藏克隆节点</span> <span style="color: #008080;">1047</span> <span style="color: #000000;">                        _cloneHide(isOwner); </span><span style="color: #008080;">1048</span>                      <span style="color: #008080;">1049</span>  <span style="color: #008080;">1050</span>                     <span style="color: #008000;">/*</span> <span style="color: #008080;">1051</span> <span style="color: #008000;">                      rootEl:拖拽根节点 </span><span style="color: #008080;">1052</span> <span style="color: #008000;">                      el:拖拽根节点 </span><span style="color: #008080;">1053</span> <span style="color: #008000;">                      dragEl:拖拽节点 </span><span style="color: #008080;">1054</span> <span style="color: #008000;">                      dragRect:拖拽几点的Rect </span><span style="color: #008080;">1055</span> <span style="color: #008000;">                      target:目标节点或者是根节点的最后一个子节点，释放鼠标的节点 </span><span style="color: #008080;">1056</span> <span style="color: #008000;">                      targetRect:target的Rect </span><span style="color: #008080;">1057</span>                     <span style="color: #008000;">*/</span> <span style="color: #008080;">1058</span>                       <span style="color: #008080;">1059</span>       <span style="color: #008080;">1060</span>                         <span style="color: #0000ff;">if</span> (_onMove(rootEl, el, dragEl, dragRect, target, targetRect) !== <span style="color: #0000ff;">false</span><span style="color: #000000;">) { </span><span style="color: #008080;">1061</span>                             <span style="color: #0000ff;">if</span> (!dragEl.contains(el)) {  <span style="color: #008000;">//</span><span style="color: #008000;"> 判断dragEl中没有存在根节点</span> <span style="color: #008080;">1062</span>                                 el.appendChild(dragEl);  <span style="color: #008000;">//</span><span style="color: #008000;">就把目拖拽节点添加到根节点那</span> <span style="color: #008080;">1063</span>                                 parentEl = el; <span style="color: #008000;">//</span><span style="color: #008000;"> actualization</span> <span style="color: #008080;">1064</span> <span style="color: #000000;">                            } </span><span style="color: #008080;">1065</span>                             <span style="color: #008000;">//</span><span style="color: #008000;">动画</span> <span style="color: #008080;">1066</span>                          <span style="color: #0000ff;">this</span><span style="color: #000000;">._animate(dragRect, dragEl); </span><span style="color: #008080;">1067</span>                         target &amp;&amp; <span style="color: #0000ff;">this</span><span style="color: #000000;">._animate(targetRect, target); </span><span style="color: #008080;">1068</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1069</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1070</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">target 拖拽的目标节点存在 </span><span style="color: #008080;">1071</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">target.animated动画没有在执行 </span><span style="color: #008080;">1072</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">target !== dragEl 拖拽的节点不等于目标节点 就是发生了dragenter事件 </span><span style="color: #008080;">1073</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">target 拖拽的父节点是根节点  rootEl </span> <span style="color: #008080;">1074</span>                 <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (target &amp;&amp; !target.animated &amp;&amp; target !== dragEl &amp;&amp; (target.parentNode[expando] !== <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span><span style="color: #000000;">)) { </span><span style="color: #008080;">1075</span>                   <span style="color: #008080;">1076</span>                         i++<span style="color: #000000;">; </span><span style="color: #008080;">1077</span>                     <span style="color: #0000ff;">if</span> (lastEl !== target) { <span style="color: #008000;">//</span><span style="color: #008000;"> 拖拽的目标节点就是发生拖拽ondragover时候的节点 不是最后一个子节点的时候</span> <span style="color: #008080;">1078</span>                         lastEl = target;   <span style="color: #008000;">//</span><span style="color: #008000;">将拖拽的目标节点赋值给最后一个节点</span> <span style="color: #008080;">1079</span>                         lastCSS = _css(target); <span style="color: #008000;">//</span><span style="color: #008000;">获取最后目标节点的css全部属性</span> <span style="color: #008080;">1080</span>                         lastParentCSS = _css(target.parentNode);  <span style="color: #008000;">//</span><span style="color: #008000;">获取根节点的全部css属性</span> <span style="color: #008080;">1081</span> <span style="color: #000000;">                    }   </span><span style="color: #008080;">1082</span>  <span style="color: #008080;">1083</span>                         <span style="color: #008080;">1084</span>                       <span style="color: #008080;">1085</span>                          <span style="color: #808080;">///</span><span style="color: #008000;">left|right|inline/.test(str)  匹配str中只要含有left|right|inline 中的任何一个就可以为真</span> <span style="color: #008080;">1086</span>                          <span style="color: #008000;">//</span><span style="color: #008000;">floating 其实就是判断这里的拖拽节点是否已经有浮动，或者是inline也跟浮动差不多，或者是css3的flex-direction横向对其成一排的那个属性 </span><span style="color: #008080;">1087</span>                          <span style="color: #008000;">//</span><span style="color: #008000;">isWide：如果目标节点的宽大于拖拽节点的宽 </span><span style="color: #008080;">1088</span>                          <span style="color: #008000;">//</span><span style="color: #008000;">isLong:如果目标节点的高大于拖拽节点的高</span> <span style="color: #008080;">1089</span>                     <span style="color: #0000ff;">var</span> targetRect = target.getBoundingClientRect(), <span style="color: #008000;">//</span><span style="color: #008000;">目标节点的rect</span> <span style="color: #008080;">1090</span>                         width = targetRect.right - targetRect.left, <span style="color: #008000;">//</span><span style="color: #008000;">目标节点的宽</span> <span style="color: #008080;">1091</span>                         height = targetRect.bottom - targetRect.top, <span style="color: #008000;">//</span><span style="color: #008000;">目标节点的高 </span> <span style="color: #008080;">1092</span>                         floating = /left|right|inline|inlineBlock/.test(lastCSS.cssFloat +<span style="color: #000000;"> lastCSS.display) </span><span style="color: #008080;">1093</span>                                          || (lastParentCSS.display == <span style="color: #800000;">'</span><span style="color: #800000;">flex</span><span style="color: #800000;">'</span> &amp;&amp; lastParentCSS[<span style="color: #800000;">'</span><span style="color: #800000;">flex-direction</span><span style="color: #800000;">'</span>].indexOf(<span style="color: #800000;">'</span><span style="color: #800000;">row</span><span style="color: #800000;">'</span>) === <span style="color: #800080;">0</span><span style="color: #000000;">), </span><span style="color: #008080;">1094</span>                         isWide = (target.offsetWidth &gt; dragEl.offsetWidth),  <span style="color: #008000;">//</span><span style="color: #008000;">目标节点宽大于拖拽节点</span> <span style="color: #008080;">1095</span>                         isLong = (target.offsetHeight &gt; dragEl.offsetHeight),<span style="color: #008000;">//</span><span style="color: #008000;">目标节点高大于拖拽节点 </span><span style="color: #008080;">1096</span>                         <span style="color: #008000;">//</span><span style="color: #008000;">halfway 如果floating 浮动，inline，横向对齐 了就判断此时鼠标是在target中间的左边还是右边，右边则为true，否则false </span><span style="color: #008080;">1097</span>                         <span style="color: #008000;">//</span><span style="color: #008000;">halfway 如果floating 没有浮动，inline，横向对齐 就判断此时鼠标是在target中间的上面边还是下面，下边则为true，否则false</span> <span style="color: #008080;">1098</span>                         halfway = (floating ? <span style="color: #008080;">1099</span>                                                        (evt.clientX - targetRect.left) /<span style="color: #000000;"> width :    </span><span style="color: #008080;">1100</span>                                                        (evt.clientY - targetRect.top) /<span style="color: #000000;"> height </span><span style="color: #008080;">1101</span> <span style="color: #000000;">                                           )  </span><span style="color: #008080;">1102</span>                                            &gt; <span style="color: #800080;">0.5</span><span style="color: #000000;">, </span><span style="color: #008080;">1103</span>                         <span style="color: #008000;">//</span><span style="color: #008000;">    目标节点的下一个节点。           </span> <span style="color: #008080;">1104</span>                         nextSibling =<span style="color: #000000;"> target.nextElementSibling, </span><span style="color: #008080;">1105</span>                         <span style="color: #008000;">/*</span> <span style="color: #008080;">1106</span> <span style="color: #008000;">                      rootEl:拖拽根节点 </span><span style="color: #008080;">1107</span> <span style="color: #008000;">                      el:拖拽根节点 </span><span style="color: #008080;">1108</span> <span style="color: #008000;">                      dragEl:拖拽节点 </span><span style="color: #008080;">1109</span> <span style="color: #008000;">                      dragRect:拖拽几点的Rect </span><span style="color: #008080;">1110</span> <span style="color: #008000;">                      target:拖拽节点或者是根节点的最后一个子节点 </span><span style="color: #008080;">1111</span> <span style="color: #008000;">                      targetRect:target的Rect </span><span style="color: #008080;">1112</span>                     <span style="color: #008000;">*/</span> <span style="color: #008080;">1113</span>                      <span style="color: #008080;">1114</span>                         moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect), <span style="color: #008000;">//</span><span style="color: #008000;">空undefined</span> <span style="color: #008080;">1115</span>                         after  <span style="color: #008000;">//</span><span style="color: #008000;"> after true 往下拖拽, false 往上拖拽</span> <span style="color: #008080;">1116</span> <span style="color: #000000;">                    ; </span><span style="color: #008080;">1117</span>  <span style="color: #008080;">1118</span>                     <span style="color: #0000ff;">if</span> (moveVector !== <span style="color: #0000ff;">false</span><span style="color: #000000;">) { </span><span style="color: #008080;">1119</span>                                         _silent = <span style="color: #0000ff;">true</span><span style="color: #000000;">; </span><span style="color: #008080;">1120</span>                                         setTimeout(_unsilent, <span style="color: #800080;">30</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">30毫秒设置为假</span> <span style="color: #008080;">1121</span>                  <span style="color: #008080;">1122</span>                                         _cloneHide(isOwner); <span style="color: #008000;">//</span><span style="color: #008000;">隐藏克隆节点</span> <span style="color: #008080;">1123</span>                  <span style="color: #008080;">1124</span>                                         <span style="color: #0000ff;">if</span> (moveVector === <span style="color: #800080;">1</span> || moveVector === -<span style="color: #800080;">1</span>) {<span style="color: #008000;">//</span><span style="color: #008000;">空undefined</span> <span style="color: #008080;">1125</span>                                             after = (moveVector === <span style="color: #800080;">1</span><span style="color: #000000;">); </span><span style="color: #008080;">1126</span> <span style="color: #000000;">                                        } </span><span style="color: #008080;">1127</span>                                         <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (floating) { <span style="color: #008000;">//</span><span style="color: #008000;">如果浮动</span> <span style="color: #008080;">1128</span>                                       <span style="color: #008080;">1129</span>                                                                 <span style="color: #0000ff;">var</span> elTop = dragEl.offsetTop, <span style="color: #008000;">//</span><span style="color: #008000;">拖拽接点的top</span> <span style="color: #008080;">1130</span>                                                                       tgTop = target.offsetTop; <span style="color: #008000;">//</span><span style="color: #008000;">目标节点top</span> <span style="color: #008080;">1131</span>                                      <span style="color: #008080;">1132</span>                                                                 <span style="color: #0000ff;">if</span> (elTop === tgTop) { <span style="color: #008000;">//</span> <span style="color: #008000;">//</span><span style="color: #008000;">拖拽几点的top===目标节点top 说明他们是在同一列中 </span><span style="color: #008080;">1133</span>                                                              <span style="color: #008080;">1134</span>                                                              <span style="color: #008000;">//</span><span style="color: #008000;">target.previousElementSibling  如果目标节点的上一个节点是拖拽节点，这里就是他们上下节点互换位置,!isWide 目标节点宽小于拖拽节点 </span><span style="color: #008080;">1135</span>                                                              <span style="color: #008000;">//</span><span style="color: #008000;">或者  halfway 为真并且  isWide 目标节点宽大于拖拽节点 </span><span style="color: #008080;">1136</span>                                                              <span style="color: #008000;">// </span><span style="color: #008080;">1137</span>      <span style="color: #008080;">1138</span>                                                                        <span style="color: #008080;">1139</span>                                                                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">1140</span>                                                                      <span style="color: #008080;">1141</span>                                                                      <span style="color: #008000;">//</span><span style="color: #008000;">目标节点top大于&gt;拖拽接点的top </span> <span style="color: #008080;">1142</span>                                                                     after = tgTop &gt; elTop;  <span style="color: #008000;">//</span><span style="color: #008000;"> after true 往下拖拽 false 往上拖拽</span> <span style="color: #008080;">1143</span>                                                          <span style="color: #008080;">1144</span> <span style="color: #000000;">                                                                } </span><span style="color: #008080;">1145</span>                                         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">1146</span>                                             <span style="color: #008000;">//</span><span style="color: #008000;">没有浮动的时候 </span><span style="color: #008080;">1147</span>                                          <span style="color: #008000;">//</span><span style="color: #008000;">    目标节点的下一个节点。 </span><span style="color: #008080;">1148</span>                                     <span style="color: #008000;">//</span><span style="color: #008000;">     console.log('nextSibling !== dragEl'+(nextSibling !== dragEl));  </span><span style="color: #008000;">//</span><span style="color: #008000;">往下拖拽 </span><span style="color: #008080;">1149</span>                                          <span style="color: #008000;">//</span><span style="color: #008000;">dom节点是按照拖拽完之后排序做判断 </span><span style="color: #008080;">1150</span>                                          <span style="color: #008000;">//</span><span style="color: #008000;">(nextSibling !== dragEl) 不是往上拖拽的时候 则为真的时候 如果目标节点的高大于拖拽节点的高 </span><span style="color: #008080;">1151</span>                                          <span style="color: #008000;">//</span><span style="color: #008000;">halfway 为真的时候。如果目标节点的高大于拖拽节点的高after 为真</span> <span style="color: #008080;">1152</span>                                             after = (nextSibling !== dragEl) &amp;&amp; !isLong || halfway &amp;&amp;<span style="color: #000000;"> isLong; </span><span style="color: #008080;">1153</span> <span style="color: #000000;">                                        } </span><span style="color: #008080;">1154</span>  <span style="color: #008080;">1155</span>                                     <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">dragEl.contains(el)) { </span><span style="color: #008080;">1156</span>                                       <span style="color: #008080;">1157</span>                                          <span style="color: #0000ff;">if</span> (after &amp;&amp; !nextSibling) { <span style="color: #008000;">// </span><span style="color: #008080;">1158</span>                                          <span style="color: #008080;">1159</span>                                             el.appendChild(dragEl); <span style="color: #008000;">//</span><span style="color: #008000;">如果此时 目标的的下一个节点不存在那么直接把拖拽节点添加在后面即可</span> <span style="color: #008080;">1160</span>                                         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">1161</span>                                             <span style="color: #008000;">//</span><span style="color: #008000;">判断拖拽节点添加到哪个位置after真时候是往下拖拽则把拖拽节点添加到target下面。 </span><span style="color: #008080;">1162</span>                                             <span style="color: #008000;">//</span><span style="color: #008000;">判断拖拽节点添加到哪个位置after假时候是往下拖拽则把拖拽节点添加到target上面。</span> <span style="color: #008080;">1163</span>                                              target.parentNode.insertBefore(dragEl, after ?<span style="color: #000000;"> nextSibling : target); </span><span style="color: #008080;">1164</span> <span style="color: #000000;">                                        } </span><span style="color: #008080;">1165</span> <span style="color: #000000;">                                    } </span><span style="color: #008080;">1166</span>  <span style="color: #008080;">1167</span>                                 parentEl = dragEl.parentNode; <span style="color: #008000;">//</span><span style="color: #008000;"> actualization </span><span style="color: #008080;">1168</span>                                 <span style="color: #008000;">//</span><span style="color: #008000;">交换位置前的drgRect， 交换后位置的拖拽节点dragEl </span><span style="color: #008080;">1169</span>                                 <span style="color: #008000;">//</span><span style="color: #008000;">交换位置前的目标节点targetRect， 交换后位置的目标节点dragEl </span><span style="color: #008080;">1170</span>                                <span style="color: #008080;">1171</span>                                  <span style="color: #008000;">//</span><span style="color: #008000;">执行动画。css3动画</span> <span style="color: #008080;">1172</span>                               <span style="color: #0000ff;">this</span>._animate(dragRect, dragEl); <span style="color: #008000;">//</span><span style="color: #008000;">执行css3动画其实只是一种掩饰而已，真正的核心是他们交换dom节点的位置 </span><span style="color: #008080;">1173</span>                                   <span style="color: #008000;">//</span><span style="color: #008000;">执行动画。css3动画</span> <span style="color: #008080;">1174</span>                               <span style="color: #0000ff;">this</span><span style="color: #000000;">._animate(targetRect, target); </span><span style="color: #008080;">1175</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1176</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1177</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1178</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1179</span>   <span style="color: #008080;">1180</span>    <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1181</span> <span style="color: #008000;">         *函数名 ：_animate </span><span style="color: #008080;">1182</span> <span style="color: #008000;">         *函数功能描述 ：  动画效果，执行css3动画 </span><span style="color: #008080;">1183</span> <span style="color: #008000;">         *函数参数 ：  </span><span style="color: #008080;">1184</span> <span style="color: #008000;">                       prevRect：obj，初始动画的坐标， </span><span style="color: #008080;">1185</span> <span style="color: #008000;">                       target：obj，target 其实最重要是获取交换dom节点后的坐标 </span><span style="color: #008080;">1186</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;">1187</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;">1188</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1189</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1190</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1191</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1192</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1193</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1194</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1195</span> <span style="color: #000000;">          _animate: function (prevRect, target) { </span><span style="color: #008080;">1196</span>             <span style="color: #008000;">//</span><span style="color: #008000;">每次当目标节点与拖拽节点交替的时候就调用次改函数 </span><span style="color: #008080;">1197</span>              <span style="color: #008000;">//</span><span style="color: #008000;">i++; </span><span style="color: #008080;">1198</span>      <span style="color: #008080;">1199</span>      <span style="color: #008080;">1200</span>             <span style="color: #008000;">//</span><span style="color: #008000;">prevRect:  obj.getBoundingClientRect </span><span style="color: #008080;">1201</span>             <span style="color: #008000;">//</span><span style="color: #008000;">target:obj</span> <span style="color: #008080;">1202</span>             <span style="color: #0000ff;">var</span> ms = <span style="color: #0000ff;">this</span>.options.animation; <span style="color: #008000;">//</span><span style="color: #008000;">动画延迟</span> <span style="color: #008080;">1203</span>         <span style="color: #008080;">1204</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (ms) { </span><span style="color: #008080;">1205</span>                 <span style="color: #0000ff;">var</span> currentRect =<span style="color: #000000;"> target.getBoundingClientRect(); </span><span style="color: #008080;">1206</span>  <span style="color: #008080;">1207</span>         <span style="color: #008000;">//</span><span style="color: #008000;">debugger;</span> <span style="color: #008080;">1208</span>                 _css(target, <span style="color: #800000;">'</span><span style="color: #800000;">transition</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">1209</span>                 _css(target, <span style="color: #800000;">'</span><span style="color: #800000;">transform</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">translate3d(</span><span style="color: #800000;">'</span> <span style="color: #008080;">1210</span>                     + (prevRect.left - currentRect.left) + <span style="color: #800000;">'</span><span style="color: #800000;">px,</span><span style="color: #800000;">'</span> <span style="color: #008080;">1211</span>                     + (prevRect.top - currentRect.top) + <span style="color: #800000;">'</span><span style="color: #800000;">px,0)</span><span style="color: #800000;">'</span> <span style="color: #008080;">1212</span> <span style="color: #000000;">                ); </span><span style="color: #008080;">1213</span>  <span style="color: #008080;">1214</span>                 target.offsetWidth; <span style="color: #008000;">//</span><span style="color: #008000;"> repaint</span> <span style="color: #008080;">1215</span>  <span style="color: #008080;">1216</span>                 _css(target, <span style="color: #800000;">'</span><span style="color: #800000;">transition</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">all </span><span style="color: #800000;">'</span> + ms + <span style="color: #800000;">'</span><span style="color: #800000;">ms</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">1217</span>                 _css(target, <span style="color: #800000;">'</span><span style="color: #800000;">transform</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">translate3d(0,0,0)</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">1218</span>  <span style="color: #008080;">1219</span> <span style="color: #000000;">                clearTimeout(target.animated); </span><span style="color: #008080;">1220</span>                 target.animated =<span style="color: #000000;"> setTimeout(function () { </span><span style="color: #008080;">1221</span>                     _css(target, <span style="color: #800000;">'</span><span style="color: #800000;">transition</span><span style="color: #800000;">'</span>, <span style="color: #800000;">''</span><span style="color: #000000;">); </span><span style="color: #008080;">1222</span>                     _css(target, <span style="color: #800000;">'</span><span style="color: #800000;">transform</span><span style="color: #800000;">'</span>, <span style="color: #800000;">''</span><span style="color: #000000;">); </span><span style="color: #008080;">1223</span>                     target.animated = <span style="color: #0000ff;">false</span><span style="color: #000000;">; </span><span style="color: #008080;">1224</span> <span style="color: #000000;">                }, ms); </span><span style="color: #008080;">1225</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1226</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1227</span>    <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1228</span> <span style="color: #008000;">         *函数名 ：_offUpEvents </span><span style="color: #008080;">1229</span> <span style="color: #008000;">         *函数功能描述 ：  解绑文档上的拖拽函数 </span><span style="color: #008080;">1230</span> <span style="color: #008000;">         *函数参数 ：  viod </span><span style="color: #008080;">1231</span> <span style="color: #008000;">         *函数返回值 ：viod </span><span style="color: #008080;">1232</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;">1233</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1234</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1235</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1236</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1237</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1238</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1239</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1240</span>  <span style="color: #008080;">1241</span> <span style="color: #000000;">        _offUpEvents: function () { </span><span style="color: #008080;">1242</span>             <span style="color: #0000ff;">var</span> ownerDocument = <span style="color: #0000ff;">this</span><span style="color: #000000;">.el.ownerDocument; </span><span style="color: #008080;">1243</span>  <span style="color: #008080;">1244</span>             _off(document, <span style="color: #800000;">'</span><span style="color: #800000;">touchmove</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onTouchMove); <span style="color: #008000;">//</span><span style="color: #008000;">当文档上面document 发生触摸移动事件的时候解绑 _onTouchMove事件</span> <span style="color: #008080;">1245</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">mouseup</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onDrop); <span style="color: #008000;">//</span><span style="color: #008000;">当文档上面document 发生鼠标抬起事件的时候解绑 _onTouchMove事件</span> <span style="color: #008080;">1246</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchend</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onDrop); <span style="color: #008000;">//</span><span style="color: #008000;">当文档上面document 发生触摸结束事件的时候解绑 _onTouchMove事件 </span><span style="color: #008080;">1247</span>              <span style="color: #008080;">1248</span>             <span style="color: #008000;">//</span><span style="color: #008000;">当一些更高级别的事件发生的时候（如电话接入或者弹出信息）会取消当前的touch操作，即触发ontouchcancel。一般会在ontouchcancel时暂停游戏、存档等操作。</span> <span style="color: #008080;">1249</span>  <span style="color: #008080;">1250</span>             _off(ownerDocument, <span style="color: #800000;">'</span><span style="color: #800000;">touchcancel</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onDrop); <span style="color: #008000;">//</span><span style="color: #008000;">当文档发生手指划过结束的时候解绑_onDrop 事件</span> <span style="color: #008080;">1251</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1252</span> <span style="color: #008000;">//</span><span style="color: #008000;">Drop被拖拽的元素在目标元素上同时鼠标放开触发的事件，此事件作用在目标元素上</span> <span style="color: #008080;">1253</span>  <span style="color: #008080;">1254</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1255</span> <span style="color: #008000;">         *函数名 ：init </span><span style="color: #008080;">1256</span> <span style="color: #008000;">         *函数功能描述 ：  初始化作用 </span><span style="color: #008080;">1257</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1258</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;">1259</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;">1260</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1261</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1262</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1263</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1264</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1265</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1266</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1267</span>         _onDrop: function (<span style="color: #008000;">/*</span><span style="color: #008000;">*Event</span><span style="color: #008000;">*/</span><span style="color: #000000;">evt) { </span><span style="color: #008080;">1268</span>            <span style="color: #008000;">//</span><span style="color: #008000;">evt 事件对象</span> <span style="color: #008080;">1269</span>             <span style="color: #008080;">1270</span>             <span style="color: #0000ff;">var</span> el = <span style="color: #0000ff;">this</span>.el,     <span style="color: #008000;">//</span><span style="color: #008000;">拖拽的根节点</span> <span style="color: #008080;">1271</span>                 options = <span style="color: #0000ff;">this</span>.options;    <span style="color: #008000;">//</span><span style="color: #008000;">参数类</span> <span style="color: #008080;">1272</span>  <span style="color: #008080;">1273</span>             clearInterval(<span style="color: #0000ff;">this</span>._loopId);   <span style="color: #008000;">//</span><span style="color: #008000;">清除_loopId 定时器</span> <span style="color: #008080;">1274</span>             clearInterval(autoScroll.pid);<span style="color: #008000;">//</span><span style="color: #008000;">清除pid 定时器</span> <span style="color: #008080;">1275</span>             clearTimeout(<span style="color: #0000ff;">this</span>._dragStartTimer);<span style="color: #008000;">//</span><span style="color: #008000;">清除_dragStartTimer 定时器 </span><span style="color: #008080;">1276</span>  <span style="color: #008080;">1277</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Unbind events</span> <span style="color: #008080;">1278</span>             _off(document, <span style="color: #800000;">'</span><span style="color: #800000;">mousemove</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onTouchMove); <span style="color: #008000;">//</span><span style="color: #008000;">解除文档上面的鼠标移动事件函数为_onTouchMove</span> <span style="color: #008080;">1279</span>            <span style="color: #008000;">/*</span> <span style="color: #008080;">1280</span>            <span style="color: #008080;">1281</span> <span style="color: #008000;">    DataTransfer 对象：退拽对象用来传递的媒介，使用一般为Event.dataTransfer。 </span><span style="color: #008080;">1282</span> <span style="color: #008000;">    draggable 属性：就是标签元素要设置draggable=true，否则不会有效果，例如： </span><span style="color: #008080;">1283</span>  <span style="color: #008080;">1284</span> <span style="color: #008000;">    &lt;div title="拖拽我" draggable="true"&gt;列表1&lt;/div&gt; </span><span style="color: #008080;">1285</span>      <span style="color: #008080;">1286</span> <span style="color: #008000;">     ondragstart 事件：当拖拽元素开始被拖拽的时候触发的事件，此事件作用在被拖曳元素上 </span><span style="color: #008080;">1287</span> <span style="color: #008000;">    ondragenter 事件：当拖曳元素进入目标元素的时候触发的事件，此事件作用在目标元素上 </span><span style="color: #008080;">1288</span> <span style="color: #008000;">    ondragover 事件：拖拽元素在目标元素上移动的时候触发的事件，此事件作用在目标元素上 </span><span style="color: #008080;">1289</span> <span style="color: #008000;">    ondrop 事件：被拖拽的元素在目标元素上同时鼠标放开触发的事件，此事件作用在目标元素上 </span><span style="color: #008080;">1290</span> <span style="color: #008000;">    ondragend 事件：当拖拽完成后触发的事件，此事件作用在被拖曳元素上 </span><span style="color: #008080;">1291</span> <span style="color: #008000;">    Event.preventDefault() 方法：阻止默认的些事件方法等执行。在ondragover中一定要执行preventDefault()，否则ondrop事件不会被触发。另外，如果是从其他应用软件或是文件中拖东西进来，尤其是图片的时候，默认的动作是显示这个图片或是相关信息，并不是真的执行drop。此时需要用用document的ondragover事件把它直接干掉。 </span><span style="color: #008080;">1292</span> <span style="color: #008000;">    Event.effectAllowed 属性：就是拖拽的效果。 </span><span style="color: #008080;">1293</span> <span style="color: #008000;">如果nativeDraggable是true 那么 </span><span style="color: #008080;">1294</span>           <span style="color: #008000;">*/</span> <span style="color: #008080;">1295</span>             <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span><span style="color: #000000;">.nativeDraggable) { </span><span style="color: #008080;">1296</span>                 _off(document, <span style="color: #800000;">'</span><span style="color: #800000;">drop</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">解绑drop 事件 函数是handleEvent</span> <span style="color: #008080;">1297</span>                 _off(el, <span style="color: #800000;">'</span><span style="color: #800000;">dragstart</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onDragStart);   <span style="color: #008000;">//</span><span style="color: #008000;">解绑html5的拖拽dragstart事件  函数是 _onDragStart</span> <span style="color: #008080;">1298</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1299</span>            <span style="color: #008000;">//</span><span style="color: #008000;">解绑文档上面的一些事件</span> <span style="color: #008080;">1300</span>             <span style="color: #0000ff;">this</span><span style="color: #000000;">._offUpEvents(); </span><span style="color: #008080;">1301</span>  <span style="color: #008080;">1302</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (evt) { </span><span style="color: #008080;">1303</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (moved) { </span><span style="color: #008080;">1304</span>                     evt.preventDefault(); <span style="color: #008000;">//</span><span style="color: #008000;">阻止默认事件</span> <span style="color: #008080;">1305</span>                     !options.dropBubble &amp;&amp; evt.stopPropagation(); <span style="color: #008000;">//</span><span style="color: #008000;">阻止事件冒泡</span> <span style="color: #008080;">1306</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1307</span>             <span style="color: #008000;">//</span><span style="color: #008000;">ghostEl 在736行时候才会创建该节点，所以在736行调用_onDrop函数的时候都是为空 </span><span style="color: #008080;">1308</span>             <span style="color: #008000;">//</span><span style="color: #008000;">如果拖拽的镜像对象存在那么他就添加在拖拽的根节点</span> <span style="color: #008080;">1309</span>                 ghostEl &amp;&amp;<span style="color: #000000;"> ghostEl.parentNode.removeChild(ghostEl); </span><span style="color: #008080;">1310</span>  <span style="color: #008080;">1311</span>   <span style="color: #008080;">1312</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (dragEl) { </span><span style="color: #008080;">1313</span>                     <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span><span style="color: #000000;">.nativeDraggable) { </span><span style="color: #008080;">1314</span>                         <span style="color: #008000;">//</span><span style="color: #008000;">如果拖拽节点存在了 就解绑this 的 handleEvent 事件</span> <span style="color: #008080;">1315</span>                         _off(dragEl, <span style="color: #800000;">'</span><span style="color: #800000;">dragend</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span><span style="color: #000000;">); </span><span style="color: #008080;">1316</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1317</span>                <span style="color: #008000;">//</span><span style="color: #008000;">禁用拖拽html5 属性</span> <span style="color: #008080;">1318</span> <span style="color: #000000;">                    _disableDraggable(dragEl); </span><span style="color: #008080;">1319</span>  <span style="color: #008080;">1320</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> Remove class's  </span><span style="color: #008000;">//</span><span style="color: #008000;">删除css</span> <span style="color: #008080;">1321</span>                     _toggleClass(dragEl, <span style="color: #0000ff;">this</span>.options.ghostClass, <span style="color: #0000ff;">false</span><span style="color: #000000;">); </span><span style="color: #008080;">1322</span>                     _toggleClass(dragEl, <span style="color: #0000ff;">this</span>.options.chosenClass, <span style="color: #0000ff;">false</span><span style="color: #000000;">); </span><span style="color: #008080;">1323</span>   <span style="color: #008080;">1324</span>                     <span style="color: #0000ff;">if</span> (rootEl !== parentEl) {  <span style="color: #008000;">//</span><span style="color: #008000;">如果从一个列表拖拽到另一个列表的时候 </span><span style="color: #008080;">1325</span>                         <span style="color: #008000;">//</span><span style="color: #008000;">返回当前的索引</span> <span style="color: #008080;">1326</span>                         newIndex =<span style="color: #000000;"> _index(dragEl, options.draggable); </span><span style="color: #008080;">1327</span>          <span style="color: #008080;">1328</span>                                 <span style="color: #0000ff;">if</span> (newIndex &gt;= <span style="color: #800080;">0</span>) {  <span style="color: #008000;">//</span><span style="color: #008000;">如果当前的索引大于0 </span><span style="color: #008080;">1329</span>                                     <span style="color: #008000;">//</span><span style="color: #008000;"> drag from one list and drop into another   </span><span style="color: #008000;">//</span><span style="color: #008000;">从类表中拖拽到另一个列表 </span><span style="color: #008080;">1330</span>                                  <span style="color: #008000;">//</span><span style="color: #008000;">事件接口</span> <span style="color: #008080;">1331</span>                                     _dispatchEvent(<span style="color: #0000ff;">null</span>, parentEl, <span style="color: #800000;">'</span><span style="color: #800000;">sort</span><span style="color: #800000;">'</span>, dragEl, rootEl, oldIndex, newIndex); <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽函数创建与触发</span> <span style="color: #008080;">1332</span>                                      <span style="color: #008080;">1333</span>                                     _dispatchEvent(<span style="color: #0000ff;">this</span>, rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">sort</span><span style="color: #800000;">'</span>, dragEl, rootEl, oldIndex, newIndex);<span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽函数创建与触发 </span><span style="color: #008080;">1334</span>          <span style="color: #008080;">1335</span>                                     <span style="color: #008000;">//</span><span style="color: #008000;"> Add event</span> <span style="color: #008080;">1336</span>                                     _dispatchEvent(<span style="color: #0000ff;">null</span>, parentEl, <span style="color: #800000;">'</span><span style="color: #800000;">add</span><span style="color: #800000;">'</span>, dragEl, rootEl, oldIndex, newIndex);<span style="color: #008000;">//</span><span style="color: #008000;">添加节点拖拽函数创建与触发 </span><span style="color: #008080;">1337</span>          <span style="color: #008080;">1338</span>                                     <span style="color: #008000;">//</span><span style="color: #008000;"> Remove event</span><span style="color: #008000;">//</span><span style="color: #008000;">删除节点拖拽函数创建与触发</span> <span style="color: #008080;">1339</span>                                     _dispatchEvent(<span style="color: #0000ff;">this</span>, rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">remove</span><span style="color: #800000;">'</span><span style="color: #000000;">, dragEl, rootEl, oldIndex, newIndex); </span><span style="color: #008080;">1340</span> <span style="color: #000000;">                                } </span><span style="color: #008080;">1341</span>                                <span style="color: #008080;">1342</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1343</span>                     <span style="color: #0000ff;">else</span> {  <span style="color: #008000;">//</span><span style="color: #008000;">同一个列表中 </span><span style="color: #008080;">1344</span>                         <span style="color: #008000;">//</span><span style="color: #008000;"> Remove clone</span> <span style="color: #008080;">1345</span>                         cloneEl &amp;&amp;<span style="color: #000000;"> cloneEl.parentNode.removeChild(cloneEl); </span><span style="color: #008080;">1346</span>  <span style="color: #008080;">1347</span>                         <span style="color: #0000ff;">if</span> (dragEl.nextSibling !==<span style="color: #000000;"> nextEl) { </span><span style="color: #008080;">1348</span>                             <span style="color: #008000;">//</span><span style="color: #008000;"> Get the index of the dragged element within its parent</span> <span style="color: #008080;">1349</span>                             newIndex =<span style="color: #000000;"> _index(dragEl, options.draggable); </span><span style="color: #008080;">1350</span>  <span style="color: #008080;">1351</span>                             <span style="color: #0000ff;">if</span> (newIndex &gt;= <span style="color: #800080;">0</span><span style="color: #000000;">) { </span><span style="color: #008080;">1352</span>                               <span style="color: #008080;">1353</span>                                   <span style="color: #008080;">1354</span>                                 <span style="color: #008000;">//</span><span style="color: #008000;"> drag &amp; drop within the same list  </span><span style="color: #008000;">//</span><span style="color: #008000;">update拖拽更新新数据</span> <span style="color: #008080;">1355</span>                                 _dispatchEvent(<span style="color: #0000ff;">this</span>, rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">update</span><span style="color: #800000;">'</span><span style="color: #000000;">, dragEl, rootEl, oldIndex, newIndex); </span><span style="color: #008080;">1356</span>                                 _dispatchEvent(<span style="color: #0000ff;">this</span>, rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">sort</span><span style="color: #800000;">'</span><span style="color: #000000;">, dragEl, rootEl, oldIndex, newIndex); </span><span style="color: #008080;">1357</span> <span style="color: #000000;">                            } </span><span style="color: #008080;">1358</span> <span style="color: #000000;">                        } </span><span style="color: #008080;">1359</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1360</span>  <span style="color: #008080;">1361</span>                     <span style="color: #0000ff;">if</span> (Sortable.active) {  <span style="color: #008000;">//</span><span style="color: #008000;">Sortable.active 存在说明已经拖拽开始了</span> <span style="color: #008080;">1362</span>                         <span style="color: #008000;">/*</span><span style="color: #008000;"> jshint eqnull:true </span><span style="color: #008000;">*/</span> <span style="color: #008080;">1363</span>                         <span style="color: #0000ff;">if</span> (newIndex == <span style="color: #0000ff;">null</span> || newIndex === -<span style="color: #800080;">1</span>) {<span style="color: #008000;">//</span><span style="color: #008000;">newIndex 这个条件成立的时候是拖拽第一个节点并且没有更换拖拽位置</span> <span style="color: #008080;">1364</span>                             newIndex =<span style="color: #000000;"> oldIndex; </span><span style="color: #008080;">1365</span> <span style="color: #000000;">                        } </span><span style="color: #008080;">1366</span>                           <span style="color: #008000;">//</span><span style="color: #008000;">拖拽结束   </span> <span style="color: #008080;">1367</span>                         _dispatchEvent(<span style="color: #0000ff;">this</span>, rootEl, <span style="color: #800000;">'</span><span style="color: #800000;">end</span><span style="color: #800000;">'</span><span style="color: #000000;">, dragEl, rootEl, oldIndex, newIndex); </span><span style="color: #008080;">1368</span>  <span style="color: #008080;">1369</span>                         <span style="color: #008000;">//</span><span style="color: #008000;"> Save sorting  </span><span style="color: #008000;">//</span><span style="color: #008000;">保存排序</span> <span style="color: #008080;">1370</span>                         <span style="color: #0000ff;">this</span><span style="color: #000000;">.save(); </span><span style="color: #008080;">1371</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">1372</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1373</span>  <span style="color: #008080;">1374</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1375</span>           <span style="color: #008000;">//</span><span style="color: #008000;">重新初始化参数</span> <span style="color: #008080;">1376</span>             <span style="color: #0000ff;">this</span><span style="color: #000000;">._nulling(); </span><span style="color: #008080;">1377</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1378</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1379</span> <span style="color: #008000;">         *函数名 ：_nulling </span><span style="color: #008080;">1380</span> <span style="color: #008000;">         *函数功能描述 ：  初始化拖拽的数据 </span><span style="color: #008080;">1381</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1382</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;">1383</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1384</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1385</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1386</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1387</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1388</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1389</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1390</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1391</span> <span style="color: #000000;">        _nulling: function () { </span><span style="color: #008080;">1392</span>             <span style="color: #0000ff;">if</span> (Sortable.active === <span style="color: #0000ff;">this</span><span style="color: #000000;">) { </span><span style="color: #008080;">1393</span>                 rootEl =   <span style="color: #008000;">//</span><span style="color: #008000;">鼠标按下去拖拽节点的根节点</span> <span style="color: #008080;">1394</span>                 dragEl =  <span style="color: #008000;">//</span><span style="color: #008000;">鼠标按下去拖拽节点 </span> <span style="color: #008080;">1395</span>                 parentEl =  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽的父节点 鼠标拖拽 发生ondragover 事件 拖拽节点放到目标节点的时候发生事件 的根节点 父节点，也有可能是鼠标按下去拖拽的根节点</span> <span style="color: #008080;">1396</span>                 ghostEl = <span style="color: #008000;">//</span><span style="color: #008000;"> 拖拽镜像</span> <span style="color: #008080;">1397</span>                 nextEl =  <span style="color: #008000;">//</span><span style="color: #008000;">下一个节点</span> <span style="color: #008080;">1398</span>                 cloneEl = <span style="color: #008000;">//</span><span style="color: #008000;">拖拽克隆节点</span> <span style="color: #008080;">1399</span>  <span style="color: #008080;">1400</span>                 scrollEl = <span style="color: #008000;">//</span><span style="color: #008000;">滚动节点</span> <span style="color: #008080;">1401</span>                 scrollParentEl = <span style="color: #008000;">//</span><span style="color: #008000;">滚动的父节点</span> <span style="color: #008080;">1402</span>  <span style="color: #008080;">1403</span>                 tapEvt = <span style="color: #008000;">//</span><span style="color: #008000;">tapEvt 触摸对象包括x与y轴与拖拽当前节点</span> <span style="color: #008080;">1404</span>                 touchEvt =  <span style="color: #008000;">//</span><span style="color: #008000;">触摸事件对象</span> <span style="color: #008080;">1405</span>  <span style="color: #008080;">1406</span>                 moved =  <span style="color: #008000;">//</span><span style="color: #008000;">布尔值</span> <span style="color: #008080;">1407</span>                 newIndex =  <span style="color: #008000;">//</span><span style="color: #008000;">拖拽的现在索引</span> <span style="color: #008080;">1408</span>  <span style="color: #008080;">1409</span>                 lastEl = <span style="color: #008000;">//</span><span style="color: #008000;">拖拽根节点中的最后一个子节点</span> <span style="color: #008080;">1410</span>                 lastCSS = <span style="color: #008000;">//</span><span style="color: #008000;">拖拽根节点中的最后一个子节点class</span> <span style="color: #008080;">1411</span>  <span style="color: #008080;">1412</span>                 activeGroup = <span style="color: #008000;">//</span><span style="color: #008000;">options.group</span> <span style="color: #008080;">1413</span>                 Sortable.active = <span style="color: #0000ff;">null</span><span style="color: #000000;">; </span><span style="color: #008080;">1414</span>                  <span style="color: #008080;">1415</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1416</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1417</span>          <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1418</span> <span style="color: #008000;">         *函数名 ：handleEvent </span><span style="color: #008080;">1419</span> <span style="color: #008000;">         *函数功能描述 ：  为事件绑定this的时候提供该事件，判断是否在拖拽还是拖拽结束，调用对应的函数 </span><span style="color: #008080;">1420</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1421</span> <span style="color: #008000;">                       evt: </span><span style="color: #008080;">1422</span> <span style="color: #008000;">                             类型：object，事件类型 拖拽的事件类型 </span><span style="color: #008080;">1423</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;">1424</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;">1425</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1426</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1427</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1428</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1429</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1430</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1431</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1432</span>         handleEvent: function (<span style="color: #008000;">/*</span><span style="color: #008000;">*Event</span><span style="color: #008000;">*/</span>evt) {<span style="color: #008000;">//</span><span style="color: #008000;">handleEvent 是该事件绑定这个对象的时候则发生这里的事件，则事件绑定给Sortable 的时候则发生这里的事件</span> <span style="color: #008080;">1433</span>              <span style="color: #0000ff;">var</span> type =<span style="color: #000000;"> evt.type; </span><span style="color: #008080;">1434</span>             <span style="color: #008000;">//</span><span style="color: #008000;">dragover 在拖拽区域移动拖拽时候发生事件相当于move </span><span style="color: #008080;">1435</span>             <span style="color: #008000;">//</span><span style="color: #008000;">dragenter 元素放入到拖拽的区域中相当于 over</span> <span style="color: #008080;">1436</span>             <span style="color: #0000ff;">if</span> (type === <span style="color: #800000;">'</span><span style="color: #800000;">dragover</span><span style="color: #800000;">'</span> || type === <span style="color: #800000;">'</span><span style="color: #800000;">dragenter</span><span style="color: #800000;">'</span>) {   <span style="color: #008000;">//</span><span style="color: #008000;">事件正在拖拽的时候 </span> <span style="color: #008080;">1437</span>                       <span style="color: #008080;">1438</span>                <span style="color: #008080;">1439</span>                         <span style="color: #0000ff;">if</span> (dragEl) { <span style="color: #008000;">//</span><span style="color: #008000;">在300行的时候调用dragover与dragenter事件，这个时候dragEl是处于声明而已但是没有赋值所以是undefined， 如果dragEl 存在则是真正拖拽的时候，dragEl是拖拽镜像</span> <span style="color: #008080;">1440</span>                             <span style="color: #0000ff;">this</span><span style="color: #000000;">._onDragOver(evt); </span><span style="color: #008080;">1441</span> <span style="color: #000000;">                            _globalDragOver(evt); </span><span style="color: #008080;">1442</span> <span style="color: #000000;">                        } </span><span style="color: #008080;">1443</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1444</span>             <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (type === <span style="color: #800000;">'</span><span style="color: #800000;">drop</span><span style="color: #800000;">'</span> || type === <span style="color: #800000;">'</span><span style="color: #800000;">dragend</span><span style="color: #800000;">'</span>) { <span style="color: #008000;">//</span><span style="color: #008000;">拖拽事件结束的时候</span> <span style="color: #008080;">1445</span>                         <span style="color: #0000ff;">this</span><span style="color: #000000;">._onDrop(evt); </span><span style="color: #008080;">1446</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1447</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1448</span>  <span style="color: #008080;">1449</span>  <span style="color: #008080;">1450</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">1451</span> <span style="color: #008000;">         * Serializes the item into an array of string. </span><span style="color: #008080;">1452</span> <span style="color: #008000;">         * @returns {String[]} </span><span style="color: #008080;">1453</span>          <span style="color: #008000;">*/</span> <span style="color: #008080;">1454</span>          <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1455</span> <span style="color: #008000;">         *函数名 ：toArray </span><span style="color: #008080;">1456</span>                           <span style="color: #008080;">1457</span> <span style="color: #008000;">         *函数功能描述 ：  获取dom节点的  data-id 的属性 如果没有则 会调用_generateId函数生成唯一表示符  </span><span style="color: #008080;">1458</span> <span style="color: #008000;">         *函数参数 ：  viod  </span><span style="color: #008080;">1459</span> <span style="color: #008000;">         *函数返回值 ： 类型：array 生成唯一标识符的id数组 </span><span style="color: #008080;">1460</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;">1461</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1462</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1463</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1464</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1465</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1466</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1467</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1468</span> <span style="color: #000000;">        toArray: function () { </span><span style="color: #008080;">1469</span>             <span style="color: #0000ff;">var</span> order =<span style="color: #000000;"> [], </span><span style="color: #008080;">1470</span> <span style="color: #000000;">                el, </span><span style="color: #008080;">1471</span>                 children = <span style="color: #0000ff;">this</span>.el.children,  <span style="color: #008000;">//</span><span style="color: #008000;">获取所有子节点</span> <span style="color: #008080;">1472</span>                 i = <span style="color: #800080;">0</span><span style="color: #000000;">, </span><span style="color: #008080;">1473</span>                 n = children.length,  <span style="color: #008000;">//</span><span style="color: #008000;">获取子节点的长度</span> <span style="color: #008080;">1474</span>                 options = <span style="color: #0000ff;">this</span><span style="color: #000000;">.options; </span><span style="color: #008080;">1475</span>  <span style="color: #008080;">1476</span>  <span style="color: #008080;">1477</span>             <span style="color: #0000ff;">for</span> (; i &lt; n; i++<span style="color: #000000;">) { </span><span style="color: #008080;">1478</span>                 el =<span style="color: #000000;"> children[i]; </span><span style="color: #008080;">1479</span>                   <span style="color: #0000ff;">if</span> (_closest(el, options.draggable, <span style="color: #0000ff;">this</span><span style="color: #000000;">.el)) { </span><span style="color: #008080;">1480</span>                           <span style="color: #008000;">//</span><span style="color: #008000;">getAttribute获取  data-id 的属性 </span><span style="color: #008080;">1481</span>                           <span style="color: #008000;">//</span><span style="color: #008000;">order.push 如果没有data-id 属性获取不到值，则会调用_generateId函数生成唯一表示符</span> <span style="color: #008080;">1482</span>                     order.push(el.getAttribute(options.dataIdAttr) ||<span style="color: #000000;"> _generateId(el)); </span><span style="color: #008080;">1483</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1484</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1485</span>             <span style="color: #008000;">//</span><span style="color: #008000;">返回唯一标识符id 数组 类型</span> <span style="color: #008080;">1486</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> order; </span><span style="color: #008080;">1487</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1488</span>  <span style="color: #008080;">1489</span>  <span style="color: #008080;">1490</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">1491</span> <span style="color: #008000;">         * Sorts the elements according to the array. </span><span style="color: #008080;">1492</span> <span style="color: #008000;">         * @param  {String[]}  order  order of the items </span><span style="color: #008080;">1493</span>          <span style="color: #008000;">*/</span> <span style="color: #008080;">1494</span>           <span style="color: #008080;">1495</span>           <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1496</span> <span style="color: #008000;">         *函数名 ：sort </span><span style="color: #008080;">1497</span>                           <span style="color: #008080;">1498</span> <span style="color: #008000;">         *函数功能描述 ：   删除含有这个id的子节点 删除他 让他重新排序， 从栈底部插入数据 </span><span style="color: #008080;">1499</span> <span style="color: #008000;">         *函数参数 ：  order： </span><span style="color: #008080;">1500</span> <span style="color: #008000;">                                         类型：array， 数组id </span><span style="color: #008080;">1501</span>            <span style="color: #008080;">1502</span> <span style="color: #008000;">         *函数返回值 ： void </span><span style="color: #008080;">1503</span> <span style="color: #008000;">         *作者 ：   </span><span style="color: #008080;">1504</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1505</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1506</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1507</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1508</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1509</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1510</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1511</span> <span style="color: #000000;">        sort: function   (order) { </span><span style="color: #008080;">1512</span> <span style="color: #000000;">            debugger; </span><span style="color: #008080;">1513</span>             <span style="color: #008000;">//</span><span style="color: #008000;">order 数组</span> <span style="color: #008080;">1514</span>             <span style="color: #0000ff;">var</span> items =<span style="color: #000000;"> {}, </span><span style="color: #008080;">1515</span>                   rootEl = <span style="color: #0000ff;">this</span>.el;  <span style="color: #008000;">//</span><span style="color: #008000;">鼠标开始拖拽的根节点</span> <span style="color: #008080;">1516</span>                    <span style="color: #008080;">1517</span>  <span style="color: #008080;">1518</span>             <span style="color: #0000ff;">this</span>.toArray().forEach(function (id, i) { <span style="color: #008000;">//</span><span style="color: #008000;">遍历this.toArray() 数组中的id</span> <span style="color: #008080;">1519</span>                 <span style="color: #0000ff;">var</span> el =<span style="color: #000000;"> rootEl.children[i]; </span><span style="color: #008080;">1520</span>          <span style="color: #008080;">1521</span>                  <span style="color: #0000ff;">if</span> (_closest(el, <span style="color: #0000ff;">this</span><span style="color: #000000;">.options.draggable, rootEl)) { </span><span style="color: #008080;">1522</span>                     items[id] = el;  <span style="color: #008000;">//</span><span style="color: #008000;">遍历数组中的id 赋值给一个对象</span> <span style="color: #008080;">1523</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1524</span>             }, <span style="color: #0000ff;">this</span><span style="color: #000000;">); </span><span style="color: #008080;">1525</span>  <span style="color: #008080;">1526</span> <span style="color: #000000;">            order.forEach(function (id) { </span><span style="color: #008080;">1527</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (items[id]) { </span><span style="color: #008080;">1528</span>                     rootEl.removeChild(items[id]);  <span style="color: #008000;">//</span><span style="color: #008000;">删除含有这个id的子节点 删除他 让他重新排序，</span> <span style="color: #008080;">1529</span>                     rootEl.appendChild(items[id]);<span style="color: #008000;">//</span><span style="color: #008000;">删除含有这个id的子节点 删除他 让他重新排序， 从栈底部插入数据</span> <span style="color: #008080;">1530</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1531</span> <span style="color: #000000;">            }); </span><span style="color: #008080;">1532</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1533</span>  <span style="color: #008080;">1534</span>  <span style="color: #008080;">1535</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">1536</span> <span style="color: #008000;">         * Save the current sorting </span><span style="color: #008080;">1537</span> <span style="color: #008000;">          保存排序 </span><span style="color: #008080;">1538</span>          <span style="color: #008000;">*/</span> <span style="color: #008080;">1539</span> <span style="color: #000000;">        save: function () {  </span><span style="color: #008080;">1540</span>             <span style="color: #0000ff;">var</span> store = <span style="color: #0000ff;">this</span><span style="color: #000000;">.options.store; </span><span style="color: #008080;">1541</span>             store &amp;&amp; store.<span style="color: #0000ff;">set</span>(<span style="color: #0000ff;">this</span><span style="color: #000000;">); </span><span style="color: #008080;">1542</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1543</span>  <span style="color: #008080;">1544</span>  <span style="color: #008080;">1545</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">1546</span> <span style="color: #008000;">         * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree. </span><span style="color: #008080;">1547</span> <span style="color: #008000;">         * @param   {HTMLElement}  el </span><span style="color: #008080;">1548</span> <span style="color: #008000;">         * @param   {String}       [selector]  default: `options.draggable` </span><span style="color: #008080;">1549</span> <span style="color: #008000;">         * @returns {HTMLElement|null} </span><span style="color: #008080;">1550</span>          <span style="color: #008000;">*/</span> <span style="color: #008080;">1551</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1552</span> <span style="color: #008000;">         *函数名 ：_closest </span><span style="color: #008080;">1553</span> <span style="color: #008000;">         *函数功能描述 ： 用来调节节点，匹配节点。匹配calss。  匹配触发dom该函数的dom节点中的tag或者class，selector参数可以是tag或者class或者&gt;*， </span><span style="color: #008080;">1554</span> <span style="color: #008000;">         如果是&gt;* 并且当前的父节点和ctx 参数相同 则不需要匹配直接返回el，如果是tag或者class则匹配。 </span><span style="color: #008080;">1555</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1556</span> <span style="color: #008000;">                          el： </span><span style="color: #008080;">1557</span> <span style="color: #008000;">                                        类型:obj，拖拽节点dom </span><span style="color: #008080;">1558</span> <span style="color: #008000;">                          selector： </span><span style="color: #008080;">1559</span> <span style="color: #008000;">                                        类型：字符串，如果selector是'li' : '&gt;*'则返回是改节点dom，还有如果selector是和当前拖拽节点的name相同则也返回改节点dom，还有匹配触发该函数的el中的class是否是和参数中selector相同，相同则返回true，否则返回null </span><span style="color: #008080;">1560</span>                                          <span style="color: #008080;">1561</span> <span style="color: #008000;">          *函数返回值 ：dom和null </span><span style="color: #008080;">1562</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1563</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1564</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1565</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1566</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1567</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1568</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1569</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1570</span> <span style="color: #000000;">        closest: function (el, selector) { </span><span style="color: #008080;">1571</span>               <span style="color: #008080;">1572</span>             <span style="color: #0000ff;">return</span> _closest(el, selector || <span style="color: #0000ff;">this</span>.options.draggable, <span style="color: #0000ff;">this</span><span style="color: #000000;">.el); </span><span style="color: #008080;">1573</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1574</span>  <span style="color: #008080;">1575</span>  <span style="color: #008080;">1576</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">1577</span> <span style="color: #008000;">         * Set/get option </span><span style="color: #008080;">1578</span> <span style="color: #008000;">         * @param   {string} name </span><span style="color: #008080;">1579</span> <span style="color: #008000;">         * @param   {*}      [value] </span><span style="color: #008080;">1580</span> <span style="color: #008000;">         * @returns {*} </span><span style="color: #008080;">1581</span>          <span style="color: #008000;">*/</span> <span style="color: #008080;">1582</span>            <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1583</span> <span style="color: #008000;">         *函数名 ：option </span><span style="color: #008080;">1584</span> <span style="color: #008000;">         *函数功能描述 ：  获取option对象中的某个参数，或者设置option对象中的某个参数 </span><span style="color: #008080;">1585</span>            <span style="color: #008080;">1586</span> <span style="color: #008000;">         *函数参数 ：name： </span><span style="color: #008080;">1587</span> <span style="color: #008000;">                                        类型：string， option的key， </span><span style="color: #008080;">1588</span>                                        <span style="color: #008080;">1589</span> <span style="color: #008000;">                      value：类型：string， 设置option的值 </span><span style="color: #008080;">1590</span>                                          <span style="color: #008080;">1591</span> <span style="color: #008000;">          *函数返回值 ： viod </span><span style="color: #008080;">1592</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1593</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1594</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1595</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1596</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1597</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1598</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1599</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1600</span>          <span style="color: #008080;">1601</span> <span style="color: #000000;">        option: function (name, value) { </span><span style="color: #008080;">1602</span>             <span style="color: #0000ff;">var</span> options = <span style="color: #0000ff;">this</span><span style="color: #000000;">.options; </span><span style="color: #008080;">1603</span>  <span style="color: #008080;">1604</span>             <span style="color: #0000ff;">if</span> (value === <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span>) { <span style="color: #008000;">//</span><span style="color: #008000;">当没有传递第二个参数的时候 则返回该options参数的某个值</span> <span style="color: #008080;">1605</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> options[name]; </span><span style="color: #008080;">1606</span>             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">1607</span>                 options[name] = value;<span style="color: #008000;">//</span><span style="color: #008000;"> 设置options参数的某个值  </span> <span style="color: #008080;">1608</span>  <span style="color: #008080;">1609</span>                 <span style="color: #0000ff;">if</span> (name === <span style="color: #800000;">'</span><span style="color: #800000;">group</span><span style="color: #800000;">'</span>) { <span style="color: #008000;">//</span><span style="color: #008000;"> 如果name 是group 则在后面添加['pull', 'put']属性</span> <span style="color: #008080;">1610</span> <span style="color: #000000;">                    _prepareGroup(options); </span><span style="color: #008080;">1611</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1612</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1613</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">1614</span>  <span style="color: #008080;">1615</span>  <span style="color: #008080;">1616</span>         <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">1617</span> <span style="color: #008000;">         * Destroy 破坏 </span><span style="color: #008080;">1618</span>          <span style="color: #008000;">*/</span> <span style="color: #008080;">1619</span>             <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1620</span> <span style="color: #008000;">         *函数名 ：destroy </span><span style="color: #008080;">1621</span> <span style="color: #008000;">         *函数功能描述 ：    清空拖拽事件，和情况拖拽列表dom节点，销毁拖拽 。 </span><span style="color: #008080;">1622</span>            <span style="color: #008080;">1623</span> <span style="color: #008000;">         *函数参数  viod </span><span style="color: #008080;">1624</span> <span style="color: #008000;">          *函数返回值 ： viod </span><span style="color: #008080;">1625</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1626</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1627</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1628</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1629</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1630</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1631</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1632</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1633</span> <span style="color: #000000;">        destroy: function () { </span><span style="color: #008080;">1634</span>             <span style="color: #0000ff;">var</span> el = <span style="color: #0000ff;">this</span><span style="color: #000000;">.el; </span><span style="color: #008080;">1635</span>  <span style="color: #008080;">1636</span>             el[expando] = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;">把每一个时间戳的Sortable 的对象置为空</span> <span style="color: #008080;">1637</span>  <span style="color: #008080;">1638</span>             _off(el, <span style="color: #800000;">'</span><span style="color: #800000;">mousedown</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onTapStart);  <span style="color: #008000;">//</span><span style="color: #008000;"> 解绑拖拽类表中的mousedown事件_onTapStart函数</span> <span style="color: #008080;">1639</span>             _off(el, <span style="color: #800000;">'</span><span style="color: #800000;">touchstart</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>._onTapStart); <span style="color: #008000;">//</span><span style="color: #008000;"> 解绑拖拽类表中的touchstart事件_onTapStart函数</span> <span style="color: #008080;">1640</span>  <span style="color: #008080;">1641</span>             <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span><span style="color: #000000;">.nativeDraggable) { </span><span style="color: #008080;">1642</span>                 _off(el, <span style="color: #800000;">'</span><span style="color: #800000;">dragover</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>);  <span style="color: #008000;">//</span><span style="color: #008000;"> 解绑拖拽类表中的dragover事件handleEvent函数 </span> <span style="color: #008080;">1643</span>                 _off(el, <span style="color: #800000;">'</span><span style="color: #800000;">dragenter</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">this</span>);<span style="color: #008000;">//</span><span style="color: #008000;"> 解绑拖拽类表中的dragover事件handleEvent函数</span> <span style="color: #008080;">1644</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1645</span>  <span style="color: #008080;">1646</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Remove draggable attributes </span><span style="color: #008080;">1647</span>             <span style="color: #008000;">//</span><span style="color: #008000;">把页面上所有含有draggable 属性的dom节点 全部删除该属性，让它不能拖拽</span> <span style="color: #008080;">1648</span>             Array.prototype.forEach.call(el.querySelectorAll(<span style="color: #800000;">'</span><span style="color: #800000;">[draggable]</span><span style="color: #800000;">'</span><span style="color: #000000;">), function (el) { </span><span style="color: #008080;">1649</span>                 el.removeAttribute(<span style="color: #800000;">'</span><span style="color: #800000;">draggable</span><span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">1650</span> <span style="color: #000000;">            }); </span><span style="color: #008080;">1651</span>        <span style="color: #008000;">//</span><span style="color: #008000;">删除touchDragOverListeners 触摸列表事件_onDragOver</span> <span style="color: #008080;">1652</span>             touchDragOverListeners.splice(touchDragOverListeners.indexOf(<span style="color: #0000ff;">this</span>._onDragOver), <span style="color: #800080;">1</span><span style="color: #000000;">); </span><span style="color: #008080;">1653</span>  <span style="color: #008080;">1654</span>             <span style="color: #0000ff;">this</span>._onDrop(); <span style="color: #008000;">//</span><span style="color: #008000;">重新初始化</span> <span style="color: #008080;">1655</span>  <span style="color: #008080;">1656</span>             <span style="color: #0000ff;">this</span>.el = el = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;">把拖拽列表的dom节点清空</span> <span style="color: #008080;">1657</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1658</span> <span style="color: #000000;">    }; </span><span style="color: #008080;">1659</span>  <span style="color: #008080;">1660</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1661</span> <span style="color: #008000;">     *函数名 ：_cloneHide </span><span style="color: #008080;">1662</span> <span style="color: #008000;">     *函数功能描述 ： 设置克隆的节点隐藏显示，是否添加到页面 </span><span style="color: #008080;">1663</span> <span style="color: #008000;">     *函数参数 ：   </span><span style="color: #008080;">1664</span> <span style="color: #008000;">                        state： </span><span style="color: #008080;">1665</span> <span style="color: #008000;">                                 类型:Boolean  真，假 </span><span style="color: #008080;">1666</span> <span style="color: #008000;">     *函数返回值 ： viod </span><span style="color: #008080;">1667</span> <span style="color: #008000;">     *作者 ：   </span><span style="color: #008080;">1668</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;">1669</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;">1670</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;">1671</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;">1672</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;">1673</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;">1674</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1675</span> <span style="color: #000000;">    function _cloneHide(state) { </span><span style="color: #008080;">1676</span>         <span style="color: #008000;">//</span><span style="color: #008000;">state布尔值 </span><span style="color: #008080;">1677</span>         <span style="color: #008000;">//</span><span style="color: #008000;">cloneEl 克隆的节点 </span><span style="color: #008080;">1678</span>         <span style="color: #008000;">//</span><span style="color: #008000;">state 状态</span> <span style="color: #008080;">1679</span>         <span style="color: #0000ff;">if</span> (cloneEl &amp;&amp; (cloneEl.state !== state)) {<span style="color: #008000;">//</span><span style="color: #008000;">如果cloneEl 存在，并且cloneEl.state 不等于state 的时候</span> <span style="color: #008080;">1680</span>             _css(cloneEl, <span style="color: #800000;">'</span><span style="color: #800000;">display</span><span style="color: #800000;">'</span>, state ? <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span> : <span style="color: #800000;">''</span>); <span style="color: #008000;">//</span><span style="color: #008000;">state 为真的时候把它隐藏，为假的时候显示</span> <span style="color: #008080;">1681</span>             !state &amp;&amp; cloneEl.state &amp;&amp; rootEl.insertBefore(cloneEl, dragEl);<span style="color: #008000;">//</span><span style="color: #008000;">state为假的时候cloneEl.state 为真则把cloneEl添加在dragEl前面</span> <span style="color: #008080;">1682</span>             cloneEl.state = state;  <span style="color: #008000;">// </span><span style="color: #008080;">1683</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1684</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1685</span>  <span style="color: #008080;">1686</span>   <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1687</span> <span style="color: #008000;">         *函数名 ：_closest </span><span style="color: #008080;">1688</span> <span style="color: #008000;">         *函数功能描述 ：  匹配触发dom该函数的dom节点中的tag或者class，selector参数可以是tag或者class或者&gt;*， </span><span style="color: #008080;">1689</span> <span style="color: #008000;">         如果是&gt;* 并且当前的父节点和ctx 参数相同 则不需要匹配直接返回el，如果是tag或者class则匹配 </span><span style="color: #008080;">1690</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1691</span> <span style="color: #008000;">                          el： </span><span style="color: #008080;">1692</span> <span style="color: #008000;">                                        类型:obj，拖拽节点dom </span><span style="color: #008080;">1693</span> <span style="color: #008000;">                          selector： </span><span style="color: #008080;">1694</span> <span style="color: #008000;">                                        类型：字符串，如果selector是'li' : '&gt;*'则返回是改节点dom，还有如果selector是和当前拖拽节点的name相同则也返回改节点dom，还有匹配触发该函数的el中的class是否是和参数中selector相同，相同则返回true，否则返回null </span><span style="color: #008080;">1695</span> <span style="color: #008000;">                           ctx：ctx用来匹配当前selector的父节点是否等于ctx节点                </span><span style="color: #008080;">1696</span> <span style="color: #008000;">          *函数返回值 ：dom和null </span><span style="color: #008080;">1697</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1698</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1699</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1700</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1701</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1702</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1703</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1704</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1705</span>     function _closest(<span style="color: #008000;">/*</span><span style="color: #008000;">*HTMLElement</span><span style="color: #008000;">*/</span>el, <span style="color: #008000;">/*</span><span style="color: #008000;">*String</span><span style="color: #008000;">*/</span>selector, <span style="color: #008000;">/*</span><span style="color: #008000;">*HTMLElement</span><span style="color: #008000;">*/</span><span style="color: #000000;">ctx) { </span><span style="color: #008080;">1706</span> <span style="color: #008000;">/*</span><span style="color: #008000;"> el  目标节点 </span><span style="color: #008080;">1707</span> <span style="color: #008000;">selector   /[uo]l/i.test(el.nodeName) ? 'li' : '&gt;*', </span><span style="color: #008080;">1708</span> <span style="color: #008000;">ctx  父亲节点</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1709</span>           <span style="color: #0000ff;">if</span><span style="color: #000000;"> (el) { </span><span style="color: #008080;">1710</span>             <span style="color: #008000;">//</span><span style="color: #008000;">如果没有传父亲节点过来则是整个文档</span> <span style="color: #008080;">1711</span>             ctx = ctx ||<span style="color: #000000;"> document; </span><span style="color: #008080;">1712</span>              <span style="color: #008080;">1713</span>              <span style="color: #0000ff;">do</span><span style="color: #000000;"> { </span><span style="color: #008080;">1714</span>           <span style="color: #008080;">1715</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> ( </span><span style="color: #008080;">1716</span>                    <span style="color: #008000;">//</span><span style="color: #008000;">如果不是li而是其他节点 并且已经搜索完了直到是父亲节点的时候就返回true </span><span style="color: #008080;">1717</span>                    <span style="color: #008000;">//</span><span style="color: #008000;">或者走_matches _matches 需要true </span><span style="color: #008080;">1718</span>                    <span style="color: #008000;">//</span><span style="color: #008000;">selector === '&gt;*' &amp;&amp; el.parentNode === ctx 如果  selector === '&gt;*'  表示父节点不是ol或ul</span> <span style="color: #008080;">1719</span>                     (selector === <span style="color: #800000;">'</span><span style="color: #800000;">&gt;*</span><span style="color: #800000;">'</span> &amp;&amp; el.parentNode ===<span style="color: #000000;"> ctx) </span><span style="color: #008080;">1720</span>                     ||<span style="color: #000000;"> _matches(el, selector) </span><span style="color: #008080;">1721</span> <span style="color: #000000;">                ) { </span><span style="color: #008080;">1722</span>                   <span style="color: #008080;">1723</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;"> el;   </span><span style="color: #008080;">1724</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1725</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1726</span>             <span style="color: #008000;">//</span><span style="color: #008000;">el !== ctx 如果目标节点不是当前的父节点，则会一直找上一层的父节点知道当他找到当前的根父节点程序则停止。 </span> <span style="color: #008080;">1727</span>             <span style="color: #0000ff;">while</span> (el !== ctx &amp;&amp; (el = el.parentNode));  <span style="color: #008000;">//</span><span style="color: #008000;">如果条件不成立一直需找上一层父节点</span> <span style="color: #008080;">1728</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1729</span>  <span style="color: #008080;">1730</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">; </span><span style="color: #008080;">1731</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1732</span>  <span style="color: #008080;">1733</span>   <span style="color: #008000;">/*</span> <span style="color: #008080;">1734</span> <span style="color: #008000;">          *函数名 ：_globalDragOver </span><span style="color: #008080;">1735</span> <span style="color: #008000;">         *函数功能描述 ：设置拖动的元素移动到放置目标。 </span><span style="color: #008080;">1736</span> <span style="color: #008000;">          *参数说明： </span><span style="color: #008080;">1737</span> <span style="color: #008000;">                           evt：类型obj事件对象 </span><span style="color: #008080;">1738</span> <span style="color: #008000;">          返回值：void </span><span style="color: #008080;">1739</span>    <span style="color: #008000;">*/</span> <span style="color: #008080;">1740</span>     function _globalDragOver(<span style="color: #008000;">/*</span><span style="color: #008000;">*Event</span><span style="color: #008000;">*/</span><span style="color: #000000;">evt) { </span><span style="color: #008080;">1741</span>         <span style="color: #008000;">/*</span> <span style="color: #008080;">1742</span> <span style="color: #008000;"> 1.effectAllowed属性表示允许拖放元素的哪种dropEffect。什么是dropEffect?也是dataTransfer 的一种属性。 </span><span style="color: #008080;">1743</span> <span style="color: #008000;"> dropEffect属性可以知道被拖动的元素能够执行哪种放置行为（当拖到目的地时）。这个属性有下列4个可能的值。 </span><span style="color: #008080;">1744</span> <span style="color: #008000;">&ldquo;none&rdquo;：不能把拖动的元素放在这里。这是除文本框之外所有元素的默认值。 </span><span style="color: #008080;">1745</span> <span style="color: #008000;">&ldquo;move&rdquo;：应该把拖动的元素移动到放置目标。 </span><span style="color: #008080;">1746</span> <span style="color: #008000;">&ldquo;copy&rdquo;：应该把拖动的元素复制到放置目标。 </span><span style="color: #008080;">1747</span> <span style="color: #008000;">&ldquo;link&rdquo;：表示放置目标会打开拖动的元素（但拖动的元素必须是一个链接，有URL）。 </span><span style="color: #008080;">1748</span> <span style="color: #008000;"> 2. dt.effectAllowed = 'all'：即说被拖动元素在放置到目的地时，可以上面的任意一种效果来处理。 </span><span style="color: #008080;">1749</span> <span style="color: #008000;"> 3. 必须在ondraggstart事件处理程序中设置effectAllowed属性。 </span><span style="color: #008080;">1750</span>         <span style="color: #008000;">*/</span> <span style="color: #008080;">1751</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (evt.dataTransfer) { </span><span style="color: #008080;">1752</span>           <span style="color: #008080;">1753</span>             evt.dataTransfer.dropEffect = <span style="color: #800000;">'</span><span style="color: #800000;">move</span><span style="color: #800000;">'</span>;  <span style="color: #008000;">//</span><span style="color: #008000;">&ldquo;move&rdquo;：应该把拖动的元素移动到放置目标。</span> <span style="color: #008080;">1754</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1755</span> <span style="color: #000000;">        evt.preventDefault(); </span><span style="color: #008080;">1756</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1757</span>  <span style="color: #008080;">1758</span>   <span style="color: #008000;">/*</span> <span style="color: #008080;">1759</span> <span style="color: #008000;">          *函数名 ：_on </span><span style="color: #008080;">1760</span> <span style="color: #008000;">         *函数功能描述 ：  事件绑定 </span><span style="color: #008080;">1761</span> <span style="color: #008000;">          *参数说明： </span><span style="color: #008080;">1762</span> <span style="color: #008000;">                           el：类型DOM节点，   </span><span style="color: #008080;">1763</span> <span style="color: #008000;">                           name：类型string，事件类型 </span><span style="color: #008080;">1764</span> <span style="color: #008000;">                           fn：类型：function，需要绑定的函数 </span><span style="color: #008080;">1765</span>   <span style="color: #008000;">*/</span> <span style="color: #008080;">1766</span>     function _on(el, <span style="color: #0000ff;">event</span><span style="color: #000000;">, fn) { </span><span style="color: #008080;">1767</span>         el.addEventListener(<span style="color: #0000ff;">event</span>, fn, <span style="color: #0000ff;">false</span><span style="color: #000000;">); </span><span style="color: #008080;">1768</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1769</span>  <span style="color: #008080;">1770</span>   <span style="color: #008000;">/*</span> <span style="color: #008080;">1771</span> <span style="color: #008000;">          *函数名 ：_toggleClass </span><span style="color: #008080;">1772</span> <span style="color: #008000;">         *函数功能描述 ：  添加删除calss </span><span style="color: #008080;">1773</span> <span style="color: #008000;">          *参数说明： </span><span style="color: #008080;">1774</span> <span style="color: #008000;">                           el：类型DOM节点， 需要添加和删除的dom节点， </span><span style="color: #008080;">1775</span> <span style="color: #008000;">                           name：类型string，需要添加删除class字符串的 </span><span style="color: #008080;">1776</span> <span style="color: #008000;">                           fn：类型：布尔值，如果是真则删除name的class名称否则添加 </span><span style="color: #008080;">1777</span>   <span style="color: #008000;">*/</span> <span style="color: #008080;">1778</span>     function _off(el, <span style="color: #0000ff;">event</span><span style="color: #000000;">, fn) { </span><span style="color: #008080;">1779</span>         el.removeEventListener(<span style="color: #0000ff;">event</span>, fn, <span style="color: #0000ff;">false</span><span style="color: #000000;">); </span><span style="color: #008080;">1780</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1781</span>  <span style="color: #008080;">1782</span>   <span style="color: #008000;">/*</span> <span style="color: #008080;">1783</span> <span style="color: #008000;">          *函数名 ：_toggleClass </span><span style="color: #008080;">1784</span> <span style="color: #008000;">         *函数功能描述 ：  添加删除calss </span><span style="color: #008080;">1785</span> <span style="color: #008000;">          *参数说明： </span><span style="color: #008080;">1786</span> <span style="color: #008000;">                           el：类型DOM节点， 需要添加和删除的dom节点， </span><span style="color: #008080;">1787</span> <span style="color: #008000;">                           name：类型string，需要添加删除class字符串的 </span><span style="color: #008080;">1788</span> <span style="color: #008000;">                           state：类型：布尔值，如果是真则删除name的class名称否则添加 </span><span style="color: #008080;">1789</span>   <span style="color: #008000;">*/</span> <span style="color: #008080;">1790</span> <span style="color: #000000;">    function _toggleClass(el, name, state) { </span><span style="color: #008080;">1791</span>         <span style="color: #008000;">//</span><span style="color: #008000;">console.log(el.classList); </span><span style="color: #008000;">//</span><span style="color: #008000;">获取dom节点clss的个数并且以数组形式存储起来 </span><span style="color: #008080;">1792</span>        <span style="color: #008000;">//</span><span style="color: #008000;">el.classList 判断当前的拖拽节点又没有class 如果有</span> <span style="color: #008080;">1793</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (el) { </span><span style="color: #008080;">1794</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (el.classList) { </span><span style="color: #008080;">1795</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">如果state 是真则在改节点上面添加name class 否则删除name  class</span> <span style="color: #008080;">1796</span>                 el.classList[state ? <span style="color: #800000;">'</span><span style="color: #800000;">add</span><span style="color: #800000;">'</span> : <span style="color: #800000;">'</span><span style="color: #800000;">remove</span><span style="color: #800000;">'</span><span style="color: #000000;">](name); </span><span style="color: #008080;">1797</span> <span style="color: #000000;">             } </span><span style="color: #008080;">1798</span>             <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">1799</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">replace() 方法用于在字符串中用一些字符替换另一些字符，或替换一个与正则表达式匹配的子串。 </span><span style="color: #008080;">1800</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">    RSPACE = /\s+/g, 匹配1-n个空格 全局匹配 </span><span style="color: #008080;">1801</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> (' ' + el.className + ' ').replace(RSPACE, ' ')  去除class 中的所有空格 并且只保留一个空格 每一个class中 </span><span style="color: #008080;">1802</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">className = (' ' + el.className + ' ').replace(RSPACE, '').replace(' ' + name + ' ', ' '); 剔除 name class</span> <span style="color: #008080;">1803</span>                 <span style="color: #0000ff;">var</span> className = (<span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + el.className + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span>).replace(RSPACE, <span style="color: #800000;">''</span>).replace(<span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + name + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span>, <span style="color: #800000;">'</span> <span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">1804</span>          <span style="color: #008080;">1805</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">如果state 是真则在改节点上面添加name class 否则删除name  class</span> <span style="color: #008080;">1806</span>                 el.className = (className + (state ? <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + name : <span style="color: #800000;">''</span>)).replace(RSPACE, <span style="color: #800000;">'</span> <span style="color: #800000;">'</span><span style="color: #000000;">); </span><span style="color: #008080;">1807</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1808</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1809</span>  <span style="color: #008080;">1810</span>        <span style="color: #008080;">1811</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1812</span>  <span style="color: #008000;">/*</span> <span style="color: #008080;">1813</span> <span style="color: #008000;">          *函数名 ：设置 样式 与 获取dom节点的style属性 </span><span style="color: #008080;">1814</span> <span style="color: #008000;">         *函数功能描述 ：  添加删除calss,获取dom节点全部css属性，如果是一个参数的时候将返回该dom节点的全部css属性，如果是两个参数的时候该返回该css的第二个参数的值，如果是三个参数的话将设置css样式 </span><span style="color: #008080;">1815</span> <span style="color: #008000;">          *参数说明： </span><span style="color: #008080;">1816</span> <span style="color: #008000;">                           el：类型DOM节点， 需要添加和删除的dom节点， </span><span style="color: #008080;">1817</span> <span style="color: #008000;">                           prop：类型string，需要添加删除class字符串的那么 </span><span style="color: #008080;">1818</span> <span style="color: #008000;">                           val：类型：布尔值，如果是真则删除name的class名称否则添加 </span><span style="color: #008080;">1819</span>   <span style="color: #008000;">*/</span> <span style="color: #008080;">1820</span>  <span style="color: #008080;">1821</span> <span style="color: #000000;">    function _css(el, prop, val) { </span><span style="color: #008080;">1822</span>         <span style="color: #0000ff;">var</span> style = el &amp;&amp; el.style;  <span style="color: #008000;">//</span><span style="color: #008000;">如果el存在并且他是dom节点style=el.style</span> <span style="color: #008080;">1823</span>  <span style="color: #008080;">1824</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (style) { </span><span style="color: #008080;">1825</span>             <span style="color: #0000ff;">if</span> (val === <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span>) {     <span style="color: #008000;">//</span><span style="color: #008000;">如果val===undefined </span><span style="color: #008080;">1826</span>             <span style="color: #008000;">//</span><span style="color: #008000;">var win = document.defaultView;  返回当前文档上面的所有对象 </span><span style="color: #008080;">1827</span>             <span style="color: #008000;">//</span><span style="color: #008000;">document.defaultView.getComputedStyle 返回当前文档上的对象的样式方法 </span><span style="color: #008080;">1828</span>             <span style="color: #008000;">// </span><span style="color: #008080;">1829</span>                 <span style="color: #0000ff;">if</span> (document.defaultView &amp;&amp;<span style="color: #000000;"> document.defaultView.getComputedStyle) { </span><span style="color: #008080;">1830</span>                     val = document.defaultView.getComputedStyle(el, <span style="color: #800000;">''</span>); <span style="color: #008000;">//</span><span style="color: #008000;">获取到改dom节点的全部style属性，并且带有值</span> <span style="color: #008080;">1831</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1832</span>                 <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;"> (el.currentStyle) { </span><span style="color: #008080;">1833</span>                     val = el.currentStyle;  <span style="color: #008000;">//</span><span style="color: #008000;">getComputedStyle与currentStyle获取样式(style/class)</span> <span style="color: #008080;">1834</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1835</span>  <span style="color: #008080;">1836</span>                 <span style="color: #0000ff;">return</span> prop === <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span> ? val : val[prop];  <span style="color: #008000;">//</span><span style="color: #008000;">如果prop为undefined则返回style全部属性</span> <span style="color: #008080;">1837</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1838</span>             <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">1839</span>                 <span style="color: #0000ff;">if</span> (!(prop <span style="color: #0000ff;">in</span> style)) {   <span style="color: #008000;">//</span><span style="color: #008000;">如果prop中这个属性中style中没有 </span> <span style="color: #008080;">1840</span>                     prop = <span style="color: #800000;">'</span><span style="color: #800000;">-webkit-</span><span style="color: #800000;">'</span> + prop;  <span style="color: #008000;">//</span><span style="color: #008000;">则在这个prop前面加 '-webkit-' 字符串</span> <span style="color: #008080;">1841</span> <span style="color: #000000;">                }  </span><span style="color: #008080;">1842</span>  <span style="color: #008080;">1843</span>                 style[prop] = val + (<span style="color: #0000ff;">typeof</span> val === <span style="color: #800000;">'</span><span style="color: #800000;">string</span><span style="color: #800000;">'</span> ? <span style="color: #800000;">''</span> : <span style="color: #800000;">'</span><span style="color: #800000;">px</span><span style="color: #800000;">'</span>);   <span style="color: #008000;">//</span><span style="color: #008000;"> 如果val类型是数子则添加px</span> <span style="color: #008080;">1844</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1845</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1846</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1847</span>  <span style="color: #008080;">1848</span>   <span style="color: #008080;">1849</span>  <span style="color: #008080;">1850</span>  <span style="color: #008080;">1851</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1852</span> <span style="color: #008000;">         *函数名 ：_find </span><span style="color: #008080;">1853</span> <span style="color: #008000;">         *函数功能描述 ：  获取拖拽节点下面的所有a和img标签，并且设置他们禁止拖拽行为 </span><span style="color: #008080;">1854</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1855</span> <span style="color: #008000;">                      ctx： </span><span style="color: #008080;">1856</span> <span style="color: #008000;">                             类型：dom-obj 拖拽的节点 </span><span style="color: #008080;">1857</span> <span style="color: #008000;">                    tagName： </span><span style="color: #008080;">1858</span> <span style="color: #008000;">                                     类型：string，ctx.getElementsByTagName(tagName)  </span><span style="color: #008080;">1859</span> <span style="color: #008000;">                                                获取拖拽节点下面的所有a和img </span><span style="color: #008080;">1860</span> <span style="color: #008000;">         *函数返回值 ： a和img的dom集合 </span><span style="color: #008080;">1861</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1862</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1863</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1864</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1865</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1866</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1867</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1868</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1869</span> <span style="color: #000000;">    function _find(ctx, tagName, iterator) { </span><span style="color: #008080;">1870</span>         <span style="color: #008000;">/*</span> <span style="color: #008080;">1871</span> <span style="color: #008000;">ctx 拖拽的节点 </span><span style="color: #008080;">1872</span> <span style="color: #008000;">ctx.getElementsByTagName(tagName) 获取拖拽节点下面的所有a和img </span><span style="color: #008080;">1873</span> <span style="color: #008000;">_disableDraggable 是一个函数 </span><span style="color: #008080;">1874</span> <span style="color: #008000;">iterator=_disableDraggable </span><span style="color: #008080;">1875</span> <span style="color: #008000;">_find(ctx, tagName, iterator) 该函数功能是把当前拖拽对象的a和img节点的html5 拖拽属性改为false </span><span style="color: #008080;">1876</span> <span style="color: #008000;">*/</span> <span style="color: #008080;">1877</span>          <span style="color: #008080;">1878</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (ctx) { </span><span style="color: #008080;">1879</span>             <span style="color: #0000ff;">var</span> list = ctx.getElementsByTagName(tagName), i = <span style="color: #800080;">0</span>, n =<span style="color: #000000;"> list.length; </span><span style="color: #008080;">1880</span>  <span style="color: #008080;">1881</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (iterator) { </span><span style="color: #008080;">1882</span>                 <span style="color: #0000ff;">for</span> (; i &lt; n; i++<span style="color: #000000;">) { </span><span style="color: #008080;">1883</span> <span style="color: #000000;">                    iterator(list[i], i); </span><span style="color: #008080;">1884</span> <span style="color: #000000;">                } </span><span style="color: #008080;">1885</span> <span style="color: #000000;">            } </span><span style="color: #008080;">1886</span>  <span style="color: #008080;">1887</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> list; </span><span style="color: #008080;">1888</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1889</span>  <span style="color: #008080;">1890</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> []; </span><span style="color: #008080;">1891</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1892</span>  <span style="color: #008080;">1893</span> <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1894</span> <span style="color: #008000;">         *函数名 ：_dispatchEvent </span><span style="color: #008080;">1895</span> <span style="color: #008000;">         *函数功能描述 ：   创建一个事件，事件参数主要由name 提供，并且触发该事件，其实就是模拟事件并且触发该事件  </span><span style="color: #008080;">1896</span> <span style="color: #008000;">         *函数参数 ： </span><span style="color: #008080;">1897</span> <span style="color: #008000;">                      sortable： </span><span style="color: #008080;">1898</span> <span style="color: #008000;">                             类型： obj sortable </span><span style="color: #008080;">1899</span> <span style="color: #008000;">                    rootEl： </span><span style="color: #008080;">1900</span> <span style="color: #008000;">                                     类型：  dom-obj   鼠标按下去拖拽节点的根节点 </span><span style="color: #008080;">1901</span>                                       <span style="color: #008080;">1902</span> <span style="color: #008000;">                    name：    类型：  string  需要创建的事件 </span><span style="color: #008080;">1903</span>                      <span style="color: #008080;">1904</span> <span style="color: #008000;">                    targetEl：dom-obj  鼠标按下去拖拽节点，触屏到发生事件ondragover的节点的根节点，就是目标节点的根节点。但是如果是start事件的时候传进来的改参数就是鼠标按下去拖拽节点的根节点 </span><span style="color: #008080;">1905</span>                     <span style="color: #008080;">1906</span> <span style="color: #008000;">                     fromEl： </span><span style="color: #008080;">1907</span> <span style="color: #008000;">                                     类型：  dom-obj   鼠标按下去拖拽节点的根节点    参数和第二个一样，为什么重写参数进来呢，可能是为了兼容这样的的吧 </span><span style="color: #008080;">1908</span>                <span style="color: #008080;">1909</span> <span style="color: #008000;">                    startIndex： </span><span style="color: #008080;">1910</span> <span style="color: #008000;">                                                         类型：  number   鼠标按下去拖拽节点的索引 </span><span style="color: #008080;">1911</span> <span style="color: #008000;">                     newIndex：                 </span><span style="color: #008080;">1912</span> <span style="color: #008000;">                                               类型：  number    </span><span style="color: #008080;">1913</span>                <span style="color: #008080;">1914</span> <span style="color: #008000;">         * *函数返回值 ： </span><span style="color: #008080;">1915</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">1916</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">1917</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">1918</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">1919</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">1920</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">1921</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">1922</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1923</span> <span style="color: #000000;">     function _dispatchEvent(sortable, rootEl, name, targetEl, fromEl, startIndex, newIndex) { </span><span style="color: #008080;">1924</span>           <span style="color: #008080;">1925</span>         <span style="color: #0000ff;">var</span> evt = document.createEvent(<span style="color: #800000;">'</span><span style="color: #800000;">Event</span><span style="color: #800000;">'</span>),   <span style="color: #008000;">//</span><span style="color: #008000;">创建一个事件</span> <span style="color: #008080;">1926</span>             options = (sortable || rootEl[expando]).options,   <span style="color: #008000;">//</span><span style="color: #008000;">获取options 参数 </span><span style="color: #008080;">1927</span>             <span style="color: #008000;">//</span><span style="color: #008000;">name.charAt(0) 获取name的第一个字符串 </span><span style="color: #008080;">1928</span>             <span style="color: #008000;">//</span><span style="color: #008000;">toUpperCase() 变成大写 </span><span style="color: #008080;">1929</span>             <span style="color: #008000;">//</span><span style="color: #008000;">name.substr(1) 提取从索引为1下标到字符串的结束位置的字符串 </span><span style="color: #008080;">1930</span>             <span style="color: #008000;">//</span><span style="color: #008000;">onName 将获得 on+首个字母大写+name从第一个下标获取到的字符串</span> <span style="color: #008080;">1931</span>             onName = <span style="color: #800000;">'</span><span style="color: #800000;">on</span><span style="color: #800000;">'</span> + name.charAt(<span style="color: #800080;">0</span>).toUpperCase() + name.substr(<span style="color: #800080;">1</span><span style="color: #000000;">); </span><span style="color: #008080;">1932</span>  <span style="color: #008080;">1933</span>         evt.initEvent(name, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;">自定义一个事件</span> <span style="color: #008080;">1934</span>  <span style="color: #008080;">1935</span>         evt.to = rootEl; <span style="color: #008000;">//</span><span style="color: #008000;">在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span> <span style="color: #008080;">1936</span>         evt.<span style="color: #0000ff;">from</span> = fromEl || rootEl;  <span style="color: #008000;">//</span><span style="color: #008000;">在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span> <span style="color: #008080;">1937</span>         evt.item = targetEl || rootEl;  <span style="color: #008000;">//</span><span style="color: #008000;">在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span> <span style="color: #008080;">1938</span>         evt.clone = cloneEl;   <span style="color: #008000;">//</span><span style="color: #008000;">在触发该事件发生evt的时候，将evt添加多一个to属性，值为rootEl</span> <span style="color: #008080;">1939</span>  <span style="color: #008080;">1940</span>         evt.oldIndex = startIndex; <span style="color: #008000;">//</span><span style="color: #008000;">开始拖拽节点</span> <span style="color: #008080;">1941</span>         evt.newIndex = newIndex; <span style="color: #008000;">//</span><span style="color: #008000;">现在节点 </span><span style="color: #008080;">1942</span>         <span style="color: #008000;">//</span><span style="color: #008000;">触发该事件，并且是在rootEl 节点上面 。触发事件接口就这这里了。onAdd: onUpdate: onRemove:onStart:onSort:onEnd: </span> <span style="color: #008080;">1943</span>   <span style="color: #008080;">1944</span> <span style="color: #000000;">        rootEl.dispatchEvent(evt); </span><span style="color: #008080;">1945</span>  <span style="color: #008080;">1946</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (options[onName]) { </span><span style="color: #008080;">1947</span> <span style="color: #000000;">            options[onName].call(sortable, evt); </span><span style="color: #008080;">1948</span> <span style="color: #000000;">        } </span><span style="color: #008080;">1949</span> <span style="color: #000000;">    } </span><span style="color: #008080;">1950</span>  <span style="color: #008080;">1951</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">1952</span> <span style="color: #008000;">     *函数名 ：_onMove </span><span style="color: #008080;">1953</span> <span style="color: #008000;">     *函数功能描述 ： 表格分页数据 </span><span style="color: #008080;">1954</span> <span style="color: #008000;">     *函数参数 ：  </span><span style="color: #008080;">1955</span> <span style="color: #008000;">                      fromEl： </span><span style="color: #008080;">1956</span> <span style="color: #008000;">                               类型：obj，拖拽的根节点 </span><span style="color: #008080;">1957</span> <span style="color: #008000;">                      toEl： </span><span style="color: #008080;">1958</span> <span style="color: #008000;">                               类型：obj，拖拽的根节点 </span><span style="color: #008080;">1959</span> <span style="color: #008000;">                      dragEl： </span><span style="color: #008080;">1960</span> <span style="color: #008000;">                               类型：obj，拖拽的节点 </span><span style="color: #008080;">1961</span> <span style="color: #008000;">                      dragRect： </span><span style="color: #008080;">1962</span> <span style="color: #008000;">                               类型：obj，拖拽的节点rect </span><span style="color: #008080;">1963</span> <span style="color: #008000;">                      targetEl： </span><span style="color: #008080;">1964</span> <span style="color: #008000;">                               类型：obj，目标节点 ondragover 发生事件的节点 </span><span style="color: #008080;">1965</span> <span style="color: #008000;">                      targetRect： </span><span style="color: #008080;">1966</span> <span style="color: #008000;">                               类型：obj，目标节点rect </span><span style="color: #008080;">1967</span> <span style="color: #008000;">      *函数返回值 ： retVal </span><span style="color: #008080;">1968</span> <span style="color: #008000;">     *作者 ：   </span><span style="color: #008080;">1969</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;">1970</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;">1971</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;">1972</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;">1973</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;">1974</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;">1975</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">1976</span> <span style="color: #000000;">    function _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect) { </span><span style="color: #008080;">1977</span>          <span style="color: #008080;">1978</span>         <span style="color: #0000ff;">var</span><span style="color: #000000;"> evt,    </span><span style="color: #008080;">1979</span>         <span style="color: #008000;">//</span><span style="color: #008000;">sortable 类      </span><span style="color: #008000;">//</span><span style="color: #008000;">fromEl 是根节点</span> <span style="color: #008080;">1980</span>             sortable = fromEl[expando],  <span style="color: #008000;">//</span><span style="color: #008000;">expando = 'Sortable' + (new Date).getTime(),  </span><span style="color: #008000;">//</span><span style="color: #008000;">字符串Sortable+时间戳     el[expando] = this;   </span><span style="color: #008000;">//</span><span style="color: #008000;">把 Sortable 类放在HTMLDOM节点的expando属性中</span> <span style="color: #008080;">1981</span>               <span style="color: #008080;">1982</span>             onMoveFn = sortable.options.onMove,  <span style="color: #008000;">//</span><span style="color: #008000;">空undefined</span> <span style="color: #008080;">1983</span> <span style="color: #000000;">            retVal; </span><span style="color: #008080;">1984</span>            <span style="color: #008080;">1985</span>        <span style="color: #008080;">1986</span>         evt = document.createEvent(<span style="color: #800000;">'</span><span style="color: #800000;">Event</span><span style="color: #800000;">'</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">创建一个事件对象</span> <span style="color: #008080;">1987</span>         evt.initEvent(<span style="color: #800000;">'</span><span style="color: #800000;">move</span><span style="color: #800000;">'</span>, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;">添加移动事件</span> <span style="color: #008080;">1988</span>  <span style="color: #008080;">1989</span>         evt.to = toEl;            <span style="color: #008000;">//</span><span style="color: #008000;">把根节点赋值给to的属性上面</span> <span style="color: #008080;">1990</span>         evt.<span style="color: #0000ff;">from</span> = fromEl;     <span style="color: #008000;">//</span><span style="color: #008000;">把根节点赋值给from的属性上面</span> <span style="color: #008080;">1991</span>         evt.dragged = dragEl;   <span style="color: #008000;">//</span><span style="color: #008000;">把现在拖拽节点赋值给to的属性上面</span> <span style="color: #008080;">1992</span>         evt.draggedRect = dragRect;  <span style="color: #008000;">//</span><span style="color: #008000;">把现 在拖拽节点的rect</span> <span style="color: #008080;">1993</span>         evt.related = targetEl || toEl; <span style="color: #008000;">//</span><span style="color: #008000;">判断目标节点或者是toel节点谁存在谁赋值给related 不过targetEl 有限权限高</span> <span style="color: #008080;">1994</span>         evt.relatedRect = targetRect || toEl.getBoundingClientRect();  <span style="color: #008000;">//</span><span style="color: #008000;">判断targetEl的节点的rect或者是toel节点rect谁存在谁赋值给related 不过targetEl的rect 有限权限高</span> <span style="color: #008080;">1995</span>  <span style="color: #008080;">1996</span>         fromEl.dispatchEvent(evt);   <span style="color: #008000;">//</span><span style="color: #008000;">在根节点触发移动事件</span> <span style="color: #008080;">1997</span>  <span style="color: #008080;">1998</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (onMoveFn) { </span><span style="color: #008080;">1999</span>             retVal = onMoveFn.call(sortable, evt);   <span style="color: #008000;">//</span><span style="color: #008000;">如果移动函数存在则知心移动函数onMoveFn</span> <span style="color: #008080;">2000</span> <span style="color: #000000;">        } </span><span style="color: #008080;">2001</span>  <span style="color: #008080;">2002</span>         <span style="color: #0000ff;">return</span> retVal;  <span style="color: #008000;">//</span><span style="color: #008000;">返回该移动函数执行的结果  </span><span style="color: #008000;">//</span><span style="color: #008000;">空undefined</span> <span style="color: #008080;">2003</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2004</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2005</span> <span style="color: #008000;">         *函数名 ：_disableDraggable </span><span style="color: #008080;">2006</span> <span style="color: #008000;">         *函数功能描述 ：  禁用拖动  把heml5的拖拽属性设置为假 </span><span style="color: #008080;">2007</span> <span style="color: #008000;">         *函数参数 ：viod </span><span style="color: #008080;">2008</span> <span style="color: #008000;">         *函数返回值 ：无 </span><span style="color: #008080;">2009</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">2010</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">2011</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">2012</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">2013</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">2014</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">2015</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">2016</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2017</span>  <span style="color: #008080;">2018</span> <span style="color: #000000;">    function _disableDraggable(el) { </span><span style="color: #008080;">2019</span>         el.draggable = <span style="color: #0000ff;">false</span><span style="color: #000000;">; </span><span style="color: #008080;">2020</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2021</span>  <span style="color: #008080;">2022</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2023</span> <span style="color: #008000;">         *函数名 ：_unsilent </span><span style="color: #008080;">2024</span> <span style="color: #008000;">         *函数功能描述 ：  将 _silent 设置为假 </span><span style="color: #008080;">2025</span> <span style="color: #008000;">         *函数参数 ：viod </span><span style="color: #008080;">2026</span> <span style="color: #008000;">         *函数返回值 ：无 </span><span style="color: #008080;">2027</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">2028</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">2029</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">2030</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">2031</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">2032</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">2033</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">2034</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2035</span> <span style="color: #000000;">     function _unsilent() { </span><span style="color: #008080;">2036</span>         _silent = <span style="color: #0000ff;">false</span><span style="color: #000000;">; </span><span style="color: #008080;">2037</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2038</span>  <span style="color: #008080;">2039</span>  <span style="color: #008080;">2040</span>      <span style="color: #008000;">/*</span><span style="color: #008000;">* @returns {HTMLElement|false} </span><span style="color: #008000;">*/</span> <span style="color: #008080;">2041</span>      <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2042</span> <span style="color: #008000;">     *函数名 ：_ghostIsLast </span><span style="color: #008080;">2043</span> <span style="color: #008000;">     *函数功能描述 ： 表格分页数据 </span><span style="color: #008080;">2044</span> <span style="color: #008000;">     *函数参数 ： </span><span style="color: #008080;">2045</span> <span style="color: #008000;">                       el ：类型：dom，拖拽的根节点 </span><span style="color: #008080;">2046</span> <span style="color: #008000;">                       evt：类型：obj，事件对象 </span><span style="color: #008080;">2047</span> <span style="color: #008000;">     *函数返回值 ： </span><span style="color: #008080;">2048</span> <span style="color: #008000;">     *作者 ：   </span><span style="color: #008080;">2049</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;">2050</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;">2051</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;">2052</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;">2053</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;">2054</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;">2055</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2056</span> <span style="color: #000000;">      function _ghostIsLast(el, evt) { </span><span style="color: #008080;">2057</span>         <span style="color: #0000ff;">var</span>   lastEl = el.lastElementChild,  <span style="color: #008000;">//</span><span style="color: #008000;">最后一个节点</span> <span style="color: #008080;">2058</span>                 rect = lastEl.getBoundingClientRect(); <span style="color: #008000;">//</span><span style="color: #008000;">最后一个节点的rect</span> <span style="color: #008080;">2059</span>          <span style="color: #0000ff;">return</span><span style="color: #000000;"> ( </span><span style="color: #008080;">2060</span>                        (evt.clientY - (rect.top + rect.height) &gt; <span style="color: #800080;">5</span>)  || <span style="color: #008000;">//</span><span style="color: #008000;">判断鼠标位置是否在dom节点的bottom下面还是上面 如果是做下面则结果大于0 否则小于0 ，如果鼠标位置在dom节点bottom下面大于5px的时候则返回lastEl 节点</span> <span style="color: #008080;">2061</span>                        (evt.clientX - (rect.right + rect.width) &gt; <span style="color: #800080;">5</span>) <span style="color: #008000;">//</span><span style="color: #008000;">不知道是不是程序把right写错了，写成了left。如果是right话则是这样。判断鼠标位置是否在dom节点的right左边还是右边 如果是左边则大于0，否则小于0  如果鼠标位置在dom节点right右边面大于5px的时候则返回lastEl 节点</span> <span style="color: #008080;">2062</span>                    ) &amp;&amp; lastEl; <span style="color: #008000;">//</span><span style="color: #008000;"> min delta</span> <span style="color: #008080;">2063</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2064</span>  <span style="color: #008080;">2065</span>  <span style="color: #008080;">2066</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">2067</span> <span style="color: #008000;">     * Generate id </span><span style="color: #008080;">2068</span> <span style="color: #008000;">     * @param   {HTMLElement} el </span><span style="color: #008080;">2069</span> <span style="color: #008000;">     * @returns {String} </span><span style="color: #008080;">2070</span> <span style="color: #008000;">     * @private </span><span style="color: #008080;">2071</span>      <span style="color: #008000;">*/</span> <span style="color: #008080;">2072</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2073</span> <span style="color: #008000;">         *函数名 ：_generateId </span><span style="color: #008080;">2074</span> <span style="color: #008000;">         *函数功能描述 ：  根据tag的name和class，src，href，文本内容，来匹配生成唯一的标识符 </span><span style="color: #008080;">2075</span> <span style="color: #008000;">         *函数参数 ：  </span><span style="color: #008080;">2076</span> <span style="color: #008000;">                      el：dom节点 </span><span style="color: #008080;">2077</span> <span style="color: #008000;">         *函数返回值 ：string </span><span style="color: #008080;">2078</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">2079</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">2080</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">2081</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">2082</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">2083</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">2084</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">2085</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2086</span>      <span style="color: #008080;">2087</span>      <span style="color: #008080;">2088</span> <span style="color: #000000;">    function _generateId(el) { </span><span style="color: #008080;">2089</span>         <span style="color: #0000ff;">var</span> str = el.tagName + el.className + el.src + el.href +<span style="color: #000000;"> el.textContent, </span><span style="color: #008080;">2090</span>             i =<span style="color: #000000;"> str.length, </span><span style="color: #008080;">2091</span>             sum = <span style="color: #800080;">0</span><span style="color: #000000;">; </span><span style="color: #008080;">2092</span>  <span style="color: #008080;">2093</span>         <span style="color: #0000ff;">while</span> (i--<span style="color: #000000;">) { </span><span style="color: #008080;">2094</span>             sum +=<span style="color: #000000;"> str.charCodeAt(i); </span><span style="color: #008080;">2095</span> <span style="color: #000000;">        } </span><span style="color: #008080;">2096</span>  <span style="color: #008080;">2097</span>         <span style="color: #0000ff;">return</span> sum.toString(<span style="color: #800080;">36</span>); <span style="color: #008000;">//</span><span style="color: #008000;">生成36进制</span> <span style="color: #008080;">2098</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2099</span>  <span style="color: #008080;">2100</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">2101</span> <span style="color: #008000;">     * Returns the index of an element within its parent for a selected set of </span><span style="color: #008080;">2102</span> <span style="color: #008000;">     * elements </span><span style="color: #008080;">2103</span> <span style="color: #008000;">     * @param  {HTMLElement} el </span><span style="color: #008080;">2104</span> <span style="color: #008000;">     * @param  {selector} selector </span><span style="color: #008080;">2105</span> <span style="color: #008000;">     * @return {number} </span><span style="color: #008080;">2106</span>      <span style="color: #008000;">*/</span> <span style="color: #008080;">2107</span>      <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2108</span> <span style="color: #008000;">         *函数名 ：_index </span><span style="color: #008080;">2109</span> <span style="color: #008000;">         *函数功能描述 ：  返回在其父范围内的元素的元素的索引 </span><span style="color: #008080;">2110</span> <span style="color: #008000;">         *函数参数 ：  </span><span style="color: #008080;">2111</span> <span style="color: #008000;">                                    el </span><span style="color: #008080;">2112</span> <span style="color: #008000;">         *函数返回值 ：number </span><span style="color: #008080;">2113</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">2114</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">2115</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">2116</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">2117</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">2118</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">2119</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">2120</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2121</span>       <span style="color: #008080;">2122</span> <span style="color: #000000;">    function _index(el, selector) { </span><span style="color: #008080;">2123</span>         <span style="color: #0000ff;">var</span> index = <span style="color: #800080;">0</span><span style="color: #000000;">; </span><span style="color: #008080;">2124</span>          <span style="color: #008080;">2125</span>         <span style="color: #008000;">//</span><span style="color: #008000;">如果目标节点不存在，或者目标节点的父节点不存在则返回一个 -1 就是当前目标节点如果是window 则返回-1</span> <span style="color: #008080;">2126</span>         <span style="color: #0000ff;">if</span> (!el || !<span style="color: #000000;">el.parentNode) { </span><span style="color: #008080;">2127</span>             <span style="color: #0000ff;">return</span> -<span style="color: #800080;">1</span><span style="color: #000000;">; </span><span style="color: #008080;">2128</span> <span style="color: #000000;">        } </span><span style="color: #008080;">2129</span>     <span style="color: #008000;">//</span><span style="color: #008000;">el.previousElementSibling 获取上一个节点</span> <span style="color: #008080;">2130</span>      <span style="color: #008080;">2131</span>     <span style="color: #008000;">/*</span> <span style="color: #008080;">2132</span> <span style="color: #008000;">    TEMPLATE 标签 html5 模板标签 例子 </span><span style="color: #008080;">2133</span> <span style="color: #008000;">    // 模板文本 </span><span style="color: #008080;">2134</span> <span style="color: #008000;">&lt;template id="tpl"&gt; </span><span style="color: #008080;">2135</span> <span style="color: #008000;">&lt;img src="dummy.png" title="{{title}}"/&gt; </span><span style="color: #008080;">2136</span> <span style="color: #008000;">&lt;/template&gt; </span><span style="color: #008080;">2137</span>  <span style="color: #008080;">2138</span> <span style="color: #008000;">// 获取模板 </span><span style="color: #008080;">2139</span> <span style="color: #008000;">&lt;script type="text/javascript"&gt; </span><span style="color: #008080;">2140</span> <span style="color: #008000;">var tplEl = document.getElementById('tpl') </span><span style="color: #008080;">2141</span> <span style="color: #008000;">// 通过tplEl.innerText获取也可以 </span><span style="color: #008080;">2142</span> <span style="color: #008000;">var tpl = tplEl.innerHTML </span><span style="color: #008080;">2143</span> <span style="color: #008000;">tpl = tpl.replace(/^[\s\u3000]*|[\s\u3000]*$/, '') </span><span style="color: #008080;">2144</span> <span style="color: #008000;">Handlebars.compile(tpl)({title: 'test'}) </span><span style="color: #008080;">2145</span> <span style="color: #008000;">&lt;/script&gt; </span><span style="color: #008080;">2146</span>      <span style="color: #008080;">2147</span> <span style="color: #008000;">    意思是当节点是TEMPLATE标签的时候则表示该搜索标签已经到达了最顶端 </span><span style="color: #008080;">2148</span>     <span style="color: #008000;">*/</span> <span style="color: #008080;">2149</span>         <span style="color: #0000ff;">while</span> (el &amp;&amp; (el =<span style="color: #000000;"> el.previousElementSibling)) { </span><span style="color: #008080;">2150</span>             <span style="color: #0000ff;">if</span> (el.nodeName.toUpperCase() !== <span style="color: #800000;">'</span><span style="color: #800000;">TEMPLATE</span><span style="color: #800000;">'</span> <span style="color: #008080;">2151</span>                     &amp;&amp;<span style="color: #000000;"> _matches(el, selector)) { </span><span style="color: #008080;">2152</span>                 index++<span style="color: #000000;">; </span><span style="color: #008080;">2153</span> <span style="color: #000000;">            } </span><span style="color: #008080;">2154</span> <span style="color: #000000;">        } </span><span style="color: #008080;">2155</span>  <span style="color: #008080;">2156</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> index; </span><span style="color: #008080;">2157</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2158</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2159</span> <span style="color: #008000;">         *函数名 ：_matches </span><span style="color: #008080;">2160</span> <span style="color: #008000;">         *函数功能描述 ：  匹配tag和tag，匹配clsss和tag， </span><span style="color: #008080;">2161</span> <span style="color: #008000;">         *函数参数 ：  </span><span style="color: #008080;">2162</span> <span style="color: #008000;">                          el： </span><span style="color: #008080;">2163</span> <span style="color: #008000;">                              类型:obj，当前拖拽节点dom </span><span style="color: #008080;">2164</span> <span style="color: #008000;">                        selector: </span><span style="color: #008080;">2165</span> <span style="color: #008000;">                               类型：string, tag或者clasname </span><span style="color: #008080;">2166</span>                                 <span style="color: #008080;">2167</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;">2168</span> <span style="color: #008000;">                               类型：Boolean,真假，selector如果传递的是tag，则当前的el的tag和selector的tag要同样，或当前的el的class含有selector 中的calss则返回真，否则返回假 </span><span style="color: #008080;">2169</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">2170</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">2171</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">2172</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">2173</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">2174</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">2175</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">2176</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2177</span>     function _matches(<span style="color: #008000;">/*</span><span style="color: #008000;">*HTMLElement</span><span style="color: #008000;">*/</span>el, <span style="color: #008000;">/*</span><span style="color: #008000;">*String</span><span style="color: #008000;">*/</span><span style="color: #000000;">selector) { </span><span style="color: #008080;">2178</span>       <span style="color: #008000;">/*</span>     <span style="color: #008080;">2179</span> <span style="color: #008000;">       el 目标节点 </span><span style="color: #008080;">2180</span> <span style="color: #008000;">        selector  = /[uo]l/i.test(el.nodeName) ? 'li' : '&gt;*', </span><span style="color: #008080;">2181</span> <span style="color: #008000;">        selector=&gt;* </span><span style="color: #008080;">2182</span>         <span style="color: #008000;">*/</span> <span style="color: #008080;">2183</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (el) { </span><span style="color: #008080;">2184</span>             <span style="color: #008000;">//</span><span style="color: #008000;">split 字符串截取 </span><span style="color: #008000;">//</span><span style="color: #008000;">没有.则返回为空 但是selector 的值还是原来的 li 但是selector 类型变成了数组 </span><span style="color: #008080;">2185</span>            <span style="color: #008000;">//</span><span style="color: #008000;">shift 删除数组第一个字符串并返回该字符串 </span><span style="color: #008080;">2186</span>            <span style="color: #008000;">//</span><span style="color: #008000;">toUpperCase 把字符串变成大写 </span><span style="color: #008080;">2187</span>            <span style="color: #008000;">//</span><span style="color: #008000;">整个思维是把一个字符串比如 ".aa  .ccc .bbb .ddd"  然后提取到改class中的第一个变成大写  AA</span> <span style="color: #008080;">2188</span>             selector = selector.split(<span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span>);   <span style="color: #008000;">//</span><span style="color: #008000;"> 这里分割判断是class还是tag</span> <span style="color: #008080;">2189</span>              <span style="color: #008080;">2190</span>              <span style="color: #0000ff;">var</span> tag = selector.shift().toUpperCase(),  <span style="color: #008000;">//</span><span style="color: #008000;"> class </span><span style="color: #008080;">2191</span>               <span style="color: #008080;">2192</span>             <span style="color: #008000;">//</span><span style="color: #008000;">join 把数组["a","b","c"]变成a|b|c </span><span style="color: #008080;">2193</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> (?=)会作为匹配校验，但不会出现在匹配结果字符串里面 就是前后必须要匹配有空格 但是不会匹配上空格 </span><span style="color: #008080;">2194</span>             <span style="color: #008000;">//</span><span style="color: #008000;">比如匹配 " aa  bb  cc   " 匹配到  [aa,bb,cc]</span> <span style="color: #008080;">2195</span>             <span style="color: #008000;">/*</span>  <span style="color: #008080;">2196</span> <span style="color: #008000;">            \\s  与 (?=\\s) 前后必须要有空格，但是不会匹配上空格 </span><span style="color: #008080;">2197</span>              <span style="color: #008000;">*/</span> <span style="color: #008080;">2198</span>                 re = <span style="color: #0000ff;">new</span> RegExp(<span style="color: #800000;">'</span><span style="color: #800000;">\\s(</span><span style="color: #800000;">'</span> + selector.join(<span style="color: #800000;">'</span><span style="color: #800000;">|</span><span style="color: #800000;">'</span>) + <span style="color: #800000;">'</span><span style="color: #800000;">)(?=\\s)</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">g</span><span style="color: #800000;">'</span>);  <span style="color: #008000;">//</span>      <span style="color: #008080;">2199</span>               <span style="color: #008080;">2200</span>               <span style="color: #008080;">2201</span>              <span style="color: #008080;">2202</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> ( </span><span style="color: #008080;">2203</span>                <span style="color: #008000;">//</span><span style="color: #008000;">tag === ''  el.nodeName.toUpperCase() == tag </span><span style="color: #008080;">2204</span>                <span style="color: #008000;">//</span><span style="color: #008000;">selector.length=2  tag === ''  true </span><span style="color: #008080;">2205</span>                <span style="color: #008000;">//</span><span style="color: #008000;">el.nodeName.toUpperCase() == tag  如果父节点是ul ol 则这里条件为真</span> <span style="color: #008080;">2206</span>                  (tag === <span style="color: #800000;">''</span> || el.nodeName.toUpperCase() == tag) &amp;&amp; <span style="color: #008080;">2207</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">匹配 class 的长度等于标签的长度，。这里意思是在el中匹配的class含有selector的class就能匹配上</span> <span style="color: #008080;">2208</span>                                 (!selector.length || ((<span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + el.className + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span>).match(re) || []).length ==<span style="color: #000000;"> selector.length) </span><span style="color: #008080;">2209</span> <span style="color: #000000;">            ); </span><span style="color: #008080;">2210</span> <span style="color: #000000;">        } </span><span style="color: #008080;">2211</span>  <span style="color: #008080;">2212</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">; </span><span style="color: #008080;">2213</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2214</span>      <span style="color: #008080;">2215</span>      <span style="color: #008080;">2216</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2217</span> <span style="color: #008000;">         *函数名 ：_throttle </span><span style="color: #008080;">2218</span> <span style="color: #008000;">         *函数功能描述 ：   回调初始化一个函数 并且调用该回调函数 </span><span style="color: #008080;">2219</span> <span style="color: #008000;">         *函数参数 ：  </span><span style="color: #008080;">2220</span> <span style="color: #008000;">                          callback： </span><span style="color: #008080;">2221</span> <span style="color: #008000;">                              类型:function，回调函数 </span><span style="color: #008080;">2222</span> <span style="color: #008000;">                        ms: </span><span style="color: #008080;">2223</span> <span style="color: #008000;">                               类型：number, 毫秒 </span><span style="color: #008080;">2224</span>                                 <span style="color: #008080;">2225</span> <span style="color: #008000;">         *函数返回值 ： </span><span style="color: #008080;">2226</span> <span style="color: #008000;">                               类型：function，函数，可以用来声明一个函数作用 </span><span style="color: #008080;">2227</span> <span style="color: #008000;">         *作者 ：  </span><span style="color: #008080;">2228</span> <span style="color: #008000;">         *函数创建日期 ： </span><span style="color: #008080;">2229</span> <span style="color: #008000;">         *函数修改日期 ： </span><span style="color: #008080;">2230</span> <span style="color: #008000;">         *修改人 ： </span><span style="color: #008080;">2231</span> <span style="color: #008000;">         *修改原因 ： </span><span style="color: #008080;">2232</span> <span style="color: #008000;">         *版本 ： </span><span style="color: #008080;">2233</span> <span style="color: #008000;">         *历史版本 ： </span><span style="color: #008080;">2234</span> <span style="color: #008000;">         **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2235</span> <span style="color: #000000;">    function _throttle(callback, ms) { </span><span style="color: #008080;">2236</span>         <span style="color: #0000ff;">var</span><span style="color: #000000;"> args, </span><span style="color: #008080;">2237</span> <span style="color: #000000;">              _this; </span><span style="color: #008080;">2238</span>           <span style="color: #008080;">2239</span>          <span style="color: #0000ff;">return</span> function (<span style="color: #008000;">/*</span><span style="color: #008000;">有可能是n个参数</span><span style="color: #008000;">*/</span><span style="color: #000000;">) { </span><span style="color: #008080;">2240</span>          <span style="color: #008080;">2241</span>             <span style="color: #0000ff;">if</span> (args === <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span><span style="color: #000000;">) { </span><span style="color: #008080;">2242</span>                 args = arguments;  <span style="color: #008000;">//</span><span style="color: #008000;">arguments 就是callback中的callback 所以参数决定来源于它</span> <span style="color: #008080;">2243</span>                 _this = <span style="color: #0000ff;">this</span><span style="color: #000000;">; </span><span style="color: #008080;">2244</span>               <span style="color: #008000;">//</span><span style="color: #008000;">执行回调函数  </span> <span style="color: #008080;">2245</span> <span style="color: #000000;">                setTimeout(function () { </span><span style="color: #008080;">2246</span>                     <span style="color: #0000ff;">if</span> (args.length === <span style="color: #800080;">1</span>) {  <span style="color: #008000;">//</span><span style="color: #008000;">当callback 函数一个参数的时候</span> <span style="color: #008080;">2247</span>                         callback.call(_this, args[<span style="color: #800080;">0</span><span style="color: #000000;">]); </span><span style="color: #008080;">2248</span>                     } <span style="color: #0000ff;">else</span><span style="color: #000000;"> { </span><span style="color: #008080;">2249</span>                         callback.apply(_this, args);<span style="color: #008000;">//</span><span style="color: #008000;">当callback 函数多个参数的时候</span> <span style="color: #008080;">2250</span> <span style="color: #000000;">                    } </span><span style="color: #008080;">2251</span>                      args = <span style="color: #0000ff;">void</span> <span style="color: #800080;">0</span><span style="color: #000000;">; </span><span style="color: #008080;">2252</span> <span style="color: #000000;">                }, ms); </span><span style="color: #008080;">2253</span> <span style="color: #000000;">            } </span><span style="color: #008080;">2254</span> <span style="color: #000000;">        }; </span><span style="color: #008080;">2255</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2256</span>  <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2257</span> <span style="color: #008000;">     *函数名 ：_extend </span><span style="color: #008080;">2258</span> <span style="color: #008000;">     *函数功能描述 ：类合并 </span><span style="color: #008080;">2259</span> <span style="color: #008000;">     *函数参数 ：  </span><span style="color: #008080;">2260</span> <span style="color: #008000;">                     dst：类型：obj，子类  </span><span style="color: #008080;">2261</span> <span style="color: #008000;">                     src：类型：obj，父类  </span><span style="color: #008080;">2262</span> <span style="color: #008000;">     *函数返回值 ： dst 子类 </span><span style="color: #008080;">2263</span> <span style="color: #008000;">     *作者 ：   </span><span style="color: #008080;">2264</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;">2265</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;">2266</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;">2267</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;">2268</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;">2269</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;">2270</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2271</span> <span style="color: #000000;">    function _extend(dst, src) { </span><span style="color: #008080;">2272</span>         <span style="color: #0000ff;">if</span> (dst &amp;&amp;<span style="color: #000000;"> src) { </span><span style="color: #008080;">2273</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> key <span style="color: #0000ff;">in</span> src) { <span style="color: #008000;">//</span><span style="color: #008000;">遍历对象</span> <span style="color: #008080;">2274</span>                 <span style="color: #0000ff;">if</span> (src.hasOwnProperty(key)) { <span style="color: #008000;">//</span><span style="color: #008000;">过滤原型</span> <span style="color: #008080;">2275</span>                     dst[key] =<span style="color: #000000;"> src[key]; </span><span style="color: #008080;">2276</span> <span style="color: #000000;">                } </span><span style="color: #008080;">2277</span> <span style="color: #000000;">            } </span><span style="color: #008080;">2278</span> <span style="color: #000000;">        } </span><span style="color: #008080;">2279</span>  <span style="color: #008080;">2280</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> dst; </span><span style="color: #008080;">2281</span> <span style="color: #000000;">    } </span><span style="color: #008080;">2282</span>  <span style="color: #008080;">2283</span>  <span style="color: #008080;">2284</span> <span style="color: #008000;">//</span><span style="color: #008000;">声明一个类utils </span><span style="color: #008080;">2285</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> Export utils</span> <span style="color: #008080;">2286</span>     Sortable.utils =<span style="color: #000000;"> { </span><span style="color: #008080;">2287</span> <span style="color: #000000;">        on: _on,   </span><span style="color: #008080;">2288</span> <span style="color: #000000;">        off: _off, </span><span style="color: #008080;">2289</span> <span style="color: #000000;">        css: _css, </span><span style="color: #008080;">2290</span> <span style="color: #000000;">        find: _find, </span><span style="color: #008080;">2291</span>         <span style="color: #0000ff;">is</span><span style="color: #000000;">: function (el, selector) { </span><span style="color: #008080;">2292</span>            <span style="color: #008080;">2293</span>             <span style="color: #0000ff;">return</span> !!<span style="color: #000000;">_closest(el, selector, el); </span><span style="color: #008080;">2294</span> <span style="color: #000000;">        }, </span><span style="color: #008080;">2295</span> <span style="color: #000000;">        extend: _extend, </span><span style="color: #008080;">2296</span> <span style="color: #000000;">        throttle: _throttle, </span><span style="color: #008080;">2297</span> <span style="color: #000000;">        closest: _closest, </span><span style="color: #008080;">2298</span> <span style="color: #000000;">        toggleClass: _toggleClass, </span><span style="color: #008080;">2299</span> <span style="color: #000000;">        index: _index </span><span style="color: #008080;">2300</span> <span style="color: #000000;">    }; </span><span style="color: #008080;">2301</span>  <span style="color: #008080;">2302</span>  <span style="color: #008080;">2303</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">* </span><span style="color: #008080;">2304</span> <span style="color: #008000;">     * Create sortable instance </span><span style="color: #008080;">2305</span> <span style="color: #008000;">     * @param {HTMLElement}  el </span><span style="color: #008080;">2306</span> <span style="color: #008000;">     * @param {Object}      [options] </span><span style="color: #008080;">2307</span>      <span style="color: #008000;">*/</span> <span style="color: #008080;">2308</span>      <span style="color: #008000;">/*</span><span style="color: #008000;">********************************************************************************************** </span><span style="color: #008080;">2309</span> <span style="color: #008000;">     *函数名 ：Sortable.create </span><span style="color: #008080;">2310</span> <span style="color: #008000;">     *函数功能描述 ：在类Sortable中添加多个一个方法，而调用Sortable构造函数实例化给Sortable.create 属性,创建了拖拽功能  </span><span style="color: #008080;">2311</span> <span style="color: #008000;">     *函数参数 ：  </span><span style="color: #008080;">2312</span> <span style="color: #008000;">                     <span style="color: #000000;">el</span>：类型：obj，拖拽列表的dom节点 </span><span style="color: #008080;">2313</span> <span style="color: #008000;">                     <span style="color: #000000;">options</span>：类型：obj，拖拽的参数 </span><span style="color: #008080;">2314</span> <span style="color: #008000;">     *函数返回值 ： dst 子类 </span><span style="color: #008080;">2315</span> <span style="color: #008000;">     *作者 ：   </span><span style="color: #008080;">2316</span> <span style="color: #008000;">     *函数创建日期 ： </span><span style="color: #008080;">2317</span> <span style="color: #008000;">     *函数修改日期 ： </span><span style="color: #008080;">2318</span> <span style="color: #008000;">     *修改人 ： </span><span style="color: #008080;">2319</span> <span style="color: #008000;">     *修改原因 ： </span><span style="color: #008080;">2320</span> <span style="color: #008000;">     *版本 ： </span><span style="color: #008080;">2321</span> <span style="color: #008000;">     *历史版本 ： </span><span style="color: #008080;">2322</span> <span style="color: #008000;">     **********************************************************************************************</span><span style="color: #008000;">*/</span> <span style="color: #008080;">2323</span>  <span style="color: #008080;">2324</span>     Sortable.create =<span style="color: #000000;"> function (el, options) { </span><span style="color: #008080;">2325</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Sortable(el, options); </span><span style="color: #008080;">2326</span> <span style="color: #000000;">    }; </span><span style="color: #008080;">2327</span>  <span style="color: #008080;">2328</span>  <span style="color: #008080;">2329</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> Export</span> <span style="color: #008080;">2330</span>     Sortable.version = <span style="color: #800000;">'</span><span style="color: #800000;">1.4.2</span><span style="color: #800000;">'</span>;  <span style="color: #008000;">//</span><span style="color: #008000;">版本</span> <span style="color: #008080;">2331</span>       <span style="color: #008080;">2332</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> Sortable; </span><span style="color: #008080;">2333</span> });</pre> </div><p>&nbsp;</p>1 nodeName=undefined nodeValue=undefined nodeType=undefined
